{"version":2,"ops":[{"type":1,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1612466035,"metadata":{"github-id":"MDU6SXNzdWU4MDE1NjI0Nzc=","github-url":"https://github.com/dandi/dandi-cli/issues/362","origin":"github"},"title":"dandiset metadata migration got broken","message":"Initially reported by @AlmightyYakob on slack in `#internal` and reproduced\n\nRunning our script within https://github.com/dandi/dandi-api-datasets.git which converts metadata\n```\n(git-annex)lena:~/proj/dandi/dandi-api-datasets[master]git\n$\u003e datalad rerun\n[INFO   ] run commit 01b6175; (convert/populate ...) \n[INFO   ] Making sure inputs are available (this may take some time) \n[INFO   ] == Command start (output follows) ===== \ndandisets/000003: EXCEPTION (000003/EXCEPTION) - C\ndandisets/000004: EXCEPTION (000004/EXCEPTION) - C\ndandisets/000005: EXCEPTION (000005/EXCEPTION) - C\ndandisets/000006: EXCEPTION (000006/EXCEPTION) - C\ndandisets/000007: EXCEPTION (000007/EXCEPTION) - C\ndandisets/000008: EXCEPTION (000008/EXCEPTION) - C\ndandisets/000009: EXCEPTION (000009/EXCEPTION) - C\ndandisets/000010: EXCEPTION (000010/EXCEPTION) - C\n...\n\n$\u003e cat 000003/EXCEPTION\nTraceback (most recent call last):\n  File \"/home/yoh/proj/dandi/dandi-api-datasets/tools/populate_dandiset_yaml.py\", line 34, in \u003cmodule\u003e\n    new_meta = migrate2newschema(dandiset_meta)\n  File \"/home/yoh/proj/dandi/dandi-cli-master/dandi/metadata.py\", line 535, in migrate2newschema\n    newmeta = convertv1(meta)\n  File \"/home/yoh/proj/dandi/dandi-cli-master/dandi/metadata.py\", line 430, in convertv1\n    newvalues.append(getattr(models.LicenseType, val.split(\":\")[-1]))\n  File \"/usr/lib/python3.9/enum.py\", line 352, in __getattr__\n    raise AttributeError(name) from None\nAttributeError: C\n```\n\nafter addressed, would be nice to automate such a \"check\", so filed separate https://github.com/dandi/dandi-cli/issues/361","files":null}]}