{"version":2,"ops":[{"type":1,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1713210862,"metadata":{"github-id":"I_kwDODBZtRc6FyD6j","github-url":"https://github.com/dandi/dandi-cli/issues/1427","origin":"github"},"title":"Return/Add validation of dandiset.yaml upon upload?","message":"prompted by @satra's question in \n- https://github.com/dandi/dandi-schema/pull/235#issuecomment-2049261416\n\nATM:\n\n- we do have [\"# TODO: enable back validation of dandiset.yaml\"](https://github.com/dandi/dandi-cli/blob/HEAD/dandi/upload.py#L258) which was added in 2020 https://github.com/dandi/dandi-cli/pull/242 when we disabled \"upload\" of dandiset.yaml\n- in 2021 https://github.com/dandi/dandi-cli/pull/341 we added development option `--upload-dandiset-metadata` but we are not validating.\n\nI think, indeed, we should re-approach validation of the dandiset.yaml here. \n\n- we should add validation to `--upload-dandiset-metadata` option block with the same behavior as we have for assets in terms of `--validation` option.\n- generally local `dandiset.yaml` might differ from the metadata record on the server.\n- validating local one makes little sense unless it being uploaded (see above -- we will validate in that case)\n- if we are not uploading it, we should validate/inform user about state of the remote/on the server dandiset.yaml (also subject to `--validation` option)\n- I do not think we should preclude upload overall if dandiset metadata record is failing validation, as we do not preclude upload of an asset if some other asset is faulty.\n\nWDYT @satra @jwodder ?","files":null}]}