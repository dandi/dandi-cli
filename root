{"version":2,"ops":[{"type":1,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1617999015,"metadata":{"github-id":"MDU6SXNzdWU4NTQ4MjI4NzM=","github-url":"https://github.com/dandi/dandi-cli/issues/547","origin":"github"},"title":"fixup extraction of digest?","message":"just spotted in https://github.com/dandi/dandi-api-datasets/blob/master/000013/CONVERSION.errors been flooded with:\n\n```\nsub-anm226694/sub-anm226694_ses-20140222_obj-1noi7y3_behavior+icephys+ogen.nwb\nTraceback (most recent call last):\n  File \"tools/populate_dandiset_asset_yamls.py\", line 64, in main\n    metadata = nwb2asset(\n  File \"/home/dandi/cronlib/dandi-api-datasets/.cronlib/venv/lib/python3.8/site-packages/dandi/metadata.py\", line 330, in nwb2asset\n    asset = metadata2asset(metadata)\n  File \"/home/dandi/cronlib/dandi-api-datasets/.cronlib/venv/lib/python3.8/site-packages/dandi/metadata.py\", line 379, in metadata2asset\n    return extract_model(models.BareAssetMeta, metadata)\n  File \"/home/dandi/cronlib/dandi-api-datasets/.cronlib/venv/lib/python3.8/site-packages/dandi/metadata.py\", line 234, in extract_model\n    value = kwargs.get(field, extract_field(field, metadata))\n  File \"/home/dandi/cronlib/dandi-api-datasets/.cronlib/venv/lib/python3.8/site-packages/dandi/metadata.py\", line 303, in extract_field\n    return FIELD_EXTRACTORS[field](metadata)\n  File \"/home/dandi/cronlib/dandi-api-datasets/.cronlib/venv/lib/python3.8/site-packages/dandi/metadata.py\", line 283, in extract_digest\n    return {models.DigestType[metadata[\"digest_type\"]]: metadata[\"digest\"]}\n  File \"/home/dandi/miniconda3/lib/python3.8/enum.py\", line 344, in __getitem__\n    return cls._member_map_[name]\nKeyError: 'sha256'\n```\n\nI guess this code path isn't tested and doesn't account for recent change in model on how digests are stored now?","files":null}]}