{"version":2,"ops":[{"type":1,"author":{"id":"d8203afd43c9e0a9d07c45dd62b58a81d53a2ebe"},"timestamp":1721842897,"metadata":{"github-id":"I_kwDODBZtRc6Qunjw","github-url":"https://github.com/dandi/dandi-cli/issues/1469","origin":"github"},"title":"Improve feedback when there's a validation error","message":"Reposting a suggestion that @dstansby provided on the LINC Client (https://github.com/lincbrain/linc-cli/issues/44):\n\nI'm currently trying to upload a dataset, and if there's a validation error it's a bit tricky to understand what went wrong and how I can fix it. The output looks like this:\n```\nPATH                                                      SIZE        ERRORS     PROGRESS STATUS           MESSAGE                  \ndandiset.yaml                                             1.1 kB                          skipped          should be edited online  \ndataset_description.json                                  98 Bytes       2                ERROR            failed validation        \nsub-s45/micr/sub-s45_sample-fullhemisphere_hipCT.json     65 Bytes       1                ERROR            failed validation        \nsub-s45/micr/sub-s45_sample-fullhemisphere_hipCT.ome.zarr                2                ERROR            failed validation        \nSummary:                                                  1.3 kB   3 with errors          1 skipped        1 should be edited online\n                                                                                          3 ERROR          3 failed validation      \n2024-04-25 13:44:09,332 [ WARNING] One or more assets failed validation.  Consult the logfile for details.\n2024-04-25 13:44:09,861 [ WARNING] Upload failed, and you are not using the latest version of lincbrain-cli.  We suggest upgrading lincbrain-cli to v0.9.0 and trying again.\n2024-04-25 13:44:09,864 [    INFO] Logs saved in /Users/dstansby/Library/Logs/lincbrain-cli/20240425124405Z-15907.log\nError: failed validation\n```\n\nIf I then go into the log, I see messages like\n```\n024-04-25T13:44:09+0100 [WARNING ] dandi 15907:6207451136  Error 1: ValidationResult(id='BIDS.NON_BIDS_PATH_PLACEHOLDER', origin=ValidationOrigin(name='bidsschematools', version='0.7.2', bids_version='1.9.0-dev'), scope=\u003cScope.FILE: 'file'\u003e, severity=\u003cSeverity.ERROR: 3\u003e, asset_paths=None, within_asset_paths=None, dandiset_path=PosixPath('/Volumes/LaCie/linc_staging/000008'), dataset_path=PosixPath('/Volumes/LaCie/linc_staging/000008'), message='File does not match any pattern known to BIDS.', metadata=None, path=PosixPath('/Volumes/LaCie/linc_staging/000008/sub-s45/micr/sub-s45_sample-fullhemisphere_hipCT.json'), path_regex=None)\n2024-04-25T13:44:09+0100 [ERROR   ] dandi 15907:6207451136 Error uploading /Volumes/LaCie/linc_staging/000008/sub-s45/micr/sub-s45_sample-fullhemisphere_hipCT.json:\n```\n\n\u003cdetails\u003e\n\u003csummary\u003e Example full log\u003c/summary\u003e\n\n```\n2024-05-02T14:40:51+0100 [INFO    ] dandi 23264:16516 lincbrain v0.5.0+108.g40a8c76b.dirty, hdmf v3.13.0, pynwb v2.6.0, h5py v3.11.0\n2024-05-02T14:40:51+0100 [INFO    ] dandi 23264:16516 sys.argv = ['C:\\\\Users\\\\dstansby\\\\miniforge3\\\\envs\\\\linc\\\\Scripts\\\\lincbrain', 'upload']\n2024-05-02T14:40:51+0100 [INFO    ] dandi 23264:16516 os.getcwd() = C:\\Users\\dstansby\\data\\linc\\000005\n2024-05-02T14:40:51+0100 [DEBUG   ] urllib3.connectionpool 23264:16516 Starting new HTTPS connection (1): rig.mit.edu:443\n2024-05-02T14:40:52+0100 [DEBUG   ] urllib3.connectionpool 23264:16516 https://rig.mit.edu:443 \"GET /et/projects/linc/linc-cli HTTP/1.1\" 404 44\n2024-05-02T14:40:52+0100 [DEBUG   ] dandi 23264:16516 Could not check linc/linc-cli for version updates: 404 Client Error: Not Found for url: https://rig.mit.edu/et/projects/linc/linc-cli\n2024-05-02T14:40:52+0100 [DEBUG   ] urllib3.connectionpool 23264:16516 Starting new HTTPS connection (1): api.lincbrain.org:443\n2024-05-02T14:40:52+0100 [DEBUG   ] urllib3.connectionpool 23264:16516 https://api.lincbrain.org:443 \"GET /api/info/ HTTP/1.1\" 200 371\n2024-05-02T14:40:52+0100 [DEBUG   ] dandi 23264:16516 GET https://api.lincbrain.org/api/info/\n2024-05-02T14:40:52+0100 [DEBUG   ] urllib3.connectionpool 23264:16516 Starting new HTTPS connection (1): api.lincbrain.org:443\n2024-05-02T14:40:53+0100 [DEBUG   ] urllib3.connectionpool 23264:16516 https://api.lincbrain.org:443 \"GET /api/info/ HTTP/1.1\" 200 371\n2024-05-02T14:40:53+0100 [DEBUG   ] dandi 23264:16516 Response: 200\n2024-05-02T14:40:53+0100 [DEBUG   ] dandi 23264:16516 Using api key from LINCBRAIN_API_KEY environment variable\n2024-05-02T14:40:53+0100 [DEBUG   ] dandi 23264:16516 GET https://api.lincbrain.org/api/auth/token\n2024-05-02T14:40:53+0100 [DEBUG   ] urllib3.connectionpool 23264:16516 https://api.lincbrain.org:443 \"GET /api/auth/token HTTP/1.1\" 301 0\n2024-05-02T14:40:53+0100 [DEBUG   ] urllib3.connectionpool 23264:16516 https://api.lincbrain.org:443 \"GET /api/auth/token/ HTTP/1.1\" 200 42\n2024-05-02T14:40:53+0100 [DEBUG   ] dandi 23264:16516 Response: 200\n2024-05-02T14:40:53+0100 [DEBUG   ] dandi 23264:16516 Found identifier DANDI:000005 in top level 'identifier'\n2024-05-02T14:40:53+0100 [DEBUG   ] h5py._conv 23264:16516 Creating converter from 7 to 5\n2024-05-02T14:40:53+0100 [DEBUG   ] h5py._conv 23264:16516 Creating converter from 5 to 7\n2024-05-02T14:40:53+0100 [DEBUG   ] h5py._conv 23264:16516 Creating converter from 7 to 5\n2024-05-02T14:40:53+0100 [DEBUG   ] h5py._conv 23264:16516 Creating converter from 5 to 7\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'zlib'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'gzip'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'bz2'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'lzma'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'blosc'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'zstd'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'lz4'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'astype'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'delta'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'quantize'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'fixedscaleoffset'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'packbits'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'categorize'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'pickle'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'base64'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'shuffle'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'bitround'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'crc32'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'adler32'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'jenkins_lookup3'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'json2'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'vlen-utf8'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'vlen-bytes'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'vlen-array'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'fletcher32'\n2024-05-02T14:40:53+0100 [DEBUG   ] numcodecs 23264:16516 Registering codec 'n5_wrapper'\n2024-05-02T14:40:54+0100 [INFO    ] dandi 23264:16516 Found 6 files to consider\n2024-05-02T14:40:55+0100 [WARNING ] bids-schema 23264:17416 No BIDS reference root provided.\n2024-05-02T14:40:55+0100 [INFO    ] bids-schema 23264:17416 No schema path specified, defaulting to the bundled schema, `C:\\Users\\dstansby\\miniforge3\\envs\\linc\\Lib\\site-packages\\bidsschematools\\data\\schema`.\n2024-05-02T14:40:55+0100 [WARNING ] bids-schema 23264:17416 The `C:/Users/dstansby/data/linc/000005/rawdata/sub-S45/sub-S45_sample-fullhemisphere_PC.ome.zarr/` file was not matched by any regex schema entry.\n2024-05-02T14:40:56+0100 [WARNING ] dandi 23264:17416 'C:\\\\Users\\\\dstansby\\\\data\\\\linc\\\\000005\\\\dataset_description.json' had 1 validation errors preventing its upload:\n2024-05-02T14:40:56+0100 [WARNING ] dandi 23264:17416  Error 1: ValidationResult(id='BIDS.NON_BIDS_PATH_PLACEHOLDER', origin=ValidationOrigin(name='bidsschematools', version='0.7.2', bids_version='1.9.0-dev'), scope=\u003cScope.FILE: 'file'\u003e, severity=\u003cSeverity.ERROR: 3\u003e, asset_paths=None, within_asset_paths=None, dandiset_path=WindowsPath('C:/Users/dstansby/data/linc/000005'), dataset_path=WindowsPath('C:/Users/dstansby/data/linc/000005'), message='File does not match any pattern known to BIDS.', metadata=None, path=WindowsPath('C:/Users/dstansby/data/linc/000005/rawdata/sub-S45/sub-S45_sample-fullhemisphere_PC.ome.zarr'), path_regex=None)\n2024-05-02T14:40:56+0100 [ERROR   ] dandi 23264:17416 Error uploading C:\\Users\\dstansby\\data\\linc\\000005\\dataset_description.json:\nTraceback (most recent call last):\n  File \"C:\\Users\\dstansby\\miniforge3\\envs\\linc\\Lib\\site-packages\\lincbrain\\upload.py\", line 280, in process_path\n    raise UploadError(\"failed validation\")\nlincbrain.exceptions.UploadError: failed validation\n2024-05-02T14:40:56+0100 [DEBUG   ] fscacher.cache 23264:29792 Calling memoized version of \u003cfunction get_digest at 0x0000025AF771B7E0\u003e for C:\\Users\\dstansby\\data\\linc\\000005\\rawdata\\sub-S45\\sub-S45_sample-fullhemisphere_PC.json\n2024-05-02T14:40:56+0100 [DEBUG   ] fscacher.cache 23264:22488 Calling memoized version of \u003cfunction get_digest at 0x0000025AF771B7E0\u003e for C:\\Users\\dstansby\\data\\linc\\000005\\samples.tsv\n2024-05-02T14:40:56+0100 [DEBUG   ] fscacher.cache 23264:30128 Calling memoized version of \u003cfunction get_digest at 0x0000025AF771B7E0\u003e for C:\\Users\\dstansby\\data\\linc\\000005\\participants.tsv\n2024-05-02T14:40:56+0100 [DEBUG   ] fscacher.cache 23264:29792 Running original \u003cfunction get_digest at 0x0000025AF771B7E0\u003e on WindowsPath('C:/Users/dstansby/data/linc/000005/rawdata/sub-S45/sub-S45_sample-fullhemisphere_PC.json')\n2024-05-02T14:40:56+0100 [DEBUG   ] fscacher.cache 23264:29792 Calling memoized version of \u003cfunction get_dandietag at 0x0000025AF77187C0\u003e for C:\\Users\\dstansby\\data\\linc\\000005\\rawdata\\sub-S45\\sub-S45_sample-fullhemisphere_PC.json\n2024-05-02T14:40:56+0100 [DEBUG   ] dandi 23264:22488 GET https://api.lincbrain.org/api/dandisets/000005/versions/draft/assets/\n2024-05-02T14:40:56+0100 [DEBUG   ] dandi 23264:30128 GET https://api.lincbrain.org/api/dandisets/000005/versions/draft/assets/\n2024-05-02T14:40:56+0100 [DEBUG   ] urllib3.connectionpool 23264:30128 Starting new HTTPS connection (2): api.lincbrain.org:443\n2024-05-02T14:40:56+0100 [DEBUG   ] fscacher.cache 23264:29792 Running original \u003cfunction get_dandietag at 0x0000025AF77187C0\u003e on WindowsPath('C:/Users/dstansby/data/linc/000005/rawdata/sub-S45/sub-S45_sample-fullhemisphere_PC.json')\n2024-05-02T14:40:56+0100 [DEBUG   ] dandi 23264:29792 GET https://api.lincbrain.org/api/dandisets/000005/versions/draft/assets/\n2024-05-02T14:40:56+0100 [DEBUG   ] urllib3.connectionpool 23264:29792 Starting new HTTPS connection (3): api.lincbrain.org:443\n2024-05-02T14:40:56+0100 [DEBUG   ] urllib3.connectionpool 23264:22488 https://api.lincbrain.org:443 \"GET /api/dandisets/000005/versions/draft/assets/?path=samples.tsv HTTP/1.1\" 200 274\n2024-05-02T14:40:56+0100 [DEBUG   ] dandi 23264:22488 Response: 200\n2024-05-02T14:40:56+0100 [DEBUG   ] dandi 23264:22488 GET https://api.lincbrain.org/api/dandisets/000005/versions/draft/assets/d5c15a56-afd6-4b3b-a37b-b052849dbfc1/\n2024-05-02T14:40:56+0100 [DEBUG   ] urllib3.connectionpool 23264:22488 https://api.lincbrain.org:443 \"GET /api/dandisets/000005/versions/draft/assets/d5c15a56-afd6-4b3b-a37b-b052849dbfc1/ HTTP/1.1\" 200 1911\n2024-05-02T14:40:56+0100 [DEBUG   ] dandi 23264:22488 Response: 200\n2024-05-02T14:40:56+0100 [DEBUG   ] urllib3.connectionpool 23264:29792 https://api.lincbrain.org:443 \"GET /api/dandisets/000005/versions/draft/assets/?path=rawdata%2Fsub-S45%2Fsub-S45_sample-fullhemisphere_PC.json HTTP/1.1\" 200 52\n2024-05-02T14:40:56+0100 [DEBUG   ] dandi 23264:29792 Response: 200\n2024-05-02T14:40:57+0100 [DEBUG   ] urllib3.connectionpool 23264:30128 https://api.lincbrain.org:443 \"GET /api/dandisets/000005/versions/draft/assets/?path=participants.tsv HTTP/1.1\" 200 278\n2024-05-02T14:40:57+0100 [DEBUG   ] dandi 23264:30128 Response: 200\n2024-05-02T14:40:57+0100 [DEBUG   ] dandi 23264:30128 GET https://api.lincbrain.org/api/dandisets/000005/versions/draft/assets/aef8d0c9-0cd3-46d6-a2ac-3dfdee3fa06b/\n2024-05-02T14:40:57+0100 [DEBUG   ] fscacher.cache 23264:29792 Calling memoized version of \u003cfunction get_dandietag at 0x0000025AF77187C0\u003e for C:\\Users\\dstansby\\data\\linc\\000005\\rawdata\\sub-S45\\sub-S45_sample-fullhemisphere_PC.json\n2024-05-02T14:40:57+0100 [DEBUG   ] dandi 23264:29792 Calculated dandi-etag of df515b2ad6855b779e78e4ec58fdd98f-1 for C:\\Users\\dstansby\\data\\linc\\000005\\rawdata\\sub-S45\\sub-S45_sample-fullhemisphere_PC.json\n2024-05-02T14:40:57+0100 [DEBUG   ] dandi 23264:29792 rawdata/sub-S45/sub-S45_sample-fullhemisphere_PC.json: Beginning upload\n2024-05-02T14:40:57+0100 [DEBUG   ] dandi 23264:29792 POST https://api.lincbrain.org/api/uploads/initialize/\n2024-05-02T14:40:57+0100 [DEBUG   ] urllib3.connectionpool 23264:30128 https://api.lincbrain.org:443 \"GET /api/dandisets/000005/versions/draft/assets/aef8d0c9-0cd3-46d6-a2ac-3dfdee3fa06b/ HTTP/1.1\" 200 1915\n2024-05-02T14:40:57+0100 [DEBUG   ] dandi 23264:30128 Response: 200\n2024-05-02T14:40:57+0100 [DEBUG   ] urllib3.connectionpool 23264:29792 https://api.lincbrain.org:443 \"POST /api/uploads/initialize/ HTTP/1.1\" 200 649\n2024-05-02T14:40:57+0100 [DEBUG   ] dandi 23264:29792 Response: 200\n2024-05-02T14:40:57+0100 [DEBUG   ] dandi 23264:29792 Uploading C:\\Users\\dstansby\\data\\linc\\000005\\rawdata\\sub-S45\\sub-S45_sample-fullhemisphere_PC.json in 1 parts\n2024-05-02T14:40:57+0100 [DEBUG   ] dandi 23264:17160 rawdata/sub-S45/sub-S45_sample-fullhemisphere_PC.json: Uploading part 1/1 (104 bytes)\n2024-05-02T14:40:57+0100 [DEBUG   ] dandi 23264:17160 PUT https://linc-brain-mit-prod-us-east-2.s3.amazonaws.com/blobs/082/cda/082cda3f-a994-4728-bf34-8108ab122bed?uploadId=Z2kNpaZNkweXvXF89FWh.LbEXpd2k8DDWQkao682wEbuzwEh0KyCM53smXHSRhUjZP6N4ws8RzVP.cuG2rPVAV1Yf4H_ESgTNh.cZW0b89lFQDgo0UTWRU2puiaw7Wk2\u0026partNumber=1\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIASGOXNDXVRY2HBTF3%2F20240502%2Fus-east-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20240502T134058Z\u0026X-Amz-Expires=604800\u0026X-Amz-SignedHeaders=content-length%3Bhost\u0026X-Amz-Signature=c431ce73c38b9c8c2ffe2ebbfb08e06ee5b5274731c6b0b06bd56ec39efa48b9\n2024-05-02T14:40:57+0100 [DEBUG   ] urllib3.connectionpool 23264:17160 Starting new HTTPS connection (1): linc-brain-mit-prod-us-east-2.s3.amazonaws.com:443\n2024-05-02T14:40:58+0100 [DEBUG   ] urllib3.connectionpool 23264:17160 https://linc-brain-mit-prod-us-east-2.s3.amazonaws.com:443 \"PUT /blobs/082/cda/082cda3f-a994-4728-bf34-8108ab122bed?uploadId=Z2kNpaZNkweXvXF89FWh.LbEXpd2k8DDWQkao682wEbuzwEh0KyCM53smXHSRhUjZP6N4ws8RzVP.cuG2rPVAV1Yf4H_ESgTNh.cZW0b89lFQDgo0UTWRU2puiaw7Wk2\u0026partNumber=1\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIASGOXNDXVRY2HBTF3%2F20240502%2Fus-east-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20240502T134058Z\u0026X-Amz-Expires=604800\u0026X-Amz-SignedHeaders=content-length%3Bhost\u0026X-Amz-Signature=c431ce73c38b9c8c2ffe2ebbfb08e06ee5b5274731c6b0b06bd56ec39efa48b9 HTTP/1.1\" 200 0\n2024-05-02T14:40:58+0100 [DEBUG   ] dandi 23264:17160 Response: 200\n2024-05-02T14:40:58+0100 [DEBUG   ] dandi 23264:17160 rawdata/sub-S45/sub-S45_sample-fullhemisphere_PC.json: Part upload finished ETag=6a057fca28c6d756dae00c6160579d31 Content-Length=0\n2024-05-02T14:40:58+0100 [DEBUG   ] dandi 23264:29792 rawdata/sub-S45/sub-S45_sample-fullhemisphere_PC.json: Completing upload\n2024-05-02T14:40:58+0100 [DEBUG   ] dandi 23264:29792 POST https://api.lincbrain.org/api/uploads/082cda3f-a994-4728-bf34-8108ab122bed/complete/\n2024-05-02T14:40:58+0100 [DEBUG   ] urllib3.connectionpool 23264:29792 https://api.lincbrain.org:443 \"POST /api/uploads/082cda3f-a994-4728-bf34-8108ab122bed/complete/ HTTP/1.1\" 200 768\n2024-05-02T14:40:58+0100 [DEBUG   ] dandi 23264:29792 Response: 200\n2024-05-02T14:40:58+0100 [DEBUG   ] dandi 23264:29792 rawdata/sub-S45/sub-S45_sample-fullhemisphere_PC.json: Announcing completion to https://linc-brain-mit-prod-us-east-2.s3.amazonaws.com/blobs/082/cda/082cda3f-a994-4728-bf34-8108ab122bed?uploadId=Z2kNpaZNkweXvXF89FWh.LbEXpd2k8DDWQkao682wEbuzwEh0KyCM53smXHSRhUjZP6N4ws8RzVP.cuG2rPVAV1Yf4H_ESgTNh.cZW0b89lFQDgo0UTWRU2puiaw7Wk2\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIASGOXNDXVRY2HBTF3%2F20240502%2Fus-east-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20240502T134058Z\u0026X-Amz-Expires=604800\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3b46212653ca7ccabaeae1a69ddce210dde5e5b6f29e186495fad5dac065b4b1\n2024-05-02T14:40:58+0100 [DEBUG   ] dandi 23264:29792 POST https://linc-brain-mit-prod-us-east-2.s3.amazonaws.com/blobs/082/cda/082cda3f-a994-4728-bf34-8108ab122bed?uploadId=Z2kNpaZNkweXvXF89FWh.LbEXpd2k8DDWQkao682wEbuzwEh0KyCM53smXHSRhUjZP6N4ws8RzVP.cuG2rPVAV1Yf4H_ESgTNh.cZW0b89lFQDgo0UTWRU2puiaw7Wk2\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIASGOXNDXVRY2HBTF3%2F20240502%2Fus-east-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20240502T134058Z\u0026X-Amz-Expires=604800\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3b46212653ca7ccabaeae1a69ddce210dde5e5b6f29e186495fad5dac065b4b1\n2024-05-02T14:40:58+0100 [DEBUG   ] urllib3.connectionpool 23264:29792 https://linc-brain-mit-prod-us-east-2.s3.amazonaws.com:443 \"POST /blobs/082/cda/082cda3f-a994-4728-bf34-8108ab122bed?uploadId=Z2kNpaZNkweXvXF89FWh.LbEXpd2k8DDWQkao682wEbuzwEh0KyCM53smXHSRhUjZP6N4ws8RzVP.cuG2rPVAV1Yf4H_ESgTNh.cZW0b89lFQDgo0UTWRU2puiaw7Wk2\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIASGOXNDXVRY2HBTF3%2F20240502%2Fus-east-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20240502T134058Z\u0026X-Amz-Expires=604800\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=3b46212653ca7ccabaeae1a69ddce210dde5e5b6f29e186495fad5dac065b4b1 HTTP/1.1\" 200 None\n2024-05-02T14:40:58+0100 [DEBUG   ] dandi 23264:29792 Response: 200\n2024-05-02T14:40:58+0100 [DEBUG   ] dandi 23264:29792 rawdata/sub-S45/sub-S45_sample-fullhemisphere_PC.json: Upload completed. Response content: b'\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\\n\\n\u003cCompleteMultipartUploadResult xmlns=\"http://s3.amazonaws.com/doc/2006-03-01/\"\u003e\u003cLocation\u003ehttps://linc-brain-mit-prod-us-east-2.s3.amazonaws.com/blobs%2F082%2Fcda%2F082cda3f-a994-4728-bf34-8108ab122bed\u003c/Location\u003e\u003cBucket\u003elinc-brain-mit-prod-us-east-2\u003c/Bucket\u003e\u003cKey\u003eblobs/082/cda/082cda3f-a994-4728-bf34-8108ab122bed\u003c/Key\u003e\u003cETag\u003e\"df515b2ad6855b779e78e4ec58fdd98f-1\"\u003c/ETag\u003e\u003c/CompleteMultipartUploadResult\u003e'\n2024-05-02T14:40:58+0100 [DEBUG   ] charset_normalizer 23264:29792 Encoding detection: utf_8 is most likely the one.\n2024-05-02T14:40:58+0100 [DEBUG   ] dandi 23264:29792 POST https://api.lincbrain.org/api/uploads/082cda3f-a994-4728-bf34-8108ab122bed/validate/\n2024-05-02T14:40:58+0100 [DEBUG   ] urllib3.connectionpool 23264:29792 https://api.lincbrain.org:443 \"POST /api/uploads/082cda3f-a994-4728-bf34-8108ab122bed/validate/ HTTP/1.1\" 200 119\n2024-05-02T14:40:58+0100 [DEBUG   ] dandi 23264:29792 Response: 200\n2024-05-02T14:40:58+0100 [DEBUG   ] dandi 23264:29792 rawdata/sub-S45/sub-S45_sample-fullhemisphere_PC.json: Assigning asset blob to dandiset \u0026 version\n2024-05-02T14:40:58+0100 [DEBUG   ] dandi 23264:29792 POST https://api.lincbrain.org/api/dandisets/000005/versions/draft/assets/\n2024-05-02T14:40:58+0100 [DEBUG   ] urllib3.connectionpool 23264:29792 https://api.lincbrain.org:443 \"POST /api/dandisets/000005/versions/draft/assets/ HTTP/1.1\" 200 2182\n2024-05-02T14:40:58+0100 [DEBUG   ] dandi 23264:29792 Response: 200\n2024-05-02T14:40:58+0100 [INFO    ] dandi 23264:29792 rawdata/sub-S45/sub-S45_sample-fullhemisphere_PC.json: Asset successfully uploaded\n2024-05-02T14:41:05+0100 [WARNING ] dandi 23264:1616 'C:\\\\Users\\\\dstansby\\\\data\\\\linc\\\\000005\\\\rawdata\\\\sub-S45\\\\sub-S45_sample-fullhemisphere_PC.ome.zarr' had 2 validation errors preventing its upload:\n2024-05-02T14:41:05+0100 [WARNING ] dandi 23264:1616  Error 1: ValidationResult(id='BIDS.NON_BIDS_PATH_PLACEHOLDER', origin=ValidationOrigin(name='bidsschematools', version='0.7.2', bids_version='1.9.0-dev'), scope=\u003cScope.FILE: 'file'\u003e, severity=\u003cSeverity.ERROR: 3\u003e, asset_paths=None, within_asset_paths=None, dandiset_path=WindowsPath('C:/Users/dstansby/data/linc/000005'), dataset_path=WindowsPath('C:/Users/dstansby/data/linc/000005'), message='File does not match any pattern known to BIDS.', metadata=None, path=WindowsPath('C:/Users/dstansby/data/linc/000005/rawdata/sub-S45/sub-S45_sample-fullhemisphere_PC.ome.zarr'), path_regex=None)\n2024-05-02T14:41:05+0100 [WARNING ] dandi 23264:1616  Error 2: ValidationResult(id='BIDS.NON_BIDS_PATH_PLACEHOLDER', origin=ValidationOrigin(name='bidsschematools', version='0.7.2', bids_version='1.9.0-dev'), scope=\u003cScope.FILE: 'file'\u003e, severity=\u003cSeverity.ERROR: 3\u003e, asset_paths=None, within_asset_paths=None, dandiset_path=WindowsPath('C:/Users/dstansby/data/linc/000005'), dataset_path=WindowsPath('C:/Users/dstansby/data/linc/000005'), message='File does not match any pattern known to BIDS.', metadata=None, path=WindowsPath('C:/Users/dstansby/data/linc/000005/rawdata/sub-S45/sub-S45_sample-fullhemisphere_PC.ome.zarr'), path_regex=None)\n2024-05-02T14:41:05+0100 [ERROR   ] dandi 23264:1616 Error uploading C:\\Users\\dstansby\\data\\linc\\000005\\rawdata\\sub-S45\\sub-S45_sample-fullhemisphere_PC.ome.zarr:\nTraceback (most recent call last):\n  File \"C:\\Users\\dstansby\\miniforge3\\envs\\linc\\Lib\\site-packages\\lincbrain\\upload.py\", line 280, in process_path\n    raise UploadError(\"failed validation\")\nlincbrain.exceptions.UploadError: failed validation\n2024-05-02T14:41:05+0100 [WARNING ] dandi 23264:16516 One or more assets failed validation.  Consult the logfile for details.\n2024-05-02T14:41:05+0100 [DEBUG   ] urllib3.connectionpool 23264:16516 Starting new HTTPS connection (1): rig.mit.edu:443\n2024-05-02T14:41:06+0100 [DEBUG   ] urllib3.connectionpool 23264:16516 https://rig.mit.edu:443 \"GET /et/projects/lincbrain/linc-cli HTTP/1.1\" 200 578\n2024-05-02T14:41:06+0100 [WARNING ] dandi 23264:16516 Upload failed, and you are not using the latest version of lincbrain-cli.  We suggest upgrading lincbrain-cli to v0.9.0 and trying again.\n2024-05-02T14:41:06+0100 [DEBUG   ] dandi 23264:16516 Caught exception failed validation\n2024-05-02T14:41:06+0100 [INFO    ] dandi 23264:16516 Logs saved in C:\\Users\\dstansby\\AppData\\Local\\lincbrain\\lincbrain-cli\\Logs\\20240502134051Z-23264.log\n```\n\n\u003c/details\u003e\n\nThese messages are hard to parse by eye, and even then the error is just \"File does not match any pattern known to BIDS\". It would be super useful if there was some hint (maybe at least a link to the BIDS spec?) on how the file pattern can be fixed.\n\nRelated issue:\n1. https://github.com/dandi/dandi-cli/issues/1397\n\nThank you\n\ncc @dstansby @aaronkanzer","files":null}]}