{"version":2,"ops":[{"type":1,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1614017997,"metadata":{"github-id":"MDU6SXNzdWU4MTM3OTg1NjQ=","github-url":"https://github.com/dandi/dandi-cli/issues/416","origin":"github"},"title":"even more logging detail ! ;)","message":"```\n                           SIZE        ERRORS     UPLOAD STATUS                MESSAGE\nsub-YutaMouse33/sub-YutaMouse33_ses-YutaMouse33-150218_behavior+ecephys.nwb 11.9 GB        3              skipped               failed validation\nsub-YutaMouse33/sub-YutaMouse33_ses-YutaMouse33-150223_behavior+ecephys.nwb 143.5 GB       0              ERROR                 ('Connection aborted.', OSError(\"(32, 'EPIPE')\"))\n```\nbut log has no detail:\n```shell\ndrogon:~/.cache/dandi-cli/log\n$\u003e grep -i aborted 20210222181008Z-6322.log\n```\nI guess is happening higher in the overall `upload` command.\n\n\nunrelated: since we are uploading in parallel (iirc threads) may be worth adding by default a thread id into each log line, but iirc we also have multiprocessing used, so we better add both - `PID:THREAD` in each line.  Otherwise it is hard to impossible to associate different log lines to different ongoing processes/files  e.g. in \n```\n2021-02-22T13:10:11-0500 [DEBUG   ] dandi Calculated sha256 digest of 81a6e764bda0c0cfa4b96d200b103d347e7d7c7c4ee82665b5b9784f8d2084cf for sub-YutaMouse33/sub-YutaMouse33_ses-YutaMouse33-150226_behavior+ecephys.nwb\n2021-02-22T13:10:11-0500 [DEBUG   ] dandi POST https://api.dandiarchive.org/api/uploads/validate/\n2021-02-22T13:10:11-0500 [DEBUG   ] dandi Response: 400\n2021-02-22T13:10:11-0500 [ERROR   ] dandi Error 400 while sending POST request to https://api.dandiarchive.org/api/uploads/validate/: [\"A validation for an object with that checksum does not exist.\"]\n2021-02-22T13:10:11-0500 [DEBUG   ] dandi Blob does not already exist on server\n2021-02-22T13:10:11-0500 [DEBUG   ] dandi Beginning upload\n2021-02-22T13:10:11-0500 [DEBUG   ] dandi POST https://api.dandiarchive.org/api/uploads/initialize/\n2021-02-22T13:10:12-0500 [DEBUG   ] dandi Response: 204\n2021-02-22T13:10:12-0500 [DEBUG   ] dandi Blob is already uploaded to server\n2021-02-22T13:10:12-0500 [DEBUG   ] dandi Waiting for server-side validation to complete\n2021-02-22T13:10:12-0500 [DEBUG   ] dandi GET https://api.dandiarchive.org/api/uploads/validations/81a6e764bda0c0cfa4b96d200b103d347e7d7c7c4ee82665b5b9784f8d2084cf/\n2021-02-22T13:10:12-0500 [DEBUG   ] dandi Response: 200\n```","files":null}]}