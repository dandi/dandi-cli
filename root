{"version":2,"ops":[{"type":1,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1617985253,"metadata":{"github-id":"MDU6SXNzdWU4NTQ2NzEzMjc=","github-url":"https://github.com/dandi/dandi-cli/issues/541","origin":"github"},"title":"automate switching to `-i dandi-api` via `dandiarchive.org/server-info` information","message":"ATM that one reports\n```json\n{\n\"version\": \"1.0.0\",\n\"cli-minimal-version\": \"0.6.0\",\n\"cli-bad-versions\": [],\n\"services\": {\n\"girder\": {\n\"url\": \"https://girder.dandiarchive.org\"\n},\n\"webui\": {\n\"url\": \"https://gui.dandiarchive.org\"\n},\n\"api\": {\n\"url\": \"https://publish.dandiarchive.org/api\"\n},\n\"jupyterhub\": {\n\"url\": \"https://hub.dandiarchive.org\"\n}\n}\n}\n```\n\nI think  we should \n- change redirector it to remove entry for `\"api\"` since that service is long gone (and boost `version` to e.g. `1.1.0`)\n- double check that `dandi-cli` would refuse to interact with the archive if its version is below minimal one specified in that `server-info`\n- adjust `dandi-cli` so if there is a url for `\"api\"`, we would use `dandi-api` instance by default and not the girder one. (alternative - do that if there is no \"girder\")\n- release `dandi-cli` 0.14.0\n\nUpon migration\n- in redirector - adjust minimal version of the client to become `0.14.0` (assuming that is the one which it would be with default switch) and add `\"url\"` for the `\"api\"` and remove \"girder\", so released client would automagically switch to use `dandi-api` instance \n\nany flaw in above plan/logic @satra ?","files":null}]}