{"version":2,"ops":[{"type":1,"author":{"id":"adccd23cf679e6fb55b1c23d1d08cb100dec6f4e"},"timestamp":1656433478,"metadata":{"github-id":"I_kwDODBZtRc5MvzAt","github-url":"https://github.com/dandi/dandi-cli/issues/1033","origin":"github"},"title":"Error during upload, \"A header you provided implies functionality that is not implemented\"","message":"I received an error when attempting to upload a file using Dandi-cli. My command is as follows:\n\n`DANDI_DEVEL=1 dandi upload --validation skip --allow-any-path /mnt/beegfs/Lee/dandi/sub-MITU01/ses-20220326h13m51s50/micr/sub-MITU01_ses-20220326h13m51s50_sample-10_stain-YO_run-1_chunk-4_SPIM.ome.zarr`\n\nFor further context, the file I was attempting to upload was for a sample in our dataset which had already been uploaded, save for this and a couple other files. I wrote a script to identify what chunks existed within our system but not within Dandi and found it, and then wrote a follow up script to attempt to upload each of them in turn. While many uploaded successfully, this file, as well as others failed during the upload process with the following error.\n\nBelow is the logs excerpt containing the error, the full log is also attached at the bottom of the issue, though it's quite large and thus I had to include it as a link to a file sharing service.\n\n```\n2022-06-27T17:11:41-0400 [ERROR   ] dandi 618787:139768136976128 Error 501 while sending PUT request to https://dandiarchive.s3.amazonaws.com/zarr/50511c2d-e5ce-457e-99ee-ffc859b8de03/0/0/0/9/4/35?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAUBRWC5GAEKH3223E%2F20220627%2Fus-east-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20220627T211133Z\u0026X-Amz-Expires=600\u0026X-Amz-SignedHeaders=host%3Bx-amz-acl\u0026X-Amz-Signature=baf2e69af124279d581e2fe02c77cf4c027ef0fbd44b1688fa0458a46bcf2756: \u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e\n\u003cError\u003e\u003cCode\u003eNotImplemented\u003c/Code\u003e\u003cMessage\u003eA header you provided implies functionality that is not implemented\u003c/Message\u003e\u003cHeader\u003eTransfer-Encoding\u003c/Header\u003e\u003cRequestId\u003eKJHAC7XZA5G3XNCV\u003c/RequestId\u003e\u003cHostId\u003emfKcxnfrx3JjgAb3Ys1BiigdSo/+bXbHuu8NQMSFw4qxoNdU8YzZ9P0YMIzUITS/63buuBunens=\u003c/HostId\u003e\u003c/Error\u003e\n2022-06-27T17:11:41-0400 [DEBUG   ] dandi 618787:139768694290176 Error uploading zarr: HTTPError: Error 501 while sending PUT request to https://dandiarchive.s3.amazonaws.com/zarr/50511c2d-e5ce-457e-99ee-ffc859b8de03/0/0/0/9/4/35?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAUBRWC5GAEKH3223E%2F20220627%2Fus-east-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20220627T211133Z\u0026X-Amz-Expires=600\u0026X-Amz-SignedHeaders=host%3Bx-amz-acl\u0026X-Amz-Signature=baf2e69af124279d581e2fe02c77cf4c027ef0fbd44b1688fa0458a46bcf2756\n2022-06-27T17:11:41-0400 [DEBUG   ] dandi 618787:139768694290176 Cancelling upload\n2022-06-27T17:11:41-0400 [DEBUG   ] dandi 618787:139768136976128 PUT https://dandiarchive.s3.amazonaws.com/zarr/50511c2d-e5ce-457e-99ee-ffc859b8de03/0/0/0/9/15/121?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAUBRWC5GAEKH3223E%2F20220627%2Fus-east-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20220627T211133Z\u0026X-Amz-Expires=600\u0026X-Amz-SignedHeaders=host%3Bx-amz-acl\u0026X-Amz-Signature=26b0e9a95bf11d26526037c2779dbcf3e965996b39c34a4c2192fe744bbda076\n2022-06-27T17:11:41-0400 [DEBUG   ] urllib3.connectionpool 618787:139768136976128 Resetting dropped connection: dandiarchive.s3.amazonaws.com\n2022-06-27T17:11:41-0400 [DEBUG   ] urllib3.connectionpool 618787:139767765268224 https://dandiarchive.s3.amazonaws.com:443 \"PUT /zarr/50511c2d-e5ce-457e-99ee-ffc859b8de03/0/0/0/9/15/58?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAUBRWC5GAEKH3223E%2F20220627%2Fus-east-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20220627T211133Z\u0026X-Amz-Expires=600\u0026X-Amz-SignedHeaders=host%3Bx-amz-acl\u0026X-Amz-Signature=a39c920b3c1205c96f04e8110e575788baf344b95a74c45b26338972105e4b0c HTTP/1.1\" 200 0\n2022-06-27T17:11:41-0400 [DEBUG   ] dandi 618787:139767765268224 Response: 200\n2022-06-27T17:11:41-0400 [DEBUG   ] urllib3.connectionpool 618787:139767756875520 https://dandiarchive.s3.amazonaws.com:443 \"PUT /zarr/50511c2d-e5ce-457e-99ee-ffc859b8de03/0/0/0/9/15/60?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAUBRWC5GAEKH3223E%2F20220627%2Fus-east-2%2Fs3%2Faws4_request\u0026X-Amz-Date=20220627T211133Z\u0026X-Amz-Expires=600\u0026X-Amz-SignedHeaders=host%3Bx-amz-acl\u0026X-Amz-Signature=05bd82bd62cac59f906e3dfe342de9e0020a3cb28ff243cbf7f3e8acc33a4a9c HTTP/1.1\" 200 0\n```\n\nFull Log File:\nhttps://drive.google.com/file/d/1QEFwU4vyIeK3eCbtM8PZ3-Ursv7PFDHR/view?usp=sharing","files":null}]}