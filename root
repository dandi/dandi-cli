{"version":2,"ops":[{"type":1,"author":{"id":"0ab0e40999605aa8d5ec6be68372511fdc4a2fdf"},"timestamp":1633527649,"metadata":{"github-id":"I_kwDODBZtRc48ss8Y","github-url":"https://github.com/dandi/dandi-cli/issues/788","origin":"github"},"title":"Version check for etelemetry fails","message":"I get the following error message when attempting to run `dandi`:\n\n```\nTraceback (most recent call last):\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 568, in _build_master\n    ws.require(__requires__)\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 886, in require\n    needed = self.resolve(parse_requirements(requirements))\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 777, in resolve\n    raise VersionConflict(dist, req).with_context(dependent_req)\npkg_resources.ContextualVersionConflict: (etelemetry 0+unknown (/usr/lib/python3.9/site-packages), Requirement.parse('etelemetry\u003e=0.2.2'), {'dandi'})\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/usr/lib/python-exec/python3.9/dandi\", line 33, in \u003cmodule\u003e\n    sys.exit(load_entry_point('dandi==0+unknown', 'console_scripts', 'dandi')())\n  File \"/usr/lib/python-exec/python3.9/dandi\", line 25, in importlib_load_entry_point\n    return next(matches).load()\n  File \"/usr/lib/python3.9/importlib/metadata.py\", line 77, in load\n    module = import_module(match.group('module'))\n  File \"/usr/lib/python3.9/importlib/__init__.py\", line 127, in import_module\n    return _bootstrap._gcd_import(name[level:], package, level)\n  File \"\u003cfrozen importlib._bootstrap\u003e\", line 1030, in _gcd_import\n  File \"\u003cfrozen importlib._bootstrap\u003e\", line 1007, in _find_and_load\n  File \"\u003cfrozen importlib._bootstrap\u003e\", line 986, in _find_and_load_unlocked\n  File \"\u003cfrozen importlib._bootstrap\u003e\", line 680, in _load_unlocked\n  File \"\u003cfrozen importlib._bootstrap_external\u003e\", line 850, in exec_module\n  File \"\u003cfrozen importlib._bootstrap\u003e\", line 228, in _call_with_frames_removed\n  File \"/usr/lib/python3.9/site-packages/dandi/cli/command.py\", line 18, in \u003cmodule\u003e\n    from ..utils import get_module_version\n  File \"/usr/lib/python3.9/site-packages/dandi/utils.py\", line 27, in \u003cmodule\u003e\n    import ruamel.yaml\n  File \"/usr/lib/python3.9/site-packages/ruamel/__init__.py\", line 1, in \u003cmodule\u003e\n    __import__('pkg_resources').declare_namespace(__name__)\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 3243, in \u003cmodule\u003e\n    def _initialize_master_working_set():\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 3226, in _call_aside\n    f(*args, **kwargs)\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 3255, in _initialize_master_working_set\n    working_set = WorkingSet._build_master()\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 570, in _build_master\n    return cls._build_from_requirements(__requires__)\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 583, in _build_from_requirements\n    dists = ws.resolve(reqs, Environment())\n  File \"/usr/lib/python3.9/site-packages/pkg_resources/__init__.py\", line 772, in resolve\n    raise DistributionNotFound(req, requirers)\npkg_resources.DistributionNotFound: The 'etelemetry\u003e=0.2.2' distribution was not found and is required by dandi\n```\n\nThis is strange, because I have `=etelemetry-0.2.2` installed (`import etelemetry` works in a Python shell, but it appears there's no such thing as `etelemetry.__version__` which I could show you).\n\nI think I had this issue before when packaging nipype, but there it seemed sensible to just sed etelemetry out.\nOfc it's obvious here that version checking is crucial in order to keep schema consistency, and assume there are good reasons for doing this check client-side (instead of the server just refusing the upload) in the etelemetry discussions had before, though I couldn't find them :(","files":null}]}