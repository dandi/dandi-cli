{"version":2,"ops":[{"type":1,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1713967537,"metadata":{"github-id":"I_kwDODBZtRc6Gyhqg","github-url":"https://github.com/dandi/dandi-cli/issues/1431","origin":"github"},"title":"organize: look what we are missing when assigning suffix... make it mandatory to detect early?","message":"ATM there is a number of dandisets which have no `_suffix`es in the filenames, which I assume come from `dandi organize` (didn't check/validate).\n\n\u003cdetails\u003e\n\u003csummary\u003eHere is stats on suffixes we have ATM\u003c/summary\u003e \nOverall across all\n\n```shell\ndandi@drogon:/mnt/backup/dandi/dandisets$ for d in 0*; do find $d -iname sub*_*.nwb | sed -e 's,.*_,,g' -e 's,\\.nwb$,,g' | grep -v - | sort ; done | sort | uniq -c  | sort -n -r\n  38219 ophys\n  11108 icephys\n   8459 image\n   6958 behavior+image\n   6306 ecephys\n   4012 behavior\n   3467 image+ophys\n   2205 behavior+ecephys\n   2010 behavior+image+ophys\n   1612 behavior+ophys\n   1440 behavior+image+ogen\n    843 ecephys+ogen\n    404 behavior+ecephys+ogen\n    404 behavior+ecephys+image\n    253 ecephys+image\n    230 behavior+image+ogen+ophys\n    187 behavior+icephys+ogen\n    125 behavior+task\n    124 spikesorting\n    106 icephys+image\n     74 behavior+ecephys+image+ogen\n     40 ogen\n     32 behavior+icephys\n     26 ecephys+ophys\n      2 ecephys+icephys\n```\n\nDetailed per dandiset which has them:\n\n```shell\n\u003e $ for d in 0*; do dts=$(find $d -iname sub*_*.nwb | sed -e 's,.*_,,g' -e 's,\\.nwb$,,g' | grep -v - | sort | uniq -c); [ -z \"$dts\" ] \u0026\u0026 continue; echo -e \"$d:\\n$dts\";  done\n000003:\n     97 behavior+ecephys\n      4 ecephys\n000004:\n     87 ecephys+image\n000005:\n     18 behavior+ecephys\n      9 behavior+icephys\n    121 behavior+icephys+ogen\n000008:\n   1328 icephys\n000009:\n     36 behavior+icephys+ogen\n     21 ecephys\n    116 ecephys+ogen\n000010:\n     14 behavior+ecephys\n     85 behavior+ecephys+ogen\n     59 behavior+ophys\n000011:\n      1 behavior\n     91 behavior+ecephys+ogen\n000012:\n    297 icephys\n000013:\n     22 behavior+icephys\n     30 behavior+icephys+ogen\n000020:\n   4435 icephys\n000021:\n    182 ecephys\n000022:\n    143 ecephys\n000023:\n    318 icephys\n000028:\n      2 ecephys\n000029:\n      3 behavior+ecephys\n000034:\n      4 ecephys\n000035:\n    185 icephys\n000036:\n     57 behavior+image+ophys\n000037:\n    100 behavior+image+ophys\n     50 behavior+ophys\n000039:\n    100 behavior+ophys\n000041:\n     22 ecephys\n000043:\n     94 icephys\n000044:\n      8 behavior+ecephys\n000045:\n    595 behavior\n    182 behavior+ecephys\n   5822 behavior+image\n     11 image\n000048:\n      1 ecephys+ophys\n000049:\n     78 behavior+ophys\n000050:\n     56 behavior+ophys\n000053:\n    339 behavior\n     20 behavior+ecephys\n000054:\n     79 behavior+ophys\n      6 ophys\n000055:\n     55 behavior+ecephys\n000056:\n     40 behavior+ecephys\n000059:\n     50 behavior+ecephys\n     50 ecephys\n000060:\n     98 behavior+ecephys+ogen\n000061:\n     40 ecephys+image\n000065:\n      1 behavior+ecephys\n000067:\n     10 behavior+ecephys\n     18 ecephys\n000068:\n      1 icephys\n000069:\n      1 behavior+icephys\n000070:\n      9 behavior+ecephys\n000109:\n    350 icephys\n000114:\n     14 ecephys\n     16 ophys\n000115:\n     57 behavior+ecephys\n000117:\n    197 icephys\n000126:\n      4 icephys\n000127:\n      1 behavior+ecephys\n      1 ecephys\n000128:\n      1 behavior+ecephys\n      1 ecephys\n000129:\n      1 behavior+ecephys\n      1 ecephys\n000130:\n      2 ecephys\n000138:\n      1 behavior+ecephys\n      1 ecephys\n000139:\n      1 behavior+ecephys\n      1 ecephys\n000140:\n      1 behavior+ecephys\n      1 ecephys\n000142:\n    717 icephys\n000144:\n      2 ophys\n000147:\n     10 ecephys\n000148:\n     46 icephys\n000149:\n      4 behavior+ecephys+image\n000165:\n    572 behavior+ecephys\n000166:\n     19 ecephys\n000167:\n      1 image+ophys\n      4 ophys\n000206:\n      1 behavior+ophys\n000207:\n     19 ecephys\n000209:\n    291 icephys\n000212:\n   1013 behavior\n000213:\n     67 behavior+ecephys\n000218:\n     74 behavior+ecephys\n     24 ecephys\n000219:\n     31 behavior+image+ophys\n     30 behavior+ophys\n      1 ophys\n000220:\n     34 icephys\n000221:\n    263 ecephys+ogen\n000223:\n     20 ecephys+ophys\n000226:\n     60 behavior\n000228:\n     91 icephys\n000230:\n      9 behavior+ecephys\n000231:\n     44 behavior+ecephys+image\n     71 behavior+image\n000232:\n    130 behavior\n     49 behavior+ecephys\n000233:\n    345 ecephys\n000234:\n     19 ophys\n000235:\n      8 behavior+ophys\n000236:\n      9 behavior+ophys\n000237:\n      8 behavior+ophys\n000238:\n      6 behavior+ophys\n000239:\n    180 behavior\n000240:\n      6 ophys\n000242:\n      6 behavior+ecephys\n000244:\n     33 ophys\n000245:\n     25 icephys\n000246:\n   1027 ophys\n000248:\n     66 ecephys\n     12 ogen\n000249:\n    777 ophys\n000250:\n      3 behavior\n000252:\n     12 ecephys\n000253:\n     84 ecephys\n     14 ogen\n000254:\n      1 behavior+ophys\n000288:\n     36 icephys\n000289:\n    221 behavior+ophys\n000291:\n      1 behavior\n000292:\n     11 icephys\n000293:\n    121 icephys\n000294:\n      2 ecephys+icephys\n000295:\n     26 icephys\n000296:\n   1278 ophys\n000297:\n    118 icephys\n000299:\n      1 ecephys\n000301:\n     14 behavior+ecephys\n000302:\n     11 behavior+ecephys\n     21 behavior+ecephys+ogen\n000336:\n    314 image+ophys\n   2120 ophys\n000337:\n     21 icephys\n000339:\n     66 ecephys\n000341:\n    681 icephys\n    106 icephys+image\n000342:\n      2 behavior\n000345:\n     10 ophys\n000347:\n      1 image+ophys\n      8 ophys\n000350:\n     12 ophys\n000352:\n     17 behavior\n000353:\n      4 behavior\n000354:\n     12 behavior\n000355:\n      7 behavior\n000356:\n      5 behavior\n000357:\n      6 behavior\n000358:\n     12 behavior\n000360:\n      1 image\n000361:\n     32 behavior\n000363:\n      5 behavior+ecephys\n      1 behavior+ecephys+image\n     70 behavior+ecephys+image+ogen\n     98 behavior+ecephys+ogen\n000397:\n      3 ecephys\n000398:\n     42 ecephys\n000399:\n    105 ecephys\n000402:\n     19 behavior+image+ophys\n000407:\n    156 icephys\n000408:\n    228 ecephys\n000409:\n    347 behavior\n     24 behavior+ecephys\n    305 behavior+ecephys+image\n      1 ecephys+image\n000410:\n     22 behavior+ecephys\n000411:\n      1 ecephys\n000447:\n      5 behavior+ecephys\n000448:\n     18 image\n000454:\n      4 ophys\n000458:\n     24 behavior+ecephys\n000459:\n     42 behavior+image+ophys\n000461:\n     14 ophys\n000462:\n     14 ophys\n000463:\n     29 ecephys\n000465:\n     36 ecephys\n000467:\n  14685 ophys\n000469:\n     41 ecephys+image\n000470:\n      1 ophys\n000471:\n     61 behavior\n000472:\n     10 ophys\n000473:\n      1 behavior+ecephys+ogen\n     24 ecephys+ogen\n000477:\n     77 behavior+ophys\n000481:\n      1 ecephys\n000482:\n      1 ecephys\n000483:\n    128 behavior+ophys\n000484:\n     29 behavior\n000485:\n     37 behavior\n000486:\n     36 behavior\n000488:\n     43 behavior+image+ophys\n000489:\n     18 image\n000491:\n     14 ophys\n000493:\n      3 ecephys\n      1 ecephys+ogen\n000526:\n      2 ophys\n000527:\n      8 ophys\n000528:\n      5 ophys\n000529:\n     27 ecephys\n000533:\n    141 behavior+ophys\n000535:\n    115 behavior+ophys\n000537:\n    125 image\n000538:\n     11 image\n000540:\n    495 behavior+image\n000541:\n     21 ophys\n000544:\n      2 behavior+ecephys+ogen\n000546:\n      1 ecephys\n000547:\n     70 ophys\n000548:\n     19 image\n000549:\n     26 image\n000550:\n     17 image\n000552:\n    104 behavior+ecephys\n     13 ecephys\n000553:\n      4 ecephys\n000554:\n     36 ecephys\n000559:\n    111 behavior+image\n   1440 behavior+image+ogen\n    230 behavior+image+ogen+ophys\n    153 behavior+image+ophys\n      5 image+ophys\n      3 ophys\n000562:\n      7 ecephys\n     72 ophys\n000563:\n     81 ecephys\n     14 ogen\n000565:\n     21 ophys\n000566:\n      1 ophys\n000568:\n      2 behavior+ecephys\n     50 behavior+ecephys+image\n      4 behavior+ecephys+image+ogen\n000569:\n    103 icephys\n000570:\n    155 icephys\n000572:\n    289 ecephys+ogen\n000573:\n      1 behavior\n000574:\n     45 behavior+ecephys\n000575:\n     18 behavior+ecephys\n000576:\n      9 ecephys\n      9 ecephys+image\n000579:\n    300 behavior+ophys\n      8 ophys\n000580:\n    116 ophys\n000582:\n    118 behavior+ecephys\n000617:\n    889 image+ophys\n    992 ophys\n000618:\n    124 ecephys\n000620:\n     48 behavior+task\n     47 ecephys\n     47 spikesorting\n000623:\n     29 behavior+ecephys\n000624:\n      8 behavior\n     19 image\n000625:\n      3 behavior+ophys\n000628:\n    679 behavior\n    679 image\n000629:\n    114 behavior+ecephys\n000630:\n    210 icephys\n000631:\n     15 image\n000632:\n     24 image\n000633:\n      2 image\n000634:\n     10 image\n000635:\n     81 icephys\n000636:\n    706 icephys\n000637:\n    292 ecephys\n000673:\n     44 ecephys+image\n000675:\n      3 ecephys\n000681:\n     57 behavior+ophys\n000683:\n      1 ophys\n000684:\n      3 behavior+ecephys\n000685:\n      1 ecephys\n000686:\n     18 image\n000687:\n     11 ecephys\n000688:\n    111 behavior+ecephys\n000690:\n    106 ecephys\n000691:\n      1 image+ophys\n000692:\n      9 ophys\n000696:\n      6 ecephys\n000697:\n     15 behavior\n000698:\n     16 behavior\n000699:\n     17 behavior\n000700:\n     15 behavior\n000701:\n     15 behavior\n000702:\n     16 behavior\n000703:\n     22 behavior\n000704:\n     20 behavior\n000705:\n     20 behavior\n000706:\n     16 behavior\n000707:\n     16 behavior\n000708:\n     17 behavior\n000709:\n     29 behavior\n000710:\n      6 ecephys\n000711:\n   4079 image\n   1936 image+ophys\n000713:\n    869 ecephys\n   3271 image\n000714:\n      9 ophys\n000715:\n     10 ophys\n000717:\n      1 behavior+ecephys\n      1 behavior+ophys\n      1 icephys\n000721:\n      1 ecephys\n000727:\n      9 behavior+image+ophys\n000728:\n   1518 behavior+image+ophys\n   1518 ophys\n000732:\n     22 ecephys\n000767:\n     14 behavior+ecephys\n     14 ecephys\n000768:\n     51 icephys\n000769:\n    177 icephys\n000770:\n     44 behavior+task\n     44 ecephys\n     44 spikesorting\n000771:\n     18 behavior+task\n     18 ecephys\n     18 spikesorting\n000772:\n     15 behavior+task\n     15 ecephys\n     15 spikesorting\n000773:\n  15246 ophys\n000774:\n     10 ecephys\n000775:\n     57 behavior\n000776:\n     38 behavior+image+ophys\n000777:\n      1 ecephys\n000778:\n      1 ecephys\n000779:\n      1 ecephys+image\n000780:\n      1 ecephys+image\n000781:\n      1 ecephys+image\n000782:\n      1 ecephys+image\n000784:\n      6 ecephys\n000785:\n     41 ophys\n000786:\n      1 ecephys\n000787:\n      1 ecephys\n000788:\n      1 ecephys\n000789:\n      1 ecephys\n000792:\n      1 ecephys+image\n000793:\n      1 ecephys+image\n000794:\n      1 ecephys\n000795:\n      1 ecephys\n000796:\n      1 ecephys\n000797:\n      1 ecephys\n000798:\n      1 ecephys\n000799:\n      1 ecephys\n000800:\n      1 ecephys+image\n000801:\n      1 ecephys+image\n000802:\n      1 ecephys+image\n000803:\n      1 ecephys+image\n000804:\n      1 ecephys+image\n000805:\n      1 ecephys+image\n000806:\n      1 ecephys+image\n000807:\n      1 ecephys+image\n000808:\n      1 ecephys\n000809:\n      1 ecephys\n000810:\n      1 ecephys\n000811:\n      1 ecephys\n000812:\n      1 ecephys\n000813:\n      1 ecephys\n000814:\n      1 ecephys\n000815:\n      1 ecephys\n000816:\n      1 ecephys\n000817:\n      1 ecephys\n000818:\n      1 ecephys\n000819:\n      1 ecephys\n000820:\n      1 ecephys\n000821:\n      1 ecephys\n000822:\n      1 ecephys\n000823:\n      1 ecephys\n000824:\n      1 ecephys\n000825:\n      1 ecephys\n000826:\n      1 ecephys\n000827:\n      1 ecephys\n000828:\n      1 ecephys\n000829:\n      1 ecephys\n000830:\n      1 ecephys+image\n000831:\n      1 ecephys+image\n000832:\n      1 ecephys+image\n000833:\n      1 ecephys+image\n000834:\n      1 ecephys\n000835:\n      1 ecephys\n000836:\n      1 ecephys\n000837:\n      1 ecephys\n000838:\n      1 ecephys\n000839:\n      1 ecephys\n000840:\n      1 ecephys\n000841:\n      1 ecephys\n000842:\n      1 ecephys\n000843:\n      1 ecephys\n000844:\n      1 ecephys\n000845:\n      1 ecephys\n000846:\n      1 ecephys\n000847:\n      1 ecephys\n000848:\n      1 ecephys\n000849:\n      1 ecephys\n000850:\n      1 ecephys\n000851:\n      1 ecephys\n000852:\n      1 ecephys\n000853:\n      1 ecephys\n000854:\n      1 ecephys\n000855:\n      1 ecephys\n000856:\n      1 ecephys\n000857:\n      1 ecephys\n000858:\n      1 ecephys\n000859:\n      1 ecephys\n000860:\n      1 ecephys\n000861:\n      1 ecephys\n000862:\n      1 ecephys+image\n000863:\n      1 ecephys+image\n000864:\n      1 ecephys\n000865:\n      1 ecephys\n000866:\n      1 ecephys+image\n000867:\n      1 ecephys+image\n000868:\n      1 ecephys\n000869:\n      1 ecephys\n000871:\n    284 image+ophys\n000873:\n      6 behavior+ecephys\n000875:\n      9 image\n000876:\n      1 ecephys\n000882:\n     16 ecephys\n000884:\n     12 ecephys\n000888:\n     52 behavior\n000889:\n     52 behavior\n000890:\n    125 behavior+ecephys\n000891:\n     87 image\n000892:\n      1 ecephys\n000894:\n    133 ecephys+ogen\n000895:\n     17 ecephys+ogen\n000896:\n      5 ophys\n000897:\n      6 behavior+ecephys\n      6 ecephys\n000932:\n    238 ecephys\n000933:\n     28 icephys\n000934:\n     13 icephys\n000935:\n      1 ecephys\n      5 ecephys+ophys\n000937:\n      1 behavior+ecephys\n000939:\n     21 behavior+ecephys\n      8 behavior+ecephys+ogen\n000941:\n     12 behavior+ecephys\n000944:\n     84 behavior+ophys\n000945:\n     60 ecephys\n000946:\n   1885 ecephys\n000947:\n    272 ecephys\n000948:\n    376 ecephys\n000951:\n    459 behavior+image\n     36 image+ophys\n000953:\n     20 behavior+ecephys\n000957:\n      9 ecephys+image\n000960:\n      1 behavior+ecephys\n000962:\n      2 behavior+ecephys\n     18 ecephys\n000966:\n     18 ecephys\n```\n\u003c/details\u003e\n\n\u003cdetails\u003e\n\u003csummary\u003eAnd here is pointers to dandisets and the trailing entity where we do not have a suffix\u003c/summary\u003e \n\n```shell\ndandi@drogon:/mnt/backup/dandi/dandisets$ for d in 0*; do dts=$(find $d -iname sub*_*.nwb | sed -e 's,.*_,,g' -e 's,\\.nwb$,,g' | grep  - | sort | uniq -c | sort -n | head -n 1); [ -z \"$dts\" ] \u0026\u0026 continue; echo -e \"$d:\\n$dts\";  done\n000006:\n      1 ses-20170226\n000007:\n      1 ses-20151020T093604\n000015:\n      1 obj-10arvlt\n000016:\n      1 ses-161004115936\n000017:\n      1 ses-20161214T120000\n000019:\n      1 ses-EC2-B1\n000021:\n      1 ses-715093703\n000022:\n      1 ses-766640955\n000028:\n      1 ses-20200727T094534\n000034:\n      1 ses-20200824T155542\n000045:\n      1 ses-047d8c7c-6690-4179-a5d3-e8e99fec286e\n000122:\n      1 ses-20200101T021616\n000173:\n      1 obj-101glrx\n000217:\n      1 obj-100ma3n\n000239:\n      1 ses-20180216T131504\n000247:\n      1 ses-2019-06-10-0000-oviDNSS1-GCaMP7b-nwb\n000251:\n      1 ses-Ca-VS-MB-1\n000338:\n      1 ses-20160101\n000351:\n      1 ses-Day10-Pavlovian\n000404:\n      1 ses-session4\n000405:\n      1 ses-Al-OF-092818\n000481:\n      1 ses-20230412T102003\n000544:\n      1 ses-session-1234\n000561:\n      1 ses-20201013\n000615:\n      1 ses-20220411\n000628:\n      1 ses-20191024T115441\n000640:\n      1 ses-20201013\n000678:\n      1 ses-20210830T130549\n000690:\n      1 ses-1298465622\n000713:\n      1 ses-20200817T222149\n000717:\n      1 desc-18000000-frames-13653-by-384-chunking\n000732:\n      1 obj-15pbd0g\n000766:\n      1 obj-101x456\n000767:\n      1 ses-2023-12-15-behavior+ecephys\n000950:\n      1 ses-20230417\n000951:\n      1 ses-(-LC10ad-fly0-170510-1404--)\n000954:\n      1 ses-19250126T113454\n\n```\n\u003c/details\u003e\n\nmight need help from @CodyCBakerPhD and @bendichter if they recognize any of those dandisets being prepared by them","files":null}]}