{"version":2,"ops":[{"type":1,"author":{"id":"f068089e26f6e2e30d51a62e75a77af7d9dc5ecb"},"timestamp":1645916587,"metadata":{"github-id":"I_kwDODBZtRc5EsOpc","github-url":"https://github.com/dandi/dandi-cli/issues/927","origin":"github"},"title":"dandi upload parallel jobs","message":"When you do `dandi upload`, it's not clear how many parallel jobs are used by default. I would have expected the program to automatically detect how many jobs are available. Upon some digging, I found this `iter_upload` method, which claims the number of jobs defaults to 5 but does not set it to 5 in the method signature. \n\nhttps://github.com/dandi/dandi-cli/blob/a1a7fd553cf300967adc060302c7e6f6c1b921c8/dandi/files.py#L765-L792\n\nThen the default to 5 is set down here:\n\nhttps://github.com/dandi/dandi-cli/blob/a1a7fd553cf300967adc060302c7e6f6c1b921c8/dandi/files.py#L845\n\nIf you really want to hard-code 5, wouldn't it be easier to just do it in the function signature like:\n\n```python\njobs: Optional[int] = 5\n```\nAnd then it would be nice to indicate this in the cli help.\n\nA better option might be to use what is [now default for Python \u003e=3.8](https://docs.python.org/3/library/concurrent.futures.html#concurrent.futures.ThreadPoolExecutor): `max_workers=min(32, os.cpu_count() + 4)`","files":null}]}