{"version":2,"ops":[{"type":1,"author":{"id":"f068089e26f6e2e30d51a62e75a77af7d9dc5ecb"},"timestamp":1672069156,"metadata":{"github-id":"I_kwDODBZtRc5aELRJ","github-url":"https://github.com/dandi/dandi-cli/issues/1181","origin":"github"},"title":"`get_metadata` broken for some dandisets","message":"Looking for data with LFP, I'd like to be able to run:\n\n```python\nfrom dandi.dandiapi import DandiAPIClient\n\nids = [\n    dandiset.identifier \n    for dandiset in DandiAPIClient().get_dandisets() \n    if 'LFP' in dandiset.get_metadata().assetsSummary.variableMeasured\n]\n```\n\nbut currently this outputs an error because the metadata object cannot be constructed for all dandisets:\n\n```pytb\n---------------------------------------------------------------------------\nValidationError                           Traceback (most recent call last)\nInput In [18], in \u003ccell line: 3\u003e()\n      1 from dandi.dandiapi import DandiAPIClient\n----\u003e 3 ids = [\n      4     dandiset.identifier \n      5     for dandiset in DandiAPIClient().get_dandisets() \n      6     if 'LFP' in dandiset.get_metadata().assetsSummary.variableMeasured\n      7 ]\n\nInput In [18], in \u003clistcomp\u003e(.0)\n      1 from dandi.dandiapi import DandiAPIClient\n      3 ids = [\n      4     dandiset.identifier \n      5     for dandiset in DandiAPIClient().get_dandisets() \n----\u003e 6     if 'LFP' in dandiset.get_metadata().assetsSummary.variableMeasured\n      7 ]\n\nFile /opt/conda/lib/python3.10/site-packages/dandi/dandiapi.py:930, in RemoteDandiset.get_metadata(self)\n    925 def get_metadata(self) -\u003e models.Dandiset:\n    926     \"\"\"\n    927     Fetch the metadata for this version of the Dandiset as a\n    928     `dandischema.models.Dandiset` instance\n    929     \"\"\"\n--\u003e 930     return models.Dandiset.parse_obj(self.get_raw_metadata())\n\nFile /opt/conda/lib/python3.10/site-packages/pydantic/main.py:526, in pydantic.main.BaseModel.parse_obj()\n\nFile /opt/conda/lib/python3.10/site-packages/pydantic/main.py:342, in pydantic.main.BaseModel.__init__()\n\nValidationError: 1 validation error for Dandiset\nlicense\n  ensure this value has at least 1 items (type=value_error.list.min_items; limit_value=1)\n```\n\nI will try to use `get_raw_metadata` as a work-around, but I suspect the metadata object is the preferred access pattern.","files":null}]}