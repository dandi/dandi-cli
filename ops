{"version":2,"ops":[{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1740749740,"metadata":{"github-id":"UCE_lAHODBZtRc6qtWunznMgG3U"},"target":"c5799b74f51d78ab0158ded769e3ef015fbaf9c2d6c4ccac19a957a89a0c2fcb","message":"on 000026 with tens of thousands of assets, most of the CPU time is eventually spent on the summary line\n\n![Image](https://github.com/user-attachments/assets/5a3d7cfa-b76b-472f-b6c4-02600fba88ac)\n\nwhich is bad.\n\nAttn @kevancic\n\nedit note1: apparently we already have `_progress_filter` which should ensure that we do not over-report back to pyout, and do it not more often than once in 2 seconds per path... so it is odd that we trigger `summary` that often... needs more 'investigation'.","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1740750411,"metadata":{"github-id":"UCE_lAHODBZtRc6qtWunznMgXbc"},"target":"c5799b74f51d78ab0158ded769e3ef015fbaf9c2d6c4ccac19a957a89a0c2fcb","message":"on 000026 with tens of thousands of assets, most of the CPU time is eventually spent on the summary line\n\n![Image](https://github.com/user-attachments/assets/5a3d7cfa-b76b-472f-b6c4-02600fba88ac)\n\nwhich is bad.\n\nAttn @kevancic\n\nedit note1: apparently we already have `_progress_filter` which should ensure that we do not over-report back to pyout, and do it not more often than once in 2 seconds per path... so it is odd that we trigger `summary` that often... needs more 'investigation'.   https://github.com/dandi/dandi-cli/pull/1554 (released in 0.66.2 Dec 17th 2024)","files":null},{"type":5,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1739987147,"metadata":{"github-id":"LE_lADODBZtRc6qtWunzwAAAAPPs-sW"},"added":["performance"],"removed":[]},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1739989434,"metadata":{"github-id":"IC_kwDODBZtRc6fHGC5","github-url":"https://github.com/dandi/dandi-cli/issues/1581#issuecomment-2669437113"},"message":"@yarikoptic - can we revisit the ui/ux of upload/download now that we have seen a bunch of use-cases?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1740017644,"metadata":{"github-id":"IC_kwDODBZtRc6fKXmX","github-url":"https://github.com/dandi/dandi-cli/issues/1581#issuecomment-2670295447"},"message":"It was in my dreams already for a number of months, but I was lacking spare cycles... do you have any available to spare?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1741227143,"metadata":{"github-id":"IC_kwDODBZtRc6hFdx4","github-url":"https://github.com/dandi/dandi-cli/issues/1581#issuecomment-2702564472"},"message":"there is also effect on RAM!\n```\n3051815 yoh       20   0   11.2g   6.1g  27364 S 109.9   0.6     50,31 dandi\n```\nworth checking if pyout keeps record of ALL records it is provided with (it should not AFAIK)... that would explain it.\n\n\u003cdetails\u003e\n\u003csummary\u003epy-spy top\u003c/summary\u003e \n\n![Image](https://github.com/user-attachments/assets/66c6f93f-5e33-489d-88c4-26411718fb0f)\n\n\u003c/details\u003e\n\nso we redoing over and over again assessment across files within zarr in `get_done` -- we should RF that it just increments counters without constantly looping through those .files.  @jwodder -- do you see a quick solution to avoid that looping there? (you are looking into zarr downloads ATM AFAIK and this was your code)","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1741227181,"metadata":{"github-id":"UCE_lALODBZtRc6hFdx4zl7gjeY"},"target":"48471072599c3569fbf7659e5d1390e5273a78cf83550ab3f0bc17bf09509be2","message":"there is also effect on RAM!\n```\n3051815 yoh       20   0   11.2g   6.1g  27364 S 109.9   0.6     50,31 dandi\n```\nworth checking if pyout keeps record of ALL records it is provided with (it should not AFAIK)... that would explain it.  Or could be just `.files` records of the ProgressCombiner for zarrs.\n\n\u003cdetails\u003e\n\u003csummary\u003epy-spy top\u003c/summary\u003e \n\n![Image](https://github.com/user-attachments/assets/66c6f93f-5e33-489d-88c4-26411718fb0f)\n\n\u003c/details\u003e\n\nso we redoing over and over again assessment across files within zarr in `get_done` -- we should RF that it just increments counters without constantly looping through those .files.  @jwodder -- do you see a quick solution to avoid that looping there? (you are looking into zarr downloads ATM AFAIK and this was your code)","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1741613551,"metadata":{"github-id":"IC_kwDODBZtRc6hkKTJ","github-url":"https://github.com/dandi/dandi-cli/issues/1581#issuecomment-2710611145"},"message":"I believe with #1585 we should have dealt with this","files":null},{"type":4,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1741613551,"metadata":{"github-id":"CE_lADODBZtRc6qtWunzwAAAAPgtVj0"},"status":2}]}