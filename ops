{"version":2,"ops":[{"type":3,"author":{"id":"0de31b02ac7e871be55ec902e73f5a6c6cf50934"},"timestamp":1730858926,"metadata":{"github-id":"IC_kwDODBZtRc6SixRe","github-url":"https://github.com/dandi/dandi-cli/issues/1520#issuecomment-2458588254"},"message":"@yarikoptic","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1730859394,"metadata":{"github-id":"IC_kwDODBZtRc6Siy1a","github-url":"https://github.com/dandi/dandi-cli/issues/1520#issuecomment-2458594650"},"message":"@mavaylon1 - how many objects in the zarr file and what's the rough size of the objects? we generally recommend that you chunk the zarr such that each chunk is in the MB range rather than KB.\n\nas an fyi, instead of using the zarr python library, if you use the tensorstore library from google you should also be able to write sharded v3 zarrs.","files":null},{"type":3,"author":{"id":"d8203afd43c9e0a9d07c45dd62b58a81d53a2ebe"},"timestamp":1730861886,"metadata":{"github-id":"IC_kwDODBZtRc6Si7gs","github-url":"https://github.com/dandi/dandi-cli/issues/1520#issuecomment-2458630188"},"message":"Hi @mavaylon1, can you also please provide the two log files?  Thanks.","files":null},{"type":3,"author":{"id":"0de31b02ac7e871be55ec902e73f5a6c6cf50934"},"timestamp":1731334341,"metadata":{"github-id":"IC_kwDODBZtRc6THuUI","github-url":"https://github.com/dandi/dandi-cli/issues/1520#issuecomment-2468275464"},"message":"@satra There are roughly 1.5 million files in the store. We did some digging and each chunk is incredibly small at .02 MB. We are not sure why that is what hdf5 used as default size (we exported to zarr which keeps the chunk size of what was in hdf5).\n\nWe also agree on rechunking to a larger chunk size (~16Mb).\n\n@kabilar what two log files btw?","files":null},{"type":3,"author":{"id":"d8203afd43c9e0a9d07c45dd62b58a81d53a2ebe"},"timestamp":1741280197,"metadata":{"github-id":"IC_kwDODBZtRc6hMg2V","github-url":"https://github.com/dandi/dandi-cli/issues/1520#issuecomment-2704412053"},"message":"\u003e [@kabilar](https://github.com/kabilar) what two log files btw?\n\nHi @mavaylon1, the terminal output shows the location for the log files.\n\n![Image](https://github.com/user-attachments/assets/0e32b18e-a001-4fe4-a50a-14e76feef7e2)\n\n![Image](https://github.com/user-attachments/assets/316b0eca-24ab-4bef-b2d8-0e364b1eab60)","files":null},{"type":3,"author":{"id":"d8203afd43c9e0a9d07c45dd62b58a81d53a2ebe"},"timestamp":1741643023,"metadata":{"github-id":"IC_kwDODBZtRc6hpI5I","github-url":"https://github.com/dandi/dandi-cli/issues/1520#issuecomment-2711916104"},"message":"Hi @mavaylon1, were you able to rechunk this dataset and are you still having this issue?  Sorry for the delay in getting back to you.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1742412512,"metadata":{"github-id":"IC_kwDODBZtRc6jL5tR","github-url":"https://github.com/dandi/dandi-cli/issues/1520#issuecomment-2737806161"},"message":"may be minted URLs expired by then somehow -- at kB/s speed may be could have happened. \"need more data\", and ideally logs with depiction of 400 error.","files":null},{"type":5,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1742412525,"metadata":{"github-id":"LE_lADODBZtRc6dK0sIzwAAAAPt7nSw"},"added":["zarr"],"removed":[]},{"type":3,"author":{"id":"d8203afd43c9e0a9d07c45dd62b58a81d53a2ebe"},"timestamp":1742837362,"metadata":{"github-id":"IC_kwDODBZtRc6j2MuH","github-url":"https://github.com/dandi/dandi-cli/issues/1520#issuecomment-2748894087"},"message":"Hi @mavaylon1, I am going to close this issue due to inactivity but please reopen if this is still an issue for you.  Thanks.","files":null},{"type":4,"author":{"id":"d8203afd43c9e0a9d07c45dd62b58a81d53a2ebe"},"timestamp":1742837362,"metadata":{"github-id":"CE_lADODBZtRc6dK0sIzwAAAAPy6Ge0"},"status":2},{"type":3,"author":{"id":"0de31b02ac7e871be55ec902e73f5a6c6cf50934"},"timestamp":1748483440,"metadata":{"github-id":"IC_kwDODBZtRc6t7S45","github-url":"https://github.com/dandi/dandi-cli/issues/1520#issuecomment-2918002233"},"message":"Hi @kabilar sorry for the inactivity. This issue is still present. Let me recreate the errors. This is something we want to understand as soon as possible. Could you reopen the issue?","files":null},{"type":4,"author":{"id":"d8203afd43c9e0a9d07c45dd62b58a81d53a2ebe"},"timestamp":1748543278,"metadata":{"github-id":"REE_lADODBZtRc6dK0sIzwAAAAQpU9hc"},"status":1},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1748976826,"metadata":{"github-id":"IC_kwDODBZtRc6vCxpu","github-url":"https://github.com/dandi/dandi-cli/issues/1520#issuecomment-2936740462"},"message":"while uploading, especially when it gets to \"problematic behavior\", could you monitor that process e.g in `top` to see how CPU busy?\n\nalso if you `pip install py-spy` and then do `py-spy top -p PID` of that busy process -- what stack within python do you typically see? (or collect the flamegraph for some duration)\n\nThanks in advance","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1748976839,"metadata":{"github-id":"UCE_lALODBZtRc6vCxpuzmmOvOo"},"target":"3ee4914f76e36f4d2f090fd99ebf3dd9f918c92416b7a64c2d554a6f99f89be5","message":"@mavaylon1 while uploading, especially when it gets to \"problematic behavior\", could you monitor that process e.g in `top` to see how CPU busy?\n\nalso if you `pip install py-spy` and then do `py-spy top -p PID` of that busy process -- what stack within python do you typically see? (or collect the flamegraph for some duration)\n\nThanks in advance","files":null},{"type":3,"author":{"id":"0de31b02ac7e871be55ec902e73f5a6c6cf50934"},"timestamp":1749418436,"metadata":{"github-id":"IC_kwDODBZtRc6wFtTy","github-url":"https://github.com/dandi/dandi-cli/issues/1520#issuecomment-2954286322"},"message":"Sure. Let me get the files rechunked and I can set up the monitoring. I will ask questions here on that if any come up @yarikoptic","files":null}]}