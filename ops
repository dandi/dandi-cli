{"version":2,"ops":[{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1749135704,"metadata":{"github-id":"UCE_lAHODBZtRc6QEgT6zn0fTAw"},"target":"fd8660a221c3e3c01231d77142621439200804886f631cda12b4e0b3254f6b90","message":"Original use-case\n\n- https://github.com/dandi/dandi-cli/issues/1474\n\nto modify some metadata files within zarr. Zarr itself might be huge (GBs) so it is a big waste to require download of the entire zarr folder to just update some metadata files. So relates also to ability for partial download\n\n- dandi/dandi-archive#1461 \n\n`dandi upload` if operating on a `.zarr` folder, should gain an option so upload only considers paths present but does not assume that it is \"all of zarr\" and remove the rest from remote zarr.  Then it needs to finalize zarr update with full manifest as with some files/folders of zarr present only in archive, and not locally.\n\nI think it should be `--zarr-mode full,partial-full,partial-lean`.  Modes\n- `full` -- current behavior (pretty much a sync IIRC)\n- `dont-delete` -- upload/update files found locally but do not delete any remote file within zarr (added later)\n\nPreviously thought about (edited):\n- `partial-full` -- if encountering zarr sub-folder locally, it would pretty much do `full` on that subfolder -- i.e. it would remove remote files under that subfolder if not present locally.  As a \"side-effect\" -- if encounters an empty sub-folder locally -- it would remove all the zarr subfiles potentially present with that folder prefix on archive (thus it would be easy to prune some undesired remote folders).   \n- `partial-lean` -- it would only concern with updates of files it encounters.","files":null},{"type":5,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1721327816,"metadata":{"github-id":"LE_lADODBZtRc6QEgT6zwAAAAMoS4Md"},"added":["UX"],"removed":[]},{"type":5,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1721327816,"metadata":{"github-id":"LE_lADODBZtRc6QEgT6zwAAAAMoS4Mi"},"added":["cmd-upload"],"removed":[]},{"type":5,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1721327816,"metadata":{"github-id":"LE_lADODBZtRc6QEgT6zwAAAAMoS4Mo"},"added":["zarr"],"removed":[]},{"type":3,"author":{"id":"d8203afd43c9e0a9d07c45dd62b58a81d53a2ebe"},"timestamp":1722346669,"metadata":{"github-id":"IC_kwDODBZtRc6GnBGm","github-url":"https://github.com/dandi/dandi-cli/issues/1462#issuecomment-2258375078"},"message":"Thanks @yarikoptic.  Hi @yarikoptic @jwodder, following up from our discussion yesterday, could you please prioritize this issue?  Thank you.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1736266633,"metadata":{"github-id":"IC_kwDODBZtRc6Zhg_K","github-url":"https://github.com/dandi/dandi-cli/issues/1462#issuecomment-2575699914"},"message":"@kabilar let's first figure out the interfaces we need to accomplish the drill here since we would need first to download such partial zarr and only then edit and upload. But besides webdav (disabled ATM) AFAIK there is no convenient interface to have a \"full URL\" to a file within zarr since we do not have any kind of zarr browser within dandi-archive  (https://github.com/dandi/dandi-archive/issues/1746 and from there on).  Ideas @kabilar @jwodder ?","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1736266694,"metadata":{"github-id":"UCE_lALODBZtRc6Zhg_KzlkavAs"},"target":"1211a8d86f2ff14006ae435856f23139c2a33b49b9a4866e5a1e204acdbb66d6","message":"@kabilar let's first figure out the interfaces we need to accomplish the drill here since we would need first to download such partial zarr and only then edit and upload. But besides webdav (disabled ATM) AFAIK there is no convenient interface to have a \"full URL\" to a file within zarr since we do not have any kind of zarr browser within dandi-archive  (https://github.com/dandi/dandi-archive/issues/1746 and from there on).  Ideas @kabilar @jwodder ?\n\nedit: i.e. what are the use cases @kabilar you run into -- is it a single file within zarr in at least 80% of the cases?","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1736266921,"metadata":{"github-id":"UCE_lALODBZtRc6Zhg_Kzlka2R0"},"target":"1211a8d86f2ff14006ae435856f23139c2a33b49b9a4866e5a1e204acdbb66d6","message":"@kabilar let's first figure out the interfaces we need to accomplish the drill here since we would need first to download such partial zarr and only then edit and upload. But besides webdav (disabled ATM) AFAIK there is no convenient interface to have a \"full URL\" to a file within zarr since we do not have any kind of zarr browser within dandi-archive  (https://github.com/dandi/dandi-archive/issues/1746 and from there on).  Ideas @kabilar @jwodder ?\n\nedit: i.e. what are the use cases @kabilar you run into -- is it a single file within zarr in at least 80% of the cases?  thinking out loud -- may be what we really need is indeed some kind of `edit file of dandi` functionality, which for owners would be \"edit directly\" - download/edit/upload; and for others -- \"download/edit/propose\" changes somehow (echoing @bendichter desire to offer ways to suggest dandiset metadata edits).\nSo, after we figure out how to point to a particular file within zarr, at `dandi` cli level it could be something like `dandi edit URL` which would do the drill (download, edit using e.g. `${EDITOR:-vi}`  , upload while checking that file did not change yet in the archive since download), and later bolt on ability to propose changes somehow (e.g. indeed via github + bot to `@dandibot accept changes`)","files":null},{"type":3,"author":{"id":"d8203afd43c9e0a9d07c45dd62b58a81d53a2ebe"},"timestamp":1736444228,"metadata":{"github-id":"IC_kwDODBZtRc6Z1Vzf","github-url":"https://github.com/dandi/dandi-cli/issues/1462#issuecomment-2580896991"},"message":"Hi @yarikoptic, thanks for restarting this discussion.\n\nThe major use case here is editing the metadata files that are within a Zarr archive.  For Zarr v2, those are the `.zarray` + `.zgroup` + `.zattrs` files.  For Zarr v3, those are the `zarr.json` files.  Note, that a given Zarr archive could have many `.zarray`/`.zgroup`/`.zattrs` files or `zarr.json` files, respectively.\n\nThere is a potential need to edit the data chunks but has not been requested yet.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1736796452,"metadata":{"github-id":"IC_kwDODBZtRc6aQeqN","github-url":"https://github.com/dandi/dandi-cli/issues/1462#issuecomment-2588011149"},"message":"ok, for an immediate use case I feel we just need to provide flexibility of\n\n- download this file(s) within zarr\n- upload this file(s) into that location/URL on DANDI instance\n\nthen there could be a convenience which uses those two like `dandi edit` which would use above two.\n\n@jwodder , given current API(s) here in dandi-cli and webdav \"experiences\", do you think it would be sensible to make `\u003cpath\u003e` within our supported URIs to point to specific file/folder:\n\n```\n‚ùØ xclip -o | grep path\n   - https://\u003cserver\u003e[/api]/[#/]dandiset/\u003cdandiset id\u003e[/\u003cversion\u003e][/files[?location=\u003cpath\u003e]]\n   - https://\u003cserver\u003e[/api]/dandisets/\u003cdandiset id\u003e/versions/\u003cversion\u003e/assets/?path=\u003cpath\u003e\n   - dandi://\u003cinstance name\u003e/\u003cdandiset id\u003e[@\u003cversion\u003e][/\u003cpath\u003e]\n```\n\nto support pointing/download of a single file or directory within zarr?  Target name on the filesystem would like be just the basename of that path (so e.g. `.zarray` or `zarr.json` if pointed to a single file; or `0/` folder if pointed to that folder within zarr)","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1736798520,"metadata":{"github-id":"IC_kwDODBZtRc6aQvI_","github-url":"https://github.com/dandi/dandi-cli/issues/1462#issuecomment-2588078655"},"message":"@yarikoptic How's dandi-cli supposed to know whether a path in a URL points to a Zarr entry versus a normal asset?  Should it, like dandidav, treat a directory ending in `.zarr` or `.ngf` as the point where the asset path ends and the Zarr path begins?  Or something else?","files":null},{"type":3,"author":{"id":"d8203afd43c9e0a9d07c45dd62b58a81d53a2ebe"},"timestamp":1737128340,"metadata":{"github-id":"IC_kwDODBZtRc6a4_yR","github-url":"https://github.com/dandi/dandi-cli/issues/1462#issuecomment-2598632593"},"message":"\u003e @yarikoptic How's dandi-cli supposed to know whether a path in a URL points to a Zarr entry versus a normal asset? Should it, like dandidav, treat a directory ending in `.zarr` or `.ngf` as the point where the asset path ends and the Zarr path begins? Or something else?\n\nI am not too familiar with how this would be implemented but this makes sense.","files":null},{"type":3,"author":{"id":"d8203afd43c9e0a9d07c45dd62b58a81d53a2ebe"},"timestamp":1737129077,"metadata":{"github-id":"IC_kwDODBZtRc6a5Fyb","github-url":"https://github.com/dandi/dandi-cli/issues/1462#issuecomment-2598657179"},"message":"\u003e ok, for an immediate use case I feel we just need to provide flexibility of\n\u003e \n\u003e * download this file(s) within zarr\n\u003e * upload this file(s) into that location/URL on DANDI instance\n\u003e \n\u003e then there could be a convenience which uses those two like `dandi edit` which would use above two.\n\nPerhaps the workflow would look like the following:\n\n1. User lists the path(s) to all of the metadata file(s) in a Zarr archive (`.zarray`/`.zgroup`/`.zattrs` or `zarr.json`).  For example:\n  `dandi tree https://\u003cserver\u003e[/api]/dandisets/\u003cdandiset id\u003e/versions/\u003cversion\u003e/assets/?path=\u003cpath\u003e.zarr`\n    or \n  `dandi ls https://\u003cserver\u003e[/api]/dandisets/\u003cdandiset id\u003e/versions/\u003cversion\u003e/assets/?path=\u003cpath\u003e.zarr`\n2. User would use the metadata path to download that specific metadata file.  Maybe there is also an option to download all metadata files in a Zarr archive with the `--preserve-tree` option.\n  `dandi download --preserve-tree \u003cURI to metadata file\u003e`\n3. User would upload the modified metadata file.  @yarikoptic mentioned that we would just need to make sure that `dandi upload` figures out that the metadata file(s) has changed and not the entire Zarr archive.\n  `dandi upload`\n\nPerhaps the current capabilities of webdav would be fairly integral to this approach.","files":null},{"type":6,"author":{"id":"d8203afd43c9e0a9d07c45dd62b58a81d53a2ebe"},"timestamp":1737129327,"metadata":{"github-id":"UCE_lALODBZtRc6a5FybzloU7LA"},"target":"28c1d7efe24ad6acdd83f7b955ca4440f9af78b6ccef85dea5ff02a6effb03b5","message":"\u003e ok, for an immediate use case I feel we just need to provide flexibility of\n\u003e \n\u003e * download this file(s) within zarr\n\u003e * upload this file(s) into that location/URL on DANDI instance\n\u003e \n\u003e then there could be a convenience which uses those two like `dandi edit` which would use above two.\n\nPerhaps the workflow would look like the following:\n\n1. User lists the path(s) to all of the metadata file(s) in a Zarr archive (`.zarray`/`.zgroup`/`.zattrs` or `zarr.json`).  For example:\n  `dandi tree https://\u003cserver\u003e[/api]/dandisets/\u003cdandiset id\u003e/versions/\u003cversion\u003e/assets/?path=\u003cpath\u003e.zarr`\n    or \n  `dandi ls https://\u003cserver\u003e[/api]/dandisets/\u003cdandiset id\u003e/versions/\u003cversion\u003e/assets/?path=\u003cpath\u003e.zarr`\n2. User would use the metadata path to download that specific metadata file.  Maybe there is also an option to download all metadata files in a Zarr archive with the `--preserve-tree` option.\n  `dandi download --preserve-tree \u003cURI to metadata file\u003e`\n3. User would upload the modified metadata file.  @yarikoptic mentioned that we would just need to make sure that `dandi upload` figures out that the metadata file(s) has changed and not the entire Zarr archive.\n  `dandi upload`","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1737564595,"metadata":{"github-id":"IC_kwDODBZtRc6bbzs_","github-url":"https://github.com/dandi/dandi-cli/issues/1462#issuecomment-2607758143"},"message":"as for browsing zarrs we might want to make it transparently switching to webdav. instance from dandi-archive. Related issue:\n-  https://github.com/dandi/dandi-archive/issues/1993","files":null},{"type":3,"author":{"id":"d8203afd43c9e0a9d07c45dd62b58a81d53a2ebe"},"timestamp":1737608556,"metadata":{"github-id":"IC_kwDODBZtRc6bgBRa","github-url":"https://github.com/dandi/dandi-cli/issues/1462#issuecomment-2608862298"},"message":"\u003e Perhaps the workflow would look like the following:\n\u003e \n\u003e 1. User lists the path(s) to all of the metadata file(s) in a Zarr archive (`.zarray`/`.zgroup`/`.zattrs` or `zarr.json`).  For example:\n\u003e    `dandi tree https://\u003cserver\u003e[/api]/dandisets/\u003cdandiset id\u003e/versions/\u003cversion\u003e/assets/?path=\u003cpath\u003e.zarr`\n\u003e    or\n\u003e    `dandi ls https://\u003cserver\u003e[/api]/dandisets/\u003cdandiset id\u003e/versions/\u003cversion\u003e/assets/?path=\u003cpath\u003e.zarr`\n\u003e 2. User would use the metadata path to download that specific metadata file.  Maybe there is also an option to download all metadata files in a Zarr archive with the `--preserve-tree` option.\n\u003e    `dandi download --preserve-tree \u003cURI to metadata file\u003e`\n\u003e 3. User would upload the modified metadata file.  [@yarikoptic](https://github.com/yarikoptic) mentioned that we would just need to make sure that `dandi upload` figures out that the metadata file(s) has changed and not the entire Zarr archive.\n\u003e    `dandi upload`\n\nThe more I think about it, perhaps the most straightforward option for users is to download all metadata files in a Zarr archive (`.zarray`/`.zgroup`/`.zattrs` or `zarr.json`).  So for example:\n\n```\ndandi download --zarr-metadata https://dandiarchive.org/dandiset/001289/draft\n```\n\nAnd the `--zarr-metadata` option would default to using the `--preserve-tree` option.\n\nAnd then files can be edited, and uploaded using `dandi upload`.\n\nThis workflow assumes that the primary use case would be editing metadata files.\n\n@dstansby @balbasty @ayendiki What do you think about the use case and proposed workflow?","files":null},{"type":6,"author":{"id":"d8203afd43c9e0a9d07c45dd62b58a81d53a2ebe"},"timestamp":1737608855,"metadata":{"github-id":"UCE_lALODBZtRc6bgBRazlqHs30"},"target":"406f070e3d6243476dd00483269e14f42aee104b5875c883b1dbc016246977b7","message":"\u003e Perhaps the workflow would look like the following:\n\u003e \n\u003e 1. User lists the path(s) to all of the metadata file(s) in a Zarr archive (`.zarray`/`.zgroup`/`.zattrs` or `zarr.json`).  For example:\n\u003e    `dandi tree https://\u003cserver\u003e[/api]/dandisets/\u003cdandiset id\u003e/versions/\u003cversion\u003e/assets/?path=\u003cpath\u003e.zarr`\n\u003e    or\n\u003e    `dandi ls https://\u003cserver\u003e[/api]/dandisets/\u003cdandiset id\u003e/versions/\u003cversion\u003e/assets/?path=\u003cpath\u003e.zarr`\n\u003e 2. User would use the metadata path to download that specific metadata file.  Maybe there is also an option to download all metadata files in a Zarr archive with the `--preserve-tree` option.\n\u003e    `dandi download --preserve-tree \u003cURI to metadata file\u003e`\n\u003e 3. User would upload the modified metadata file.  [@yarikoptic](https://github.com/yarikoptic) mentioned that we would just need to make sure that `dandi upload` figures out that the metadata file(s) has changed and not the entire Zarr archive.\n\u003e    `dandi upload`\n\nThe more I think about it, perhaps the most straightforward option for users is to download all metadata files in a Zarr archive (`.zarray`/`.zgroup`/`.zattrs` or `zarr.json`).  So for example:\n\n```\ndandi download --zarr-metadata https://dandiarchive.org/dandiset/001289/draft/rawdata/sub-S45/micr/sub-S45_sample-capsule_acq-acc_chunk-102_PC.ome.zarr\n```\n\nAnd the `--zarr-metadata` option would default to using the `--preserve-tree` option.\n\nAnd then files can be edited, and uploaded using `dandi upload`.\n\nThis workflow assumes that the primary use case would be editing metadata files.\n\n@dstansby @balbasty @ayendiki What do you think about the use case and proposed workflow?","files":null},{"type":6,"author":{"id":"d8203afd43c9e0a9d07c45dd62b58a81d53a2ebe"},"timestamp":1737609836,"metadata":{"github-id":"UCE_lALODBZtRc6bgBRazlqH53M"},"target":"406f070e3d6243476dd00483269e14f42aee104b5875c883b1dbc016246977b7","message":"\u003e Perhaps the workflow would look like the following:\n\u003e \n\u003e 1. User lists the path(s) to all of the metadata file(s) in a Zarr archive (`.zarray`/`.zgroup`/`.zattrs` or `zarr.json`).  For example:\n\u003e    `dandi tree https://\u003cserver\u003e[/api]/dandisets/\u003cdandiset id\u003e/versions/\u003cversion\u003e/assets/?path=\u003cpath\u003e.zarr`\n\u003e    or\n\u003e    `dandi ls https://\u003cserver\u003e[/api]/dandisets/\u003cdandiset id\u003e/versions/\u003cversion\u003e/assets/?path=\u003cpath\u003e.zarr`\n\u003e 2. User would use the metadata path to download that specific metadata file.  Maybe there is also an option to download all metadata files in a Zarr archive with the `--preserve-tree` option.\n\u003e    `dandi download --preserve-tree \u003cURI to metadata file\u003e`\n\u003e 3. User would upload the modified metadata file.  [@yarikoptic](https://github.com/yarikoptic) mentioned that we would just need to make sure that `dandi upload` figures out that the metadata file(s) has changed and not the entire Zarr archive.\n\u003e    `dandi upload`\n\nThe more I think about it, perhaps the most straightforward option for users is to download all metadata files in a Zarr archive (`.zarray`/`.zgroup`/`.zattrs` or `zarr.json`).  So for example:\n\n```\ndandi download --zarr-metadata https://dandiarchive.org/dandiset/001289/draft/rawdata/sub-S45/micr/sub-S45_sample-capsule_acq-acc_chunk-102_PC.ome.zarr\n```\n\nAnd the `--zarr-metadata` option would default to using the `--preserve-tree` option.\n\nAnd then files can be edited, and uploaded using `dandi upload`.\n\nThis workflow assumes that the primary use case would be editing metadata files.\n\n@dstansby @balbasty @ayendiki @jingjingwu1225 @calvinchai What do you think about the use case and proposed workflow?","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1737646213,"metadata":{"github-id":"IC_kwDODBZtRc6bk0rj","github-url":"https://github.com/dandi/dandi-cli/issues/1462#issuecomment-2610121443"},"message":"can we simplify our lives by moving everything to zarr v3 (without sharding, this should just be a metadata change) and then providing an explicit zarr.json updating api endpoint and ui that can also handle validation that the edits are not changing shape etc and is consistent with the arrays stored? i.e. we will need an ome model to ensure edits are non-destructive relative to the arrays and bytes stored. \n\nsupporting zarr v2 does not seem to be a long term prerogative since no zarrs are published at this point.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1737666556,"metadata":{"github-id":"IC_kwDODBZtRc6boQp5","github-url":"https://github.com/dandi/dandi-cli/issues/1462#issuecomment-2611022457"},"message":"I might be missing, but couldn't `zarr.json` \"of interest\" be at varying levels within zarr? If so, I do not think v3 provides some palpable advantage in this particular case -- we pretty much would want API to expose hierarchy of files within zarr through API. We would still need to recompute checksum fully since we do not store ATM \"per folder\" checksums within zarr.","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1737667776,"metadata":{"github-id":"IC_kwDODBZtRc6boYq_","github-url":"https://github.com/dandi/dandi-cli/issues/1462#issuecomment-2611055295"},"message":"@yarikoptic - you are correct. i had forgotten that zarr.json is used at every level of the hierarchy.","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1737667850,"metadata":{"github-id":"IC_kwDODBZtRc6boZJw","github-url":"https://github.com/dandi/dandi-cli/issues/1462#issuecomment-2611057264"},"message":"perhaps checksum computation could be done using the API for checksums and replacing the relevant node and updating in memory.\n\nmore generally perhaps a virtual overlay layer could be useful for both zarr and, eventually, partial bids updates.","files":null},{"type":3,"author":{"id":"d8203afd43c9e0a9d07c45dd62b58a81d53a2ebe"},"timestamp":1740521962,"metadata":{"github-id":"IC_kwDODBZtRc6f8cvL","github-url":"https://github.com/dandi/dandi-cli/issues/1462#issuecomment-2683423691"},"message":"Hi @yarikoptic, an issue that I now realize with using webdav URLs to download a metadata file in a Zarr archive (as proposed in https://github.com/dandi/dandi-cli/issues/1572) would be that our use case requires that the data is private (either embargoed on DANDI or LINC), and from what I understand webdav only displays unembargoed data on DANDI.  So perhaps the `--zarr-metadata` download option (proposed above) would be preferable.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1741199958,"metadata":{"github-id":"IC_kwDODBZtRc6hCbmm","github-url":"https://github.com/dandi/dandi-cli/issues/1462#issuecomment-2701769126"},"message":"indeed @kabilar ! So, @jwodder let's get back to my [proposal above](https://github.com/dandi/dandi-cli/issues/1462#issuecomment-2588011149) and answering [your question](https://github.com/dandi/dandi-cli/issues/1462#issuecomment-2588078655)\n\n\u003e @yarikoptic How's dandi-cli supposed to know whether a path in a URL points to a Zarr entry versus a normal asset? Should it, like dandidav, treat a directory ending in .zarr or .ngf as the point where the asset path ends and the Zarr path begins?\n\nfor now indeed let's just rely on a some path part to end with `.zarr` or `.ngff` (we have them in `ZARR_EXTENSIONS` const).\nI didn't check -- may be that is envisioned already in the scope of `atpath` API endpoint to provide such \"splitting\" or at least point to the corresponding zarr asset?","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1741200362,"metadata":{"github-id":"IC_kwDODBZtRc6hCfn2","github-url":"https://github.com/dandi/dandi-cli/issues/1462#issuecomment-2701785590"},"message":"@yarikoptic \n\n\u003e for now indeed let's just rely on a some path part to end with `.zarr` or `.ngff` (we have them in `ZARR_EXTENSIONS` const).\n\nIs that a \"yes\" to my question?  Should `dandidav`'s behaviour be matched exactly, with every `.zarr`/`.ngff` point checked for Zarr-ness?\n\n\u003e I didn't check -- may be that is envisioned already in the scope of `atpath` API endpoint to provide such \"splitting\" or at least point to the corresponding zarr asset?\n\n`atpath` does nothing special with Zarrs; it just continues to treat them as assets that are not collections.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1741201292,"metadata":{"github-id":"IC_kwDODBZtRc6hCn87","github-url":"https://github.com/dandi/dandi-cli/issues/1462#issuecomment-2701819707"},"message":"\u003e \u003e for now indeed let's just rely on a some path part to end with `.zarr` or `.ngff` (we have them in `ZARR_EXTENSIONS` const).\n\u003e \n\u003e Is that a \"yes\" to my question? \n\nyes\n\n\u003e Should `dandidav`'s behaviour be matched exactly, with every `.zarr`/`.ngff` point checked for Zarr-ness?\n\nNot 100% I would attest to *exactly* since I don't know details: but it sounds right that if some path \"looks like zarr\" - we should check it.  Note: such a check should be done only once for such a zarr in the scope of `download` invocation. I.e. if there is intention to download `sub-1/sub-1.zarr/.zgroup` and `sub-1/sub-1.zarr/.zattr` -- we test that `sub-1/sub-1.zarr` only once.","files":null}]}