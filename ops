{"version":2,"ops":[{"type":1,"author":{"id":"f3557c4ceea08ee5e22c6aab1e8604bfb798bfa4"},"timestamp":1744137855,"metadata":{"github-id":"I_kwDODBZtRc6xqW46","github-url":"https://github.com/dandi/dandi-cli/issues/1607","origin":"github"},"title":"Zarr dependency `numcodecs` breaks latest Zarr releases at version 2.","message":"The latest version of `numcodecs`, at 0.16.0, breaks the latest Zarr releases at version 2.\n\n\u003cdetails\u003e\n\n```console\n(test) ➜  test pip list\nPackage    Version\n---------- -------\npip        25.0.1\nsetuptools 78.1.0\n(test) ➜  test pip install zarr~=2.10\nCollecting zarr~=2.10\n  Downloading zarr-2.18.6-py3-none-any.whl.metadata (5.8 kB)\nCollecting asciitree (from zarr~=2.10)\n  Using cached asciitree-0.3.3-py3-none-any.whl\nCollecting numpy\u003e=1.24 (from zarr~=2.10)\n  Using cached numpy-2.2.4-cp311-cp311-macosx_14_0_arm64.whl.metadata (62 kB)\nCollecting fasteners (from zarr~=2.10)\n  Using cached fasteners-0.19-py3-none-any.whl.metadata (4.9 kB)\nCollecting numcodecs!=0.14.0,!=0.14.1,\u003e=0.10.0 (from zarr~=2.10)\n  Using cached numcodecs-0.16.0-cp311-cp311-macosx_11_0_arm64.whl.metadata (3.0 kB)\nCollecting typing_extensions (from numcodecs!=0.14.0,!=0.14.1,\u003e=0.10.0-\u003ezarr~=2.10)\n  Using cached typing_extensions-4.13.1-py3-none-any.whl.metadata (3.0 kB)\nDownloading zarr-2.18.6-py3-none-any.whl (211 kB)\nUsing cached numcodecs-0.16.0-cp311-cp311-macosx_11_0_arm64.whl (1.2 MB)\nUsing cached numpy-2.2.4-cp311-cp311-macosx_14_0_arm64.whl (5.4 MB)\nUsing cached fasteners-0.19-py3-none-any.whl (18 kB)\nUsing cached typing_extensions-4.13.1-py3-none-any.whl (45 kB)\nInstalling collected packages: asciitree, typing_extensions, numpy, fasteners, numcodecs, zarr\nSuccessfully installed asciitree-0.3.3 fasteners-0.19 numcodecs-0.16.0 numpy-2.2.4 typing_extensions-4.13.1 zarr-2.18.6\n(test) ➜  test pip list | grep zarr\nzarr              2.18.6\n(test) ➜  test pip list | grep numcodecs\nnumcodecs         0.16.0\n(test) ➜  test python\nPython 3.11.7 (main, Jan 23 2024, 13:42:45) [Clang 15.0.0 (clang-1500.1.0.2.5)] on darwin\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n\u003e\u003e\u003e import zarr\nTraceback (most recent call last):\n  File \"\u003cstdin\u003e\", line 1, in \u003cmodule\u003e\n  File \"/Users/isaac/.pyenv/versions/test/lib/python3.11/site-packages/zarr/__init__.py\", line 3, in \u003cmodule\u003e\n    from zarr.convenience import (\n  File \"/Users/isaac/.pyenv/versions/test/lib/python3.11/site-packages/zarr/convenience.py\", line 8, in \u003cmodule\u003e\n    from zarr._storage.store import data_root, meta_root, assert_zarr_v3_api_available\n  File \"/Users/isaac/.pyenv/versions/test/lib/python3.11/site-packages/zarr/_storage/store.py\", line 10, in \u003cmodule\u003e\n    from zarr.meta import Metadata2, Metadata3\n  File \"/Users/isaac/.pyenv/versions/test/lib/python3.11/site-packages/zarr/meta.py\", line 10, in \u003cmodule\u003e\n    from zarr.util import json_dumps, json_loads\n  File \"/Users/isaac/.pyenv/versions/test/lib/python3.11/site-packages/zarr/util.py\", line 34, in \u003cmodule\u003e\n    from numcodecs.blosc import cbuffer_sizes, cbuffer_metainfo\nImportError: cannot import name 'cbuffer_sizes' from 'numcodecs.blosc' (/Users/isaac/.pyenv/versions/test/lib/python3.11/site-packages/numcodecs/blosc.cpython-311-darwin.so)\n\u003e\u003e\u003e\n```\n\u003c/details\u003e\n\nThere is already an existing issue, https://github.com/zarr-developers/numcodecs/issues/721, is filed for the problem.\n\nFor now, I will create a PR temporarily pin the `numcodecs` dependency to below `0.16.0` until that https://github.com/zarr-developers/numcodecs/issues/721 is resolved. This issue should remain open until then.","files":null}]}