{"version":2,"ops":[{"type":3,"author":{"id":"0ab0e40999605aa8d5ec6be68372511fdc4a2fdf"},"timestamp":1658856128,"metadata":{"github-id":"IC_kwDODBZtRc5HReqO","github-url":"https://github.com/dandi/dandi-cli/issues/1070#issuecomment-1195764366"},"message":"@yarikoptic I don't think I understand the issue. https://github.com/dandi/dandi-cli/blob/1c947365311732943753e15199a57c9bfd2759bf/dandi/upload.py#L430 points to a logger line â€” or did it use to point to something else?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1658858410,"metadata":{"github-id":"IC_kwDODBZtRc5HRo8v","github-url":"https://github.com/dandi/dandi-cli/issues/1070#issuecomment-1195806511"},"message":"code changed . it is that block under it\n\n```python\n            for p in bids_datasets:\n                for bd in bids_datasets:\n                    try:\n                        p.relative_to(bd)\n                    except ValueError:\n                        try:\n                            bd.relative_to(p)\n                        except ValueError:\n                            pass\n                        else:\n                            bids_datasets_to_validate.append(bd)\n                    else:\n                        bids_datasets_to_validate.append(bd)\n```","files":null},{"type":3,"author":{"id":"0ab0e40999605aa8d5ec6be68372511fdc4a2fdf"},"timestamp":1658864690,"metadata":{"github-id":"IC_kwDODBZtRc5HSBd-","github-url":"https://github.com/dandi/dandi-cli/issues/1070#issuecomment-1195906942"},"message":"The purpose is to determine whether any of the datasets are actually subdirectories of any of the others. I guess we could use `os.path.abspath(os.path.expanduser())` on all of them and then only compare longer to shorter paths, but that's pretty roundabout and could lead to a lot of unforeseen issues. if you want I can use `itertools.product()` instead of nested for loops, but I'm not sure whether we can avoid $O(n^2)$ without causing a bigger mess.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1658865780,"metadata":{"github-id":"IC_kwDODBZtRc5HSFez","github-url":"https://github.com/dandi/dandi-cli/issues/1070#issuecomment-1195923379"},"message":"ah, this should be achievable in `O(N*log(N)) * M` where M is maximal depth, typically small... But why do we even need to know that?  \nI thought that simply \"descending\" into BIDS dataset can stop when reading another BIDS dataset below. But besides that we do not care and just need to validate all BIDS datasets we find regardless of their \"composition\" ATM.","files":null},{"type":3,"author":{"id":"0ab0e40999605aa8d5ec6be68372511fdc4a2fdf"},"timestamp":1658874706,"metadata":{"github-id":"IC_kwDODBZtRc5HSjOe","github-url":"https://github.com/dandi/dandi-cli/issues/1070#issuecomment-1196045214"},"message":"\u003e I thought that simply \"descending\" into BIDS dataset can stop when reading another BIDS dataset below.\n\nThis is implemented upstream, but not yet in DANDI (and also not in https://github.com/dandi/dandi-cli/pull/1050 ). I suggest we keep this code until we link to the upstream library at which point this and numerous other issues will evaporate :)","files":null},{"type":6,"author":{"id":"0ab0e40999605aa8d5ec6be68372511fdc4a2fdf"},"timestamp":1658874770,"metadata":{"github-id":"UCE_lALODBZtRc5HSjOeziWMfJg"},"target":"d93f9ea07da3ee0063242b25918f6f4fa21d8fa66af3a115f34986f0f7efef07","message":"\u003e I thought that simply \"descending\" into BIDS dataset can stop when reading another BIDS dataset below.\n\nThis is implemented upstream:\nhttps://github.com/bids-standard/bids-specification/blob/c80582efbee220b6f16e20ca795d25179bd95285/tools/schemacode/bidsschematools/validator.py#L63-L66\n\n but not yet in DANDI (and also not in https://github.com/dandi/dandi-cli/pull/1050 ). I suggest we keep this code until we link to the upstream library at which point this and numerous other issues will evaporate :)","files":null},{"type":6,"author":{"id":"0ab0e40999605aa8d5ec6be68372511fdc4a2fdf"},"timestamp":1658874816,"metadata":{"github-id":"UCE_lALODBZtRc5HSjOeziWMffM"},"target":"d93f9ea07da3ee0063242b25918f6f4fa21d8fa66af3a115f34986f0f7efef07","message":"\u003e I thought that simply \"descending\" into BIDS dataset can stop when reading another BIDS dataset below.\n\nThis is [implemented upstream](https://github.com/bids-standard/bids-specification/blob/c80582efbee220b6f16e20ca795d25179bd95285/tools/schemacode/bidsschematools/validator.py#L63-L66), but not yet in DANDI (and also not in https://github.com/dandi/dandi-cli/pull/1050 ). I suggest we keep this code until we link to the upstream library at which point this and numerous other issues will evaporate :)","files":null},{"type":4,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1658874957,"metadata":{"github-id":"CE_lADODBZtRc5N_3MGzwAAAAGlURGV"},"status":2}]}