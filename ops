{"version":2,"ops":[{"type":1,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1614018969,"metadata":{"github-id":"MDU6SXNzdWU4MTM3NTc2MTU=","github-url":"https://github.com/dandi/dandi-cli/issues/414","origin":"github"},"title":"dandi-api: ensure that a sample upload with large files succeeds","message":"I would like to remove myself as a middle-man-tester for a bit ;)  \n\nDear @jwodder, please work with @dchiquito (if any extra changes on dandi-api side are needed) to make sure that (re)upload of a sample subject folder works\n\nATM, I was trying with #409 merged... interrupting now the following run which is hanging on validation\n\n```shell\ndrogon:/mnt/backup/dandi/dandisets/000003\n*$\u003e DANDI_DEVEL=1 dandi -l 1 --pdb upload -i dandi-api --existing=force sub-YutaMouse33/sub-YutaMouse33_ses-YutaMouse33-1502{18,23,26}*nwb\n2021-02-22 13:10:08,902 [   DEBUG] Running a newer version (0.10.0+200.g32647ba.dirty) of dandi/dandi-cli than available (0.10.0)\n2021-02-22 13:10:10,831 [   DEBUG] Found identifier DANDI:000003 in top level 'identifier'\n2021-02-22 13:10:10,848 [    INFO] Found 3 files to consider\nPATH                                                                        SIZE        ERRORS     UPLOAD STATUS                MESSAGE\nsub-YutaMouse33/sub-YutaMouse33_ses-YutaMouse33-150218_behavior+ecephys.nwb 11.9 GB        3              skipped               failed validation\nsub-YutaMouse33/sub-YutaMouse33_ses-YutaMouse33-150223_behavior+ecephys.nwb 143.5 GB       0              ERROR                 ('Connection aborted.', OSError(\"(32, 'EPIPE')\"))\nsub-YutaMouse33/sub-YutaMouse33_ses-YutaMouse33-150226_behavior+ecephys.nwb 27.5 GB        0              validating                                                               \nSummary:                                                                    182.9 GB 1 with errors        1 skipped             1 failed validation                                \n                                                                                                          1 ERROR               1 ('Connection aborted.', OSError(\"(32, 'EPIPE')\"))\n                                                                                                          1 validating  \n```\nFWIW, the log file from that run is now on drogon under /tmp/20210222181008Z-6322.log if of any help\n\nin the end, re-upload with `--existing=force` on the entire `sub-YutaMouse33/` should pass (may be with `--validation=ignore`, didn't check).\n\nI also wonder, if it would not be wise to just re-bootstrap `dandi-api` instance so we re-start from a clean slate, and all the dandisets in there: there were quite a number of changes while we kept trying to upload/validate.  @dchiquito - what do you think?","files":null}]}