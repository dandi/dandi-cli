{"version":2,"ops":[{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1617995601,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDgxNjkwMTg1MQ==","github-url":"https://github.com/dandi/dandi-cli/issues/540#issuecomment-816901851"},"message":"@yarikoptic Your desired behavior is basically what happens with `--existing overwrite`.  Is using that option acceptable, or do you want this regardless of the value of `--existing`?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1617997962,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDgxNjkzMTUzMg==","github-url":"https://github.com/dandi/dandi-cli/issues/540#issuecomment-816931532"},"message":"default for `existing` is `refresh`. Let's \n\n- use `modified` timestamp from metadata to adjust file's mtime upon download of `dandiset.yaml` (like we do for assets IIRC).\n- use that `modified` timestamp to establish \"refresh\" logic for dandiset.yaml as well - so if local file mtime is older than on server - we refresh with the one from the server\n\nthe only side effect now would be that changes to assets also change modified timestamp for entire dandiset.  But I am ok with that.  We will just treat dandiarchive's record as the canonical source for such cases.\n\nNB found elderly https://github.com/dandi/dandi-cli/issues/154 - so the desire is \"old\".  And just today closed that issue (failed to find ATM) where I begged for dandiset.yaml to be an asset. we might come back to that :-/","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1617998066,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDgxNjkzMjM0Ng==","github-url":"https://github.com/dandi/dandi-cli/issues/540#issuecomment-816932346"},"message":"should we validate and upload changes if changed locally? or do we not allow any local changes? for programmers they could use the API to update.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1618000601,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDgxNjk1ODE4MA==","github-url":"https://github.com/dandi/dandi-cli/issues/540#issuecomment-816958180"},"message":"\u003e should we validate and upload changes if changed locally? \n\nvalidate local file during upload of a remote \"one\"?\n\n\u003e or do we not allow any local changes? \n\n\"allow\" is too strong of a word.  ATM we \"do not care for `upload`\" (besides getting a dandiset identifier).  But the use case here is with the download -- since there is not dandiset.yaml asset, we need to provide this custom logic to ensure that users who download a dandiset, do get up to date dandiset.yaml.  Validation by modification time might prevent some overwrites if they happened to modify it locally for some good reason.\n\n\u003e for programmers they could use the API to update.\n\nyeap, those who do not instantiate metadata record into a file get away easy ;)","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1618000618,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdElzc3VlQ29tbWVudEVkaXQ6NDUwNjAyNTY0"},"target":"b09408c93de3d5befab1f16898d0c62dd3f47346325be30d710453fa53fd3c97","message":"\u003e should we validate and upload changes if changed locally? \n\nvalidate local file during ~~upload~~ download of a remote \"one\"?\n\n\u003e or do we not allow any local changes? \n\n\"allow\" is too strong of a word.  ATM we \"do not care for `upload`\" (besides getting a dandiset identifier).  But the use case here is with the download -- since there is not dandiset.yaml asset, we need to provide this custom logic to ensure that users who download a dandiset, do get up to date dandiset.yaml.  Validation by modification time might prevent some overwrites if they happened to modify it locally for some good reason.\n\n\u003e for programmers they could use the API to update.\n\nyeap, those who do not instantiate metadata record into a file get away easy ;)","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1618232599,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDgxNzc5Mjg0Mw==","github-url":"https://github.com/dandi/dandi-cli/issues/540#issuecomment-817792843"},"message":"@yarikoptic \n\n\u003e default for `existing` is `refresh`. Let's\n\u003e \n\u003e * use `modified` timestamp from metadata to adjust file's mtime upon download of `dandiset.yaml` (like we do for assets IIRC).\n\u003e * use that `modified` timestamp to establish \"refresh\" logic for dandiset.yaml as well - so if local file mtime is older than on server - we refresh with the one from the server\n\nI assume that the first bullet should always be done and the second is for when `existing == \"refresh\"`.  What should happen when `refresh` is `\"error\"` or `\"skip\"`?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1618234237,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDgxNzgxMzU5Nw==","github-url":"https://github.com/dandi/dandi-cli/issues/540#issuecomment-817813597"},"message":"\u003e I assume that the first bullet should always be done\n\nyes\n\n\u003e What should happen when refresh is \"error\" or \"skip\"?\n\nwhat happens for other files -- error or skip, i.e. no modifications to local one","files":null},{"type":4,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1618259239,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50NDU4NDQzNjUyOA=="},"status":2}]}