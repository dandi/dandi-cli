{"version":2,"ops":[{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1677188469,"metadata":{"github-id":"IC_kwDODBZtRc5V-k6L","github-url":"https://github.com/dandi/dandi-cli/issues/1217#issuecomment-1442467467"},"message":"Upon a quick attempt to use `download` from command line -- seems to be doing the right thing:\n\n```\nyoh@typhon:~/tmp$ dandi --version\n0.49.1+15.g47a07b0\nyoh@typhon:~/tmp$ dandi download -J4 DANDI:000003\nPATH                                                   SIZE     DONE          DONE% CHECKSUM STATUS        MESSAGE\ndandiset.yaml                                                                                done          updated\n.....Mouse20_ses-YutaMouse20-140327_behavior+ecephys.nwb 8.4 GB   192.9 MB         2%          downloading             .Mouse20_ses-YutaMouse20-140321_behavior+ecephys.nwb 11.7 GB  327.2 MB         2%          downloading\n...Mouse20_ses-YutaMouse20-140325_behavior+ecephys.nwb 17.3 GB  100.7 MB         0%          downloading\n...Mouse20_ses-YutaMouse20-140324_behavior+ecephys.nwb 15.1 GB  58.7 MB          0%          downloading\n...Mouse20_ses-YutaMouse20-140324_behavior+ecephys.nwb 15.1 GB  67.1 MB          0%          downloading\n```\nso you can see multiple (not sure why 5 not 4) files being downloaded.  Looking at the code I think I might see what might be an issue -- what value for `format` do you specify? ATM `download` parallelization is implemented through `pyout` threading of rendering per each item, so if you chose some other value, it would not parallelize.  Confirming\n\n```\n python -c 'from dandi.download import download; download(\"DANDI:000003\", jobs=4, output_dir=\"000003\")'\n```\ndid similar parallelization as from CLI, but \n```\npython -c 'from dandi.download import download; download(\"DANDI:000003\", jobs=4, output_dir=\"000003\", format=\"debug\")'\n```\ndid it serially.  I will just clarify that via a warning to the user for now in https://github.com/dandi/dandi-cli/pull/1222 .","files":null},{"type":3,"author":{"id":"23a0b490ec2a3aef708e5bf3548508030984c8bd"},"timestamp":1677191694,"metadata":{"github-id":"IC_kwDODBZtRc5V-xye","github-url":"https://github.com/dandi/dandi-cli/issues/1217#issuecomment-1442520222"},"message":"Sorry, I wasn't very clear! As you confirmed, it's possible to download in parallel if I just specify the full dandiset, but I cannot pass a list of URLs and download them in parallel. In fact, I took another look at the code and remembered that you can't in fact pass multiple URLs to `download()` (it raises an error). I should have phrased this clearly as a feature request (unless there is another way that I don't know about to download in parallel from a dandiset, using a list of URLs).","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1677526140,"metadata":{"github-id":"IC_kwDODBZtRc5WPoSy","github-url":"https://github.com/dandi/dandi-cli/issues/1217#issuecomment-1446937778"},"message":"@jwodder what do you think we should do here? i.e. possibly at what level of APIs provide a convenience to download multiple URLs in parallel and how?  e.g. we could fix it up on this top level by first explicitly verifying that all URLs come from the same dandiset or just not carrying about it at all (IIRC we just use for figuring out top directory to download to)","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1677527520,"metadata":{"github-id":"IC_kwDODBZtRc5WPyQ3","github-url":"https://github.com/dandi/dandi-cli/issues/1217#issuecomment-1446978615"},"message":"@yarikoptic It shouldn't be too hard to just make `download()` with multiple URLs act like multiple calls to `download()` that just happen to be parallel (e.g., each URL would get its own output directory determined the same way as for a single URL argument).","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1677534247,"metadata":{"github-id":"IC_kwDODBZtRc5WQamE","github-url":"https://github.com/dandi/dandi-cli/issues/1217#issuecomment-1447143812"},"message":"ok, let's do that then!","files":null},{"type":4,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1677539235,"metadata":{"github-id":"CE_lADODBZtRc5fG5JPzwAAAAIB3KYF"},"status":2},{"type":4,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1677594488,"metadata":{"github-id":"REE_lADODBZtRc5fG5JPzwAAAAICPtbp"},"status":1},{"type":4,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1677696712,"metadata":{"github-id":"CE_lADODBZtRc5fG5JPzwAAAAIDE-n8"},"status":2},{"type":3,"author":{"id":"23a0b490ec2a3aef708e5bf3548508030984c8bd"},"timestamp":1677803353,"metadata":{"github-id":"IC_kwDODBZtRc5Wl3Da","github-url":"https://github.com/dandi/dandi-cli/issues/1217#issuecomment-1452765402"},"message":"It works! Thank you so much.","files":null}]}