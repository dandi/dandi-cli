{"version":2,"ops":[{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1678223381,"metadata":{"github-id":"IC_kwDODBZtRc5W9LfV","github-url":"https://github.com/dandi/dandi-cli/issues/1242#issuecomment-1458878421"},"message":"Me familiarizing myself with the situaation: in dandischema we have\n\n```json\nclass AgeReferenceType(Enum):\n    \"\"\"An enumeration of age reference\"\"\"\n\n    #: Age since Birth\n    BirthReference = \"dandi:BirthReference\"\n\n    #: Age of a pregnancy (https://en.wikipedia.org/wiki/Gestational_age)\n    GestationalReference = \"dandi:GestationalReference\"\n```\n\nbetween which we already decide at https://github.com/dandi/dandi-cli/blob/HEAD/dandi/metadata.py#L382 seems to choosing Birth if `date_of_birth` is known, but then at https://github.com/dandi/dandi-cli/blob/HEAD/dandi/metadata.py#L309 deciding also from `age` to be gestational if \"gestational \" prefix is used in the `age`.  That matches what nwb-schema says: https://github.com/NeurodataWithoutBorders/nwb-schema/blob/dev/core/nwb.file.yaml#L449  .\n\nSo, for `Subject.age__reference` you now  have similar logic implemented now, and we should, in case of up to date PyNWB just use it instead of our custom parsing/logic, correct?","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1678223392,"metadata":{"github-id":"UCE_lALODBZtRc5W9LfVzi481lM"},"target":"8f976799d283554a3979b6eab99727fef46a8814a7d953b023ca50068503aefb","message":"Me familiarizing myself with the situaation: in dandischema we have\n\n```python\nclass AgeReferenceType(Enum):\n    \"\"\"An enumeration of age reference\"\"\"\n\n    #: Age since Birth\n    BirthReference = \"dandi:BirthReference\"\n\n    #: Age of a pregnancy (https://en.wikipedia.org/wiki/Gestational_age)\n    GestationalReference = \"dandi:GestationalReference\"\n```\n\nbetween which we already decide at https://github.com/dandi/dandi-cli/blob/HEAD/dandi/metadata.py#L382 seems to choosing Birth if `date_of_birth` is known, but then at https://github.com/dandi/dandi-cli/blob/HEAD/dandi/metadata.py#L309 deciding also from `age` to be gestational if \"gestational \" prefix is used in the `age`.  That matches what nwb-schema says: https://github.com/NeurodataWithoutBorders/nwb-schema/blob/dev/core/nwb.file.yaml#L449  .\n\nSo, for `Subject.age__reference` you now  have similar logic implemented now, and we should, in case of up to date PyNWB just use it instead of our custom parsing/logic, correct?","files":null},{"type":6,"author":{"id":"f068089e26f6e2e30d51a62e75a77af7d9dc5ecb"},"timestamp":1678229611,"metadata":{"github-id":"UCE_lALODBZtRc5W9LfVzi4-G70"},"target":"8f976799d283554a3979b6eab99727fef46a8814a7d953b023ca50068503aefb","message":"Me familiarizing myself with the situation: in dandischema we have\n\n```python\nclass AgeReferenceType(Enum):\n    \"\"\"An enumeration of age reference\"\"\"\n\n    #: Age since Birth\n    BirthReference = \"dandi:BirthReference\"\n\n    #: Age of a pregnancy (https://en.wikipedia.org/wiki/Gestational_age)\n    GestationalReference = \"dandi:GestationalReference\"\n```\n\nbetween which we already decide at https://github.com/dandi/dandi-cli/blob/HEAD/dandi/metadata.py#L382 seems to choosing Birth if `date_of_birth` is known, but then at https://github.com/dandi/dandi-cli/blob/HEAD/dandi/metadata.py#L309 deciding also from `age` to be gestational if \"gestational \" prefix is used in the `age`.  That matches what nwb-schema says: https://github.com/NeurodataWithoutBorders/nwb-schema/blob/dev/core/nwb.file.yaml#L449  .\n\nSo, for `Subject.age__reference` you now  have similar logic implemented now, and we should, in case of up to date PyNWB just use it instead of our custom parsing/logic, correct?","files":null},{"type":3,"author":{"id":"f068089e26f6e2e30d51a62e75a77af7d9dc5ecb"},"timestamp":1678229854,"metadata":{"github-id":"IC_kwDODBZtRc5W9nzu","github-url":"https://github.com/dandi/dandi-cli/issues/1242#issuecomment-1458994414"},"message":"I didn't know users were prefixing with \"gestational \". I think that's a perfectly fine work-around for earlier users. I guess the updated logic should be something like:\n\n```python\nif subject.age.startswith(\"gestational \") or subject.age__reference == \"gestational\":\n    AgeReference = GestationalReference\nelse:\n    AgeReference = BirthReference\n```","files":null}]}