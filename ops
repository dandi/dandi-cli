{"version":2,"ops":[{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1624319202,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdElzc3VlRWRpdDo1NTk0MjM0MDk="},"target":"e48f8ce8c22d5e6c5dcc46062c713bdc799bee1f360cbe36f256d30b583dea16","message":"initially reported by @dchiquito in https://github.com/dandi/dandi-cli/issues/677 as a crash of pyout.\nTrying to reproduce it locally after creating a new dandiset on staging (https://gui-staging.dandiarchive.org/#/dandiset/000018 , added @jwodder to it now just in case)\n\n\u003cdetails\u003e\n\u003csummary\u003efull protocol\u003c/summary\u003e \n\n```shell\n(git-annex)lena:~/proj/dandi/dandisets/000006[master]git-annex\n$\u003e cd /tmp/000018\ndandiset.yaml\n(dev3) 1 17658.....................................:Mon 21 Jun 2021 07:39:05 PM EDT:.\nlena:/tmp/000018\n$\u003e mkdir sub-anm372909\n(dev3) 1 17659.....................................:Mon 21 Jun 2021 07:39:16 PM EDT:.\nlena:/tmp/000018\n$\u003e cp /home/yoh/proj/dandi/dandisets/000006/sub-anm372909/sub-anm372909_ses-20170522.nwb sub-anm372909\n(dev3) 1 17660.....................................:Mon 21 Jun 2021 07:39:22 PM EDT:.\nlena:/tmp/000018\n$\u003e DANDI_DEVEL=1 dandi upload -i dandi-staging -e force sub-anm372909/sub-anm372909_ses-20170522.nwb \nPlease provide API Key for dandi-staging: d7bb3970ac4802f4d06c0ef4fd7f5720b05423eb\n2021-06-21 19:39:58,601 [    INFO] Found 1 files to consider\nPATH                                         SIZE    ERRORS UPLOAD STATUS           MESSAGE\nsub-anm372909/sub-anm372909_ses-20170522.nwb 5.7 MB                pre-validating          \nSummary:                                     5.7 MB                1 pre-validating        \nPATH                                     SIZE       ERRORS     UPLOAD STATUS           MESSAGE            ...372909/sub-anm372909_ses-20170522.nwb 5.7 MB        4              skipped          failed validation  \nSummary:                                 5.7 MB  1 with errors        1 skipped        1 failed validation\n2021-06-21 19:39:58,847 [    INFO] Logs saved in /home/yoh/.cache/dandi-cli/log/20210621233945Z-3478926.log\n(dev3) 1 17661.....................................:Mon 21 Jun 2021 07:40:04 PM EDT:.\nlena:/tmp/000018\n$\u003e cat /home/yoh/.cache/dandi-cli/log/20210621233945Z-3478926.log\n2021-06-21T19:39:45-0400 [INFO    ] dandi 3478926:140631754692416 dandi v0.20.0+18.g55b7b6b, hdmf v2.5.7, pynwb v1.5.1, h5py v2.10.0\n2021-06-21T19:39:45-0400 [INFO    ] dandi 3478926:140631754692416 sys.argv = ['/home/yoh/proj/dandi/dandi-cli-master/venvs/dev3/bin/dandi', 'upload', '-i', 'dandi-staging', '-e', 'force', 'sub-anm372909/sub-anm372909_ses-20170522.nwb']\n2021-06-21T19:39:45-0400 [INFO    ] dandi 3478926:140631754692416 os.getcwd() = /tmp/000018\n2021-06-21T19:39:58-0400 [INFO    ] dandi 3478926:140631754692416 Found 1 files to consider\n2021-06-21T19:39:58-0400 [WARNING ] dandi 3478926:140631614457600 pynwb validation errors for /tmp/000018/sub-anm372909/sub-anm372909_ses-20170522.nwb: [root/general/experimenter (general/experimenter): incorrect shape - expected an array of shape '[None]', got non-array data 'Mike Economo', root/general/related_publications (general/related_publications): incorrect shape - expected an array of shape '[None]', got non-array data 'doi:10.1038/s41586-018-0642-9', VectorIndex/description (units/spike_times_index): argument missing, VectorIndex (units/spike_times_index): incorrect type - expected 'uint8', got 'int32', VectorIndex/description (units/electrodes_index): argument missing, VectorIndex (units/electrodes_index): incorrect type - expected 'uint8', got 'int32']\n2021-06-21T19:39:58-0400 [INFO    ] dandi 3478926:140631754692416 Logs saved in /home/yoh/.cache/dandi-cli/log/20210621233945Z-3478926.log\n(dev3) 1 17662.....................................:Mon 21 Jun 2021 07:40:08 PM EDT:.\nlena:/tmp/000018\n$\u003e DANDI_DEVEL=1 dandi upload -i dandi-staging -e force --validation ignore sub-anm372909/sub-anm372909_ses-20170522.nwb\n2021-06-21 19:40:22,195 [    INFO] Found 1 files to consider\nPATH                                         SIZE      ERRORS     UPLOAD STATUS MESSAGE ASSET                                                                                                                        \nsub-anm372909/sub-anm372909_ses-20170522.nwb 5.7 MB       4              done           client=\u003cdandi.dandiapi.DandiAPIClient object at 0x7fb600811400\u003e dandiset_id='000018' version_id='draft' identifier='e2ebde...\nSummary:                                     5.7 MB 1 with errors        1 done                                                                                                                                      \n2021-06-21 19:40:23,435 [    INFO] Logs saved in /home/yoh/.cache/dandi-cli/log/20210621234019Z-3479080.log\n(dev3) 1 17663.....................................:Mon 21 Jun 2021 07:40:23 PM EDT:.\nlena:/tmp/000018\n$\u003e DANDI_DEVEL=1 dandi upload -i dandi-staging -e force --validation ignore --devel-debug sub-anm372909/sub-anm372909_ses-20170522.nwb\n2021-06-21 19:41:10,386 [    INFO] Found 1 files to consider\n{'size': 5670812}\n{'status': 'pre-validating'}\n{'errors': 4}\n{'status': 'digesting'}\n{'message': 'exists (same) - reuploading'}\n{'status': 'extracting metadata'}\n{'status': 'uploading'}\n{'status': 'calculating etag'}\n{'status': 'initiating upload'}\n{'status': 'producing asset'}\n{'status': 'done', 'asset': RemoteAsset(client=\u003cdandi.dandiapi.DandiAPIClient object at 0x7f635ad9c220\u003e, dandiset_id='000018', version_id='draft', identifier='33be0152-5c0f-4872-abac-605d5f4c702f', path='sub-anm372909/sub-anm372909_ses-20170522.nwb', size=5670812, modified=datetime.datetime(2021, 6, 21, 23, 41, 10, 799402, tzinfo=datetime.timezone.utc))}\n{'status': 'done'}\nPATH                                         SIZE    ERRORS UPLOAD STATUS MESSAGE\nsub-anm372909/sub-anm372909_ses-20170522.nwb                                     \nSummary:                                     0 Bytes                             \n2021-06-21 19:41:10,891 [    INFO] Logs saved in /home/yoh/.cache/dandi-cli/log/20210621234108Z-3479196.log\n\n```\n\u003c/details\u003e\n\nrunning the command in `--devel-debug` (and without that - see in output above to get `asset` column) we can see that there is now unexpected to `ls` pyout code a record with an `asset` etc:\n```\n$\u003e DANDI_DEVEL=1 dandi upload -i dandi-staging -e force --validation ignore --devel-debug sub-anm372909/sub-anm372909_ses-20170522.nwb\n2021-06-21 19:41:10,386 [    INFO] Found 1 files to consider\n{'size': 5670812}\n{'status': 'pre-validating'}\n{'errors': 4}\n{'status': 'digesting'}\n{'message': 'exists (same) - reuploading'}\n{'status': 'extracting metadata'}\n{'status': 'uploading'}\n{'status': 'calculating etag'}\n{'status': 'initiating upload'}\n{'status': 'producing asset'}\n{'status': 'done', 'asset': RemoteAsset(client=\u003cdandi.dandiapi.DandiAPIClient object at 0x7f635ad9c220\u003e, dandiset_id='000018', version_id='draft', identifier='33be0152-5c0f-4872-abac-605d5f4c702f', path='sub-anm372909/sub-anm372909_ses-20170522.nwb', size=5670812, modified=datetime.datetime(2021, 6, 21, 23, 41, 10, 799402, tzinfo=datetime.timezone.utc))}\n{'status': 'done'}\nPATH                                         SIZE    ERRORS UPLOAD STATUS MESSAGE\nsub-anm372909/sub-anm372909_ses-20170522.nwb                                     \nSummary:                                     0 Bytes                             \n2021-06-21 19:41:10,891 [    INFO] Logs saved in /home/yoh/.cache/dandi-cli/log/20210621234108Z-3479196.log\n```","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1624323024,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg2NTQ0MDM5Nw==","github-url":"https://github.com/dandi/dandi-cli/issues/678#issuecomment-865440397"},"message":"Kudos to @satra for alerting me that I exposed API key in above cut/paste.  I have re-minted it now.","files":null},{"type":4,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1624366299,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50NDkyMjUzNjc0Nw=="},"status":2}]}