{"version":2,"ops":[{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1630588578,"metadata":{"github-id":"IC_kwDODBZtRc42Vv_9","github-url":"https://github.com/dandi/dandi-cli/issues/764#issuecomment-911671293"},"message":"@kaeldai Normally, this error occurs when the file being uploaded is modified locally during the upload process.  Is there anything on your system that would be doing that?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1630588783,"metadata":{"github-id":"IC_kwDODBZtRc42Vw3m","github-url":"https://github.com/dandi/dandi-cli/issues/764#issuecomment-911674854"},"message":"Thank you for the detailed report!\nTransferred to dandi-cli since the issue must be there (or in another library -- fscacher).\n\nWould you be so kind to retry with `DANDI_CACHE=clear dandi upload` -- it must take longer since will need to recompute digests. If that works, unfortunately, we would be left in the dark on why it \"failed\" on us since it should have taken all kinds of those files attributes into account and if file was updated anyhow, we should have recomputed the digest.\n\nSince you used `organize` with default mode on ubuntu, I guess it created symlinks to files, right (please check, or may be they  were hardlinks)?  For symlinks  [we resolve the path](https://github.com/con/fscacher/blob/master/src/fscacher/cache.py#L103) so it should have worked correctly (attn @jwodder - may be we lack a dedicated unittest for that?)\n\nAlso note a warning (I think we might want to turn those to errors if nwb loads fine, but metadata harmonization fails):\n```\nValueError: not able to parse the age: 19 weeksD, no rules to convert: D\n```\nshould it have been just `19 weeks`?  (`Logs` fold seems to be empty -- there might be similar warning for other files?)","files":null},{"type":3,"author":{"id":"21bbe6f5e3272d3fe8aa9b85bbd29a984d2b0505"},"timestamp":1630605268,"metadata":{"github-id":"IC_kwDODBZtRc42WtuR","github-url":"https://github.com/dandi/dandi-cli/issues/764#issuecomment-911924113"},"message":"Hi @jwodder and @yarikoptic - Thank you for your help! The problem has been fixed now.\n\nI tried `DANDI_CACHE=clear` and it didn't work. But as pointed out the failed files had a parsing error in the /subject/age value which I didn't notice before.  Most of the sessions have use age in days, but a few had age in weeks. I fixed the values and then did another `dandi upload` and it is now able to upload all the files. \n\nThank you again!","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1630607411,"metadata":{"github-id":"IC_kwDODBZtRc42Wz6H","github-url":"https://github.com/dandi/dandi-cli/issues/764#issuecomment-911949447"},"message":"eh, bug ran away now! ;) it is still odd that upload failed that way, especially after you did `DANDI_CACHE=clear` and unlikely there was that long running file modifying process in the background, unless we have some bug in logic that if metadata conversion fails -- that it somehow affects the upload.  @jwodder -- could you please skim through the code, or better create a unittest with such a case of non-parseable age and see if upload fails (or not - and mystery would remain) similarly.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1630609351,"metadata":{"github-id":"IC_kwDODBZtRc42W5ZK","github-url":"https://github.com/dandi/dandi-cli/issues/764#issuecomment-911971914"},"message":"@yarikoptic I created an NWB file with a bad age and tried uploading it manually.  [I found (and fixed) one unrelated bug](https://github.com/dandi/dandi-cli/pull/767), but trying to upload again just skipped the file with \"failed to extract metadata\".","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1630610557,"metadata":{"github-id":"IC_kwDODBZtRc42W8-0","github-url":"https://github.com/dandi/dandi-cli/issues/764#issuecomment-911986612"},"message":"Thank you @jwodder \nEh so mystery seems to remain. Long shot @kaeldai - any specifics on the filesystem you could share? Local vs NFS, etc","files":null},{"type":3,"author":{"id":"21bbe6f5e3272d3fe8aa9b85bbd29a984d2b0505"},"timestamp":1630614704,"metadata":{"github-id":"IC_kwDODBZtRc42XIc3","github-url":"https://github.com/dandi/dandi-cli/issues/764#issuecomment-912033591"},"message":"Hi @yarikoptic - I said I was using ubuntu above, but I realize I was logged into to a Centos 7.9 machine using a 3.10.0 kernel. The filesystem is nsf 4. \n\nI can regenerate the old nwb with the bad format strings if you think that will help?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1659126363,"metadata":{"github-id":"IC_kwDODBZtRc5HhVmd","github-url":"https://github.com/dandi/dandi-cli/issues/764#issuecomment-1199921565"},"message":"@kaeldai how was NFS4 and dandi-cli were treating you -- did you encounter similar \"mutating\" files?\n\n@jwodder - do you remember us fixing any possibly related issue in the past year?","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1659126507,"metadata":{"github-id":"IC_kwDODBZtRc5HhV9U","github-url":"https://github.com/dandi/dandi-cli/issues/764#issuecomment-1199923028"},"message":"@yarikoptic No, I do not.","files":null}]}