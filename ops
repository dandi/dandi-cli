{"version":2,"ops":[{"type":1,"author":{"id":"23a0b490ec2a3aef708e5bf3548508030984c8bd"},"timestamp":1680703595,"metadata":{"github-id":"I_kwDODBZtRc5ir960","github-url":"https://github.com/dandi/dandi-cli/issues/1266","origin":"github"},"title":"Saving a file after running nwbfile.generate_new_id() seems to lead to a DANDI validation error","message":"I wanted to create a second version of the same NWB file, in which I add the full imaging stack as an acquisition object. To allow the versions to co-exist alongside one another, I ran `nwbfile.generate_new_id()` on the new file before saving it.\n\nI had no problem loading the file, running my analyses on it, and the `nwbinspector` produced no validation errors. However, when it came time to run `dandi organize`, the new file was flagged as having a completely empty record:\n\n\u003e 2023-04-05 00:09:58,416 [ WARNING] Completely empty record for ../../VALID/sub-408021_ses-759189643_behavior+image+ophys+stack.nwb\n\u003e Error: 1 out of 2 files were found not containing all necessary metadata: ../../VALID/sub-408021_ses-759189643_behavior+image+ophys+stack.nwb\n\nAfter a lot of testing, I concluded that the problem was specifically due to running `nwbfile.generate_new_id()` (which I believe changes the object IDs for all objects in the NWB file?). If I instead just update the `object_id` of NWB file itself manually using `h5py`, I don't encounter this problem.","files":null}]}