{"version":2,"ops":[{"type":1,"author":{"id":"a9e2633aeb6d7e2366a97d09712312c2442c6054"},"timestamp":1768601259,"metadata":{"github-id":"I_kwDODBZtRc7j6wEu","github-url":"https://github.com/dandi/dandi-cli/issues/1777","origin":"github"},"title":"Improve inefficient retrieval of zarr chunks from the API","message":"We are receiving many requests to the API, from the CLI, of the following format:\n```\nGET /api/zarr/\u003czarr_id\u003e/files/?prefix=0/0/0/13/14/97\u0026download=true\n```\n\nOften times, the path provided (`0/0/0/13/14/97`) is itself the only file returned, and as such, could just be retrieved by querying for the \"level\" above (`0/0/0/13/14`). Really though, every response from that endpoint is itself an object, so there should never be a case where the CLI is trying to determine if a path returned is a directory or a file.\n\nI believe the code generating these requests lives here:\n\nhttps://github.com/dandi/dandi-cli/blob/953923aff871fc4dd16e3435427576e48eadb7c4/dandi/dandiapi.py#L1786-L1795\n\nIt's possible the requests we're receiving are from a modified version of the CLI, in which case this issue can be closed (if we can truly determine that to be the case).","files":null}]}