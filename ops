{"version":2,"ops":[{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1664457233,"metadata":{"github-id":"IC_kwDODBZtRc5LPJsw","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1262263088"},"message":"@yarikoptic So should the `publish()` method just poll the version info endpoint indefinitely until the publication is finished?\n\n@mvandenburgh What happens if the publish task fails?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1664458520,"metadata":{"github-id":"IC_kwDODBZtRc5LPRWW","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1262294422"},"message":"poll: I think so, but not indefinitely.  I feel we have some other similar interface where we do similar polling already. @mvandenburgh - is there a reasonable duration to wait for for such new publishing process and error out if timing out?","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1664458647,"metadata":{"github-id":"IC_kwDODBZtRc5LPSAy","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1262297138"},"message":"@yarikoptic Are you thinking of [`wait_until_valid()`](https://github.com/dandi/dandi-cli/blob/d5ed594fb4f6c1d989ab15c0612e8b2da6072abf/dandi/dandiapi.py#L934)?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1664459228,"metadata":{"github-id":"IC_kwDODBZtRc5LPVJ4","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1262310008"},"message":"\u003e @yarikoptic Are you thinking of [`wait_until_valid()`](https://github.com/dandi/dandi-cli/blob/d5ed594fb4f6c1d989ab15c0612e8b2da6072abf/dandi/dandiapi.py#L934)?\n\nyes!","files":null},{"type":3,"author":{"id":"c3aba9547dfec2aff2928d9a69b39673172a76a7"},"timestamp":1664484231,"metadata":{"github-id":"IC_kwDODBZtRc5LRLQN","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1262793741"},"message":"\u003e poll: I think so, but not indefinitely. I feel we have some other similar interface where we do similar polling already. @mvandenburgh - is there a reasonable duration to wait for for such new publishing process and error out if timing out?\n\nThe default timeout on `wait_until_valid()` (120 seconds) should be more than enough. I can't imagine it would take anywhere near that in most cases, although the overhead of placing it onto the queue and celery picking it up might make it vary by a few seconds if we're under heavy load.\n\n\n\u003e @yarikoptic So should the `publish()` method just poll the version info endpoint indefinitely until the publication is finished?\n\u003e \n\u003e @mvandenburgh What happens if the publish task fails?\n\nThe publish endpoint will check if a Version is eligible to be published prior to dispatching the task, and will let the requester know with a 400 error. If the publish task fails while running due to some strange conditions, like the worker dying, it will be retried again until it succeeds.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1664544817,"metadata":{"github-id":"IC_kwDODBZtRc5LUL-J","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1263583113"},"message":"@mvandenburgh Another question: Previously, `POST /dandisets/:id/versions/:id/publish/` would return the new version object in the response.  What does it return now?  Is querying `/dandisets/:id/versions/` the only way now to get the newly-published version?","files":null},{"type":6,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1664544860,"metadata":{"github-id":"UCE_lALODBZtRc5LUL-Jzifc8xE"},"target":"ffba41c59ed8e66e22fcc5ad6c9e138eee157fa79491ef65fe39b272f8c427ef","message":"@mvandenburgh Another question: Previously, `POST /dandisets/:id/versions/:id/publish/` would return the new version object in the response.  What does it return now?  Is querying `/dandisets/:id/versions/` the only way now to get the newly-published version?\n\nAlso, what are all the values for the \"status\" field of version objects?","files":null},{"type":3,"author":{"id":"c3aba9547dfec2aff2928d9a69b39673172a76a7"},"timestamp":1664549620,"metadata":{"github-id":"IC_kwDODBZtRc5LUjlr","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1263679851"},"message":"\u003e @mvandenburgh Another question: Previously, `POST /dandisets/:id/versions/:id/publish/` would return the new version object in the response. What does it return now? Is querying `/dandisets/:id/versions/` the only way now to get the newly-published version?\n\nCorrect. Now, the response will be empty. Instead, the status code now indicates what the status of the publishing is; in particular, a status of 423 after POSTing to the `/publish` endpoint has been introduced, and it indicates that a publish is already occurring. I can elaborate more on the 400 status codes that this endpoint can return and what each means if that is needed.\n\n\n\u003e Also, what are all the values for the \"status\" field of version objects?\n\n```\n'Pending'\n'Validating'\n'Valid'\n'Invalid'\n'Publishing'\n'Published'\n```\n(Sorry for the confusion about upper/lower-case; my comments above were incorrect, each `status` will be lowercase)","files":null},{"type":6,"author":{"id":"c3aba9547dfec2aff2928d9a69b39673172a76a7"},"timestamp":1664549654,"metadata":{"github-id":"UCE_lALODBZtRc5LUjlrzifd02o"},"target":"d4036e6dfcc47a6212fcef02be4b2edc9c17536c2b954dae2a56215652d67e95","message":"\u003e @mvandenburgh Another question: Previously, `POST /dandisets/:id/versions/:id/publish/` would return the new version object in the response. What does it return now? Is querying `/dandisets/:id/versions/` the only way now to get the newly-published version?\n\nCorrect. Now, the response will be empty. Instead, the status code now indicates what the status of the publishing is; in particular, a status of 423 after POSTing to the `/publish` endpoint has been introduced, and it indicates that a publish is already occurring. I can elaborate more on the 400 status codes that this endpoint can return and what each means if that is needed.\n\n\n\u003e Also, what are all the values for the \"status\" field of version objects?\n\n```\n'Pending'\n'Validating'\n'Valid'\n'Invalid'\n'Publishing'\n'Published'\n```\n(Sorry for the confusion about upper/lower-case; my earlier comments were incorrect, each `status` will be lowercase, i.e. exactly what they are above)","files":null},{"type":6,"author":{"id":"c3aba9547dfec2aff2928d9a69b39673172a76a7"},"timestamp":1664549995,"metadata":{"github-id":"UCE_lALODBZtRc5LUjlrzifd45k"},"target":"d4036e6dfcc47a6212fcef02be4b2edc9c17536c2b954dae2a56215652d67e95","message":"\u003e @mvandenburgh Another question: Previously, `POST /dandisets/:id/versions/:id/publish/` would return the new version object in the response. What does it return now? Is querying `/dandisets/:id/versions/` the only way now to get the newly-published version?\n\nCorrect. Now, the response will be empty. Instead, the status code now indicates what the status of the publishing is; in particular, a status of 423 after POSTing to the `/publish` endpoint has been introduced, and it indicates that a publish is already occurring. I can elaborate more on the 400 status codes that this endpoint can return and what each means if that is needed.\n\n\n\u003e Also, what are all the values for the \"status\" field of version objects?\n\n```\n'Pending'\n'Validating'\n'Valid'\n'Invalid'\n'Publishing'\n'Published'\n```\n(Sorry for the confusion about upper/lower-case; my earlier comments were incorrect, each `status` will be lowercase with the exception of the first character, i.e. exactly what they are above)","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1664806842,"metadata":{"github-id":"IC_kwDODBZtRc5LbkKt","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1265517229"},"message":"@mvandenburgh If the CLI were to use this new workflow against a pre-dandi/dandi-archive#1006 version of the Archive, is the workflow intended to be backwards-compatible, or is some specific error expected?  Currently, in testing the new workflow in the CLI, it appears that the `/info/` endpoint has status \"Published\" immediately yet the first Published version listed by the `/versions/` endpoint is the draft version.","files":null},{"type":3,"author":{"id":"c3aba9547dfec2aff2928d9a69b39673172a76a7"},"timestamp":1664815745,"metadata":{"github-id":"IC_kwDODBZtRc5LcbaG","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1265743494"},"message":"The `/versions/` endpoint in the pre-dandi/dandi-archive#1006 version of the Archive, i.e. what is running in staging and production right now, returns versions ordered by their creation time in ascending order; so, the draft version will always be first, and the most recently published version will always be last. dandi-archive#1006 changes that to be the reverse by default.\n\nHowever, it's possible (both in the current API and the new one proposed in dandi-archive#1006) to override that with the `ordering` query parameter. So you can achieve the same behavior as the proposed API in the current one by setting `?ordering=-created`. As I'm writing this, I'm realizing that we can avoid modifying the behavior of the `/versions/` endpoint and altogether and instead require the client to specify the order they want. Then, newer versions of the CLI and web app can just specify `ordering=-created` to retrieve the most recently published version. I'm going to go ahead and make that change in the API PR.","files":null},{"type":6,"author":{"id":"c3aba9547dfec2aff2928d9a69b39673172a76a7"},"timestamp":1664815780,"metadata":{"github-id":"UCE_lALODBZtRc5LcbaGzifvfI0"},"target":"2efe0edbffb210b6fbff36920905316c6f2684ecf77f8b7c95c35a78119f91e7","message":"The `/versions/` endpoint in the pre-dandi/dandi-archive#1006 version of the Archive, i.e. what is running in staging and production right now, returns versions ordered by their creation time in ascending order; so, the draft version will always be first, and the most recently published version will always be last. dandi-archive#1006 changes that to be the reverse by default.\n\nHowever, it's possible (both in the current API and the new one proposed in dandi-archive#1006) to override that with the `ordering` query parameter. So you can achieve the same behavior as the proposed API in the current one by setting `?ordering=-created`. As I'm writing this, I'm realizing that we can avoid modifying the behavior of the `/versions/` endpoint altogether and instead require the client to specify the order they want. Then, newer versions of the CLI and web app can just specify `ordering=-created` to retrieve the most recently published version. I'm going to go ahead and make that change in the API PR.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1664818167,"metadata":{"github-id":"IC_kwDODBZtRc5Lcn5O","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1265794638"},"message":"@mvandenburgh So the `/versions/` endpoint is ordered by `?ordering`, yet the `/assets/` endpoint is ordered by `?order`?  Why the inconsistency?","files":null},{"type":3,"author":{"id":"c3aba9547dfec2aff2928d9a69b39673172a76a7"},"timestamp":1664827581,"metadata":{"github-id":"IC_kwDODBZtRc5LdSYY","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1265968664"},"message":"I agree that they should be consistent. Does the CLI use either of those query parameters with those endpoints?","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1664827983,"metadata":{"github-id":"IC_kwDODBZtRc5LdUMA","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1265976064"},"message":"@mvandenburgh The CLI currently only uses the `/assets/?order` parameter, and it's controlled by a method argument named \"`order`\".","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1664888295,"metadata":{"github-id":"IC_kwDODBZtRc5LhDmV","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1266956693"},"message":"@jwodder @mvandenburgh could you please update on the status -- are we waiting for dandi-archive to harmonize `ordering` -\u003e `order` or there is nothing to wait for?","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1664888397,"metadata":{"github-id":"IC_kwDODBZtRc5LhEJQ","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1266958928"},"message":"@yarikoptic I have a PR in progress, but the tests are failing because of the order in which versions are currently returned, and I'd like to know whether to use `order` or `ordering` to adjust the order.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1664898913,"metadata":{"github-id":"IC_kwDODBZtRc5LiEDb","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1267220699"},"message":"Thank you @jwodder! @mvandenburgh is change coming to dandi-archive to harmonize that option to `order` or it will remain `ordering`?","files":null},{"type":3,"author":{"id":"c3aba9547dfec2aff2928d9a69b39673172a76a7"},"timestamp":1664903581,"metadata":{"github-id":"IC_kwDODBZtRc5LiaFa","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1267310938"},"message":"@jwodder @yarikoptic I just merged a change to dandi-archive changing the `/versions/` endpoint to accept `order` instead of `ordering`.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1664981222,"metadata":{"github-id":"IC_kwDODBZtRc5LnHX6","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1268545018"},"message":"@mvandenburgh For documentation purposes, what fields can `/versions/` be ordered by besides `created`?","files":null},{"type":3,"author":{"id":"c3aba9547dfec2aff2928d9a69b39673172a76a7"},"timestamp":1664981475,"metadata":{"github-id":"IC_kwDODBZtRc5LnI6G","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1268551302"},"message":"Currently, `created` is the only field that `/versions/` can be ordered by.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1664981586,"metadata":{"github-id":"IC_kwDODBZtRc5LnJek","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1268553636"},"message":"@mvandenburgh I'm passing `?order=-created` to the `/versions/` endpoint, yet I'm still getting the draft version back as the first (in response order) \"Published\" version.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1664981920,"metadata":{"github-id":"IC_kwDODBZtRc5LnLLE","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1268560580"},"message":"@mvandenburgh Also, question: It's my understanding that, currently, any previously-published version can be \"published again\" by POSTing to `/dandisets/:id/versions/:id/publish/`.  Is that still the case?  If yes, then shouldn't the proper workflow involve querying the `/info/` endpoint for the re-published version instead of always using `draft`?  Or is `draft` now the only version that can be published?","files":null},{"type":3,"author":{"id":"c3aba9547dfec2aff2928d9a69b39673172a76a7"},"timestamp":1664982522,"metadata":{"github-id":"IC_kwDODBZtRc5LnO78","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1268575996"},"message":"\u003e @mvandenburgh Also, question: It's my understanding that, currently, any previously-published version can be \"published again\" by POSTing to `/dandisets/:id/versions/:id/publish/`. Is that still the case? If yes, then shouldn't the proper workflow involve querying the `/info/` endpoint for the re-published version instead of always using `draft`? Or is `draft` now the only version that can be published?\n\n`draft` is, and to my knowledge has always been, the only version that can be published. POSTing to `/dandisets/:id/versions/:id/publish/` for a non-`draft` version will always result in a 400 error. \n\n\u003e @mvandenburgh I'm passing ?order=-created to the /versions/ endpoint, yet I'm still getting the draft version back as the first (in response order) \"Published\" version.\n\nAre you trying that against the production/staging instance, or a local instance of https://github.com/dandi/dandi-archive/pull/1006? The changes haven't been merged in yet due to the failing CLI integration tests; I can issue a staging release if you'd like.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1664982664,"metadata":{"github-id":"IC_kwDODBZtRc5LnPpE","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1268578884"},"message":"@mvandenburgh I'm trying against a Dockerized instance of (what should be) the latest master commit of dandi-archive.  I was under the impression that the `?order` change had been merged separately and that this change in workflow should be backwards-compatible with the pre-1006 Archive.","files":null},{"type":6,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1664982676,"metadata":{"github-id":"UCE_lALODBZtRc5LnPpEzigHFQg"},"target":"c7939f1f23731169a52e0b115eb06744a0d6ef39bae1a3296d4ec2ad086aa2c8","message":"@mvandenburgh I'm trying against a Dockerized instance of (what should be) the latest master commit of dandi-archive.  I was under the impression that the `?order` change had been merged separately and that the change in workflow for 1006 should be backwards-compatible with the pre-1006 Archive.","files":null},{"type":6,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1664982686,"metadata":{"github-id":"UCE_lALODBZtRc5LnPpEzigHFYA"},"target":"c7939f1f23731169a52e0b115eb06744a0d6ef39bae1a3296d4ec2ad086aa2c8","message":"@mvandenburgh I'm trying against a Dockerized instance of (what should be) the latest master commit of dandi-archive.  I was under the impression that the `?order` change had been merged separately and that the change in the CLI's workflow for 1006 should be backwards-compatible with the pre-1006 Archive.","files":null},{"type":3,"author":{"id":"c3aba9547dfec2aff2928d9a69b39673172a76a7"},"timestamp":1664983029,"metadata":{"github-id":"IC_kwDODBZtRc5LnRUV","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1268585749"},"message":"Ah, I think I understand - are you saying there are other versions returned before it, but the draft version is the first with a status of `Publishing`? i.e. the ones before it have different values for `status`?","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1664983248,"metadata":{"github-id":"IC_kwDODBZtRc5LnSXc","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1268590044"},"message":"@yarikoptic Yes.  When testing on a fresh Dandiset, there is one published version before \"draft\", and it has a status of \"Valid\".","files":null},{"type":6,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1664983449,"metadata":{"github-id":"UCE_lALODBZtRc5LnSXczigHNj8"},"target":"be48b786687f3394cf7cf6672d58fea85127de81efbd668d9c4b4ff771b95885","message":"@yarikoptic Yes.  When testing publishing on a fresh Dandiset, there is one published version before \"draft\", and it has a status of \"Valid\".","files":null},{"type":3,"author":{"id":"c3aba9547dfec2aff2928d9a69b39673172a76a7"},"timestamp":1664983691,"metadata":{"github-id":"IC_kwDODBZtRc5LnUJW","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1268597334"},"message":"Ok great, that is the intended behavior. Any non-`draft` version is implicitly a \"published\" version; the `Published` status on the `draft` dandiset is simply saying that _that draft version has been published_; in other words, a published version of that `draft` version exists. So, I think the workflow for the CLI would be something like\n\n1) Hit `https://api-staging.dandiarchive.org/api/dandisets/\u003cid\u003e/versions/?order=created` (note there's no `-` in front of `created`); the first version returned here is guaranteed to be the `draft` version. Poll that endpoint until the `draft` version's `status` is `Published`.\n2) Once the `draft` version's `status` is `Published`, hit `https://api-staging.dandiarchive.org/api/dandisets/\u003cid\u003e/versions/?order=-created` (note the `-` to indicate descending order). The first version returned here is guaranteed to be the most recently created version; since the `draft` version's status is `Published`, the first version is guaranteed to be the most recently published.","files":null},{"type":6,"author":{"id":"c3aba9547dfec2aff2928d9a69b39673172a76a7"},"timestamp":1664983730,"metadata":{"github-id":"UCE_lALODBZtRc5LnUJWzigHQb0"},"target":"3c61fbdca80b4f43f0f8289900b0b7c435b980a70ea0ea23c88cd32f7023337e","message":"Ok great, that is the intended behavior. Any non-`draft` version is implicitly a \"published\" version; the `Published` status on the `draft` dandiset is simply saying that _that draft version has been published_; in other words, a published version of that `draft` version exists. So, I think the workflow for the CLI would be something like\n\n1) Hit `/api/dandisets/\u003cid\u003e/versions/?order=created` (note there's no `-` in front of `created`); the first version returned here is guaranteed to be the `draft` version. Poll that endpoint until the `draft` version's `status` is `Published`.\n2) Once the `draft` version's `status` is `Published`, hit `/api/dandisets/\u003cid\u003e/versions/?order=-created` (note the `-` to indicate descending order). The first version returned here is guaranteed to be the most recently created version; since the `draft` version's status is `Published`, the first version is guaranteed to be the most recently published.","files":null},{"type":6,"author":{"id":"c3aba9547dfec2aff2928d9a69b39673172a76a7"},"timestamp":1664983759,"metadata":{"github-id":"UCE_lALODBZtRc5LnUJWzigHQt4"},"target":"3c61fbdca80b4f43f0f8289900b0b7c435b980a70ea0ea23c88cd32f7023337e","message":"Ok great, that is the intended behavior. Any non-`draft` version is implicitly a \"published\" version; the `Published` status on the `draft` dandiset is simply saying that _that draft version has been published_; in other words, a published version of that `draft` version exists. So, I think the workflow for the CLI would be something like\n\n1) Hit `/api/dandisets/\u003cid\u003e/versions/?order=created` (note there's no `-` in front of `created`); the first version returned here is guaranteed to be the `draft` version. Poll that endpoint until the `draft` version's `status` is `Published`.\n2) Once the `draft` version's `status` is `Published`, hit `/api/dandisets/\u003cid\u003e/versions/?order=-created` (note the `-` to indicate descending order). The first version returned here is guaranteed to be the most recently created version; and since the `draft` version's status is `Published`, that first version is also guaranteed to be the most recently published.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1664983864,"metadata":{"github-id":"IC_kwDODBZtRc5LnUyH","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1268599943"},"message":"@mvandenburgh\n* For step 1, why not just poll `/api/dandisets/\u003cid\u003e/versions/draft/info/` as you stated [here](https://github.com/dandi/dandi-archive/pull/1006#issuecomment-1261438525)?\n* For step 2, should any filtering be done (before or after 1006 is merged) on the versions' status fields?","files":null},{"type":3,"author":{"id":"c3aba9547dfec2aff2928d9a69b39673172a76a7"},"timestamp":1664984203,"metadata":{"github-id":"IC_kwDODBZtRc5LnWEj","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1268605219"},"message":"\u003e For step 1, why not just poll /api/dandisets/\u003cid\u003e/versions/draft/info/ as you stated https://github.com/dandi/dandi-archive/pull/1006#issuecomment-1261438525?\n\nThat's also possible, and I agree that's a cleaner way to go about it. I had the `/versions/` on my mind so I thought of that when writing that, but technically either way should work.\n\n\u003e For step 2, should any filtering be done (before or after 1006 is merged) on the versions' status fields?\n\nWhat sort of filtering are you referring to?","files":null},{"type":6,"author":{"id":"c3aba9547dfec2aff2928d9a69b39673172a76a7"},"timestamp":1664984212,"metadata":{"github-id":"UCE_lALODBZtRc5LnWEjzigHU5U"},"target":"cc85c0d6474bfc33f549463ba159a23aeb4189777959f1f158c7bc6a48d93705","message":"\u003e For step 1, why not just poll /api/dandisets/\u003cid\u003e/versions/draft/info/ as you stated https://github.com/dandi/dandi-archive/pull/1006#issuecomment-1261438525?\n\nThat's also possible, and I agree that's a cleaner way to go about it. I had the `/versions/` endpoint on my mind so I thought of that when writing that, but technically either way should work.\n\n\u003e For step 2, should any filtering be done (before or after 1006 is merged) on the versions' status fields?\n\nWhat sort of filtering are you referring to?","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1664984383,"metadata":{"github-id":"IC_kwDODBZtRc5LnWvo","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1268607976"},"message":"@mvandenburgh \n\n\u003e What sort of filtering are you referring to?\n\nWell, [your original description of the workflow](https://github.com/dandi/dandi-archive/pull/1006#issuecomment-1261438525) says \"the first version with a status of `\"PUBLISHED\"` in that response is guaranteed to be the most recently published version\", implying that versions with different statuses should be discarded.  Is that still the case, either before or after 1006 is merged?","files":null},{"type":3,"author":{"id":"c3aba9547dfec2aff2928d9a69b39673172a76a7"},"timestamp":1664984757,"metadata":{"github-id":"IC_kwDODBZtRc5LnYFQ","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1268613456"},"message":"\u003e @mvandenburgh\n\u003e \n\u003e \u003e What sort of filtering are you referring to?\n\u003e \n\u003e Well, [your original description of the workflow](https://github.com/dandi/dandi-archive/pull/1006#issuecomment-1261438525) says \"the first version with a status of `\"PUBLISHED\"` in that response is guaranteed to be the most recently published version\", implying that versions with different statuses should be discarded. Is that still the case, either before or after 1006 is merged?\n\nApologies, that was a mistake, I've update the original comment. Versions with different statuses should not be discarded; if the `draft` version has a status of `Published`, then the first version returned by `/versions/?order=-created` is guaranteed to be the most recently published version, regardless of what its status is.","files":null},{"type":4,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1665071761,"metadata":{"github-id":"CE_lADODBZtRc5S3BSGzwAAAAHBNbId"},"status":2},{"type":3,"author":{"id":"7a8552494914d3e4116f4b434eb4812a914ca405"},"timestamp":1665071889,"metadata":{"github-id":"IC_kwDODBZtRc5Lt5Be","github-url":"https://github.com/dandi/dandi-cli/issues/1119#issuecomment-1270321246"},"message":"\u003c!-- GITHUB_RELEASE COMMENT: released --\u003e\n:rocket: Issue was released in [`0.46.4`](https://github.com/dandi/dandi-cli/releases/tag/0.46.4) :rocket:","files":null},{"type":5,"author":{"id":"7a8552494914d3e4116f4b434eb4812a914ca405"},"timestamp":1665071890,"metadata":{"github-id":"LE_lADODBZtRc5S3BSGzwAAAAHBNgTE"},"added":["released"],"removed":[]}]}