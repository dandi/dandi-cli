{"version":2,"ops":[{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1706194951,"metadata":{"github-id":"IC_kwDODBZtRc5x3jIM","github-url":"https://github.com/dandi/dandi-cli/issues/1394#issuecomment-1910387212"},"message":"since it doesn't fail for us here -- would be for you to figure out I am afraid.  I usually do something like (didn't test -- just typing but you will get the idea)\n\n```\nmkdir evilmods\necho \"raise ImportError('gotcha')\" \u003e| evilmods/numpy.py\nPYTHONPATH=$PWD/evilmods:$PYTHONPATH python -c \"import dandi.cli.command\"\n```\nand look at traceback on what imports that numpy and how come... e.g. do you patch anything?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1706714699,"metadata":{"github-id":"IC_kwDODBZtRc5yZq8a","github-url":"https://github.com/dandi/dandi-cli/issues/1394#issuecomment-1919332122"},"message":"@TheChymera ping on this so we know how to proceed on this one","files":null},{"type":3,"author":{"id":"0ab0e40999605aa8d5ec6be68372511fdc4a2fdf"},"timestamp":1706816297,"metadata":{"github-id":"IC_kwDODBZtRc5ykMrC","github-url":"https://github.com/dandi/dandi-cli/issues/1394#issuecomment-1922091714"},"message":"@yarikoptic haven't figured out what's happening yet, don't close it yet.","files":null},{"type":6,"author":{"id":"0ab0e40999605aa8d5ec6be68372511fdc4a2fdf"},"timestamp":1706816307,"metadata":{"github-id":"UCE_lALODBZtRc5ykMrCzj9IWLk"},"target":"c45d3871d661069e796c47136ec22fb3eda528712a03a833de1771d1e513d0c7","message":"@yarikoptic haven't figured out what's happening yet, don't close it.","files":null},{"type":3,"author":{"id":"0ab0e40999605aa8d5ec6be68372511fdc4a2fdf"},"timestamp":1707405337,"metadata":{"github-id":"IC_kwDODBZtRc5zS5gG","github-url":"https://github.com/dandi/dandi-cli/issues/1394#issuecomment-1934333958"},"message":"```\n[deco]~/src/dandi-cli ‚ù± mkdir evilmods\n[deco]~/src/dandi-cli ‚ù± echo \"raise ImportError('gotcha')\" \u003e| evilmods/numpy.py\n[deco]~/src/dandi-cli ‚ù± PYTHONPATH=$PWD/evilmods:$PYTHONPATH python -c \"import dandi.cli.command\"\nTraceback (most recent call last):\n  File \"\u003cstring\u003e\", line 1, in \u003cmodule\u003e\n  File \"/home/chymera/src/dandi-cli/dandi/cli/command.py\", line 143, in \u003cmodule\u003e\n    from .cmd_download import download  # noqa: E402\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/chymera/src/dandi-cli/dandi/cli/cmd_download.py\", line 10, in \u003cmodule\u003e\n    from ..dandiset import Dandiset\n  File \"/home/chymera/src/dandi-cli/dandi/dandiset.py\", line 14, in \u003cmodule\u003e\n    from .files import DandisetMetadataFile, LocalAsset, dandi_file, find_dandi_files\n  File \"/home/chymera/src/dandi-cli/dandi/files/__init__.py\", line 23, in \u003cmodule\u003e\n    from ._private import BIDSFileFactory, DandiFileFactory\n  File \"/home/chymera/src/dandi-cli/dandi/files/_private.py\", line 18, in \u003cmodule\u003e\n    from .bids import (\n  File \"/home/chymera/src/dandi-cli/dandi/files/bids.py\", line 14, in \u003cmodule\u003e\n    from .zarr import ZarrAsset\n  File \"/home/chymera/src/dandi-cli/dandi/files/zarr.py\", line 17, in \u003cmodule\u003e\n    from zarr_checksum.tree import ZarrChecksumTree\n  File \"/usr/lib/python3.11/site-packages/zarr_checksum/__init__.py\", line 4, in \u003cmodule\u003e\n    from zarr_checksum.generators import FileGenerator\n  File \"/usr/lib/python3.11/site-packages/zarr_checksum/generators.py\", line 12, in \u003cmodule\u003e\n    from zarr.storage import NestedDirectoryStore\n  File \"/usr/lib/python3.11/site-packages/zarr/__init__.py\", line 2, in \u003cmodule\u003e\n    from zarr.codecs import *\n  File \"/usr/lib/python3.11/site-packages/zarr/codecs.py\", line 2, in \u003cmodule\u003e\n    from numcodecs import *\n  File \"/usr/lib/python3.11/site-packages/numcodecs/__init__.py\", line 27, in \u003cmodule\u003e\n    from numcodecs.zlib import Zlib\n  File \"/usr/lib/python3.11/site-packages/numcodecs/zlib.py\", line 5, in \u003cmodule\u003e\n    from .compat import ndarray_copy, ensure_contiguous_ndarray\n  File \"/usr/lib/python3.11/site-packages/numcodecs/compat.py\", line 8, in \u003cmodule\u003e\n    import numpy as np\n  File \"/home/chymera/src/dandi-cli/evilmods/numpy.py\", line 1, in \u003cmodule\u003e\n    raise ImportError('gotcha')\nImportError: gotcha\n```\n\nIt seems to be numcodecs which ultimately triggers this. \n\nThe import is here ‚Üí https://github.com/zarr-developers/numcodecs/blob/0878717a3613d91a453fe3d3716aa9c67c023a8b/numcodecs/compat.py#L8 and all the imports that lead to it are at the top of their respective modules, not under if statements. So now I'm wondering why this doesn't trigger for anybody else ü§î","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1707406353,"metadata":{"github-id":"IC_kwDODBZtRc5zTElH","github-url":"https://github.com/dandi/dandi-cli/issues/1394#issuecomment-1934379335"},"message":"zarr_checksum is kinda the lead of the show here -- and I think whenever \n- https://github.com/dandi/zarr_checksum/pull/39 (merged already) \n\ngets released - might self-resolve. But I am surprised (although didn't look in detail) that testing here doesn't pick it up.  I guess for now for your gentoo package you could just skip that test","files":null},{"type":3,"author":{"id":"0ab0e40999605aa8d5ec6be68372511fdc4a2fdf"},"timestamp":1707407120,"metadata":{"github-id":"IC_kwDODBZtRc5zTK4a","github-url":"https://github.com/dandi/dandi-cli/issues/1394#issuecomment-1934405146"},"message":"@yarikoptic \n\n\u003e  I guess for now for your gentoo package you could just skip that test\n\nOh yes, I already did that after I filed and referenced the issue. Just wanted to fix this now that I stumbled on it, but I guess it can wait...","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1721326391,"metadata":{"github-id":"IC_kwDODBZtRc6FWP58","github-url":"https://github.com/dandi/dandi-cli/issues/1394#issuecomment-2237202044"},"message":"I believe that PR mentioned above was released in 0.4.0 \n- although there is no tag: https://github.com/dandi/zarr_checksum/issues/40\n\n@TheChymera does issue still persist for you?","files":null},{"type":5,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1727465151,"metadata":{"github-id":"LE_lADODBZtRc59Jtl4zwAAAANcaqB3"},"added":["tests"],"removed":[]},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1727465198,"metadata":{"github-id":"IC_kwDODBZtRc6N2rmm","github-url":"https://github.com/dandi/dandi-cli/issues/1394#issuecomment-2379921830"},"message":"haven't heard back, let's assume the answer is \"no\"","files":null},{"type":4,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1727465198,"metadata":{"github-id":"CE_lADODBZtRc59Jtl4zwAAAANcarpj"},"status":2}]}