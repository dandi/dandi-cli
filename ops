{"version":2,"ops":[{"type":1,"author":{"id":"3217666bda2431aa8fe32869bbe258730f97360c"},"timestamp":1680727902,"metadata":{"github-id":"I_kwDODBZtRc5iuM3_","github-url":"https://github.com/dandi/dandi-cli/issues/1270","origin":"github"},"title":"Metadata / validation not caught before attempting to upload","message":"I am getting a sequence of error when some metadata is missing : \n\n(nwb) jerome.lecoq@OSXLTCYGQCV upload % nwbinspector ./to_upload --config dandi \n                                                                                                                                     \n\n**************************************************\nNWBInspector Report Summary\n\nTimestamp: 2023-04-05 13:50:51.651946-07:00\nPlatform: macOS-12.6.3-arm64-arm-64bit\nNWBInspector version: 0.4.26\n\nFound 17 issues over 1 files:\n       2 - BEST_PRACTICE_VIOLATION\n      15 - BEST_PRACTICE_SUGGESTION\n**************************************************\n\n\n0  BEST_PRACTICE_VIOLATION\n==========================\n\n0.0  to_upload/Rorb-IRES2-Cre_590168381_590168385.nwb: check_index_series_points_to_image - 'IndexSeries' object at location '/stimulus/presentation/natural_movie_three_stimulus'\n       Message: Pointing an IndexSeries to a TimeSeries will be deprecated. Please point to an Images container instead.\n\n0.1  to_upload/Rorb-IRES2-Cre_590168381_590168385.nwb: check_index_series_points_to_image - 'IndexSeries' object at location '/stimulus/presentation/natural_movie_one_stimulus'\n       Message: Pointing an IndexSeries to a TimeSeries will be deprecated. Please point to an Images container instead.\n\n1  BEST_PRACTICE_SUGGESTION\n===========================\n\n1.2  to_upload/Rorb-IRES2-Cre_590168381_590168385.nwb: check_description - 'Device' object at location '/general/devices/eye-tracking camera'\n       Message: Description is missing.\n\n1.3  to_upload/Rorb-IRES2-Cre_590168381_590168385.nwb: check_description - 'Device' object at location '/general/devices/display monitor'\n       Message: Description is missing.\n\n1.4  to_upload/Rorb-IRES2-Cre_590168381_590168385.nwb: check_description - 'Device' object at location '/general/devices/Microscope'\n       Message: Description is missing.\n\n1.5  to_upload/Rorb-IRES2-Cre_590168381_590168385.nwb: check_description - 'Device' object at location '/general/devices/2-photon microscope'\n       Message: Description is missing.\n\n1.6  to_upload/Rorb-IRES2-Cre_590168381_590168385.nwb: check_description - 'Images' object with name 'SegmentationImages'\n       Message: Description ('no description') is a placeholder.\n\n1.7  to_upload/Rorb-IRES2-Cre_590168381_590168385.nwb: check_description - 'GrayscaleImage' object with name 'mean'\n       Message: Description is missing.\n\n1.8  to_upload/Rorb-IRES2-Cre_590168381_590168385.nwb: check_description - 'GrayscaleImage' object with name 'correlation'\n       Message: Description is missing.\n\n1.9  to_upload/Rorb-IRES2-Cre_590168381_590168385.nwb: check_small_dataset_compression - 'OpticalSeries' object at location '/stimulus/templates/natural_movie_three_image_stack'\n       Message: data is not compressed. Consider enabling compression when writing a dataset.\n\n1.10  to_upload/Rorb-IRES2-Cre_590168381_590168385.nwb: check_small_dataset_compression - 'OpticalSeries' object at location '/stimulus/templates/natural_movie_one_image_stack'\n        Message: data is not compressed. Consider enabling compression when writing a dataset.\n\n1.11  to_upload/Rorb-IRES2-Cre_590168381_590168385.nwb: check_experimenter_exists - 'NWBFile' object at location '/'\n        Message: Experimenter is missing.\n\n1.12  to_upload/Rorb-IRES2-Cre_590168381_590168385.nwb: check_experiment_description - 'NWBFile' object at location '/'\n        Message: Experiment description is missing.\n\n1.13  to_upload/Rorb-IRES2-Cre_590168381_590168385.nwb: check_keywords - 'NWBFile' object at location '/'\n        Message: Metadata /general/keywords is missing.\n\n1.14  to_upload/Rorb-IRES2-Cre_590168381_590168385.nwb: check_column_binary_capability - 'TimeIntervals' object with name 'trials'\n        Message: Column 'blank_sweep' uses 'float32' but has binary values [0. 1.]. Consider making it boolean instead and renaming the column to start with 'is_'; doing so will save 1.88KB.\n\n1.15  to_upload/Rorb-IRES2-Cre_590168381_590168385.nwb: check_column_binary_capability - 'PlaneSegmentation' object with name 'PlaneSegmentation'\n        Message: Column 'Accepted' uses 'integers' but has binary values [0 1]. Consider making it boolean instead and renaming the column to start with 'is_'; doing so will save 13.02KB.\n\n1.16  to_upload/Rorb-IRES2-Cre_590168381_590168385.nwb: check_column_binary_capability - 'PlaneSegmentation' object with name 'PlaneSegmentation'\n        Message: Column 'Rejected' uses 'integers' but has binary values [0 1]. Consider making it boolean instead and renaming the column to start with 'is_'; doing so will save 13.02KB.\n\n(nwb) jerome.lecoq@OSXLTCYGQCV upload % cd 000459                               \n(nwb) jerome.lecoq@OSXLTCYGQCV 000459 % dandi organize ../to_upload             \n2023-04-05 13:51:11,061 [ WARNING] A newer version (0.52.0) of dandi/dandi-cli is available. You are using 0.51.0\n2023-04-05 13:51:11,490 [    INFO] NumExpr defaulting to 8 threads.\n2023-04-05 13:51:12,251 [    INFO] Loading metadata from 1 files\n[Parallel(n_jobs=-1)]: Using backend LokyBackend with 8 concurrent workers.\n[Parallel(n_jobs=-1)]: Done   1 tasks      | elapsed:    2.6s\n[Parallel(n_jobs=-1)]: Done   1 out of   1 | elapsed:    2.6s finished\n2023-04-05 13:51:14,851 [ WARNING] Completely empty record for ../to_upload/Rorb-IRES2-Cre_590168381_590168385.nwb\n2023-04-05 13:51:14,851 [    INFO] Logs saved in /Users/jerome.lecoq/Library/Logs/dandi-cli/20230405205110Z-75206.log\nError: 1 out of 1 files were found not containing all necessary metadata: ../to_upload/Rorb-IRES2-Cre_590168381_590168385.nwb","files":null}]}