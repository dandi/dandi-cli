{"version":2,"ops":[{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1613500442,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdElzc3VlRWRpdDo0OTQ2NDk0NzM="},"target":"9e0c0d53c2589d3f618c28e766e9fbcfaf742e6f4ec99ec7905fb5c91adb54f3","message":"Inspired by the necessity of #388.\n\nI initially had reservations about that but I think it should be ok - we can always disable caching using `DANDI_CACHE` to troubleshoot etc.    I guess we just need a helper function \n\n```\n@checksums.cache\ndef get_digest(filepath, digest=['sha256']):\n    return  Digester([digest])(filepath)[digest]\n```\n?\n\nthat should help significantly rerunning `upload` on files.\n\nIf we cached the checksum, we could call it even twice (in context of #388) and actually take advantage of that -- if checksum changes from one point to another during upload - we have an good indication that user is trying to upload a file which is still being modified.  WDYT @jwodder  ?","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1613500454,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdElzc3VlRWRpdDo0OTQ2NDk1NzI="},"target":"9e0c0d53c2589d3f618c28e766e9fbcfaf742e6f4ec99ec7905fb5c91adb54f3","message":"Inspired by the necessity of #388.\n\nI initially had reservations about that but I think it should be ok - we can always disable caching using `DANDI_CACHE` to troubleshoot etc.    I guess we just need a helper function \n\n```python\n@checksums.cache\ndef get_digest(filepath, digest='sha256'):\n    return  Digester([digest])(filepath)[digest]\n```\n?\n\nthat should help significantly rerunning `upload` on files.\n\nIf we cached the checksum, we could call it even twice (in context of #388) and actually take advantage of that -- if checksum changes from one point to another during upload - we have an good indication that user is trying to upload a file which is still being modified.  WDYT @jwodder  ?","files":null},{"type":5,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1613500425,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDQzMzc2ODg1OTI="},"added":["enhancement"],"removed":[]},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1613503668,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDc4MDA2NTU3NA==","github-url":"https://github.com/dandi/dandi-cli/issues/389#issuecomment-780065574"},"message":"@yarikoptic - can you at least add mtime to the function signature, so that it would recompute if local mtime has changed?","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1613503863,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDc4MDA2NzMwOA==","github-url":"https://github.com/dandi/dandi-cli/issues/389#issuecomment-780067308"},"message":"@satra mtime is already used by `dandi.support.cache.PersistentCache` for cache-breaking.","files":null},{"type":4,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1613505405,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50NDMzODAxMTA4Mg=="},"status":2}]}