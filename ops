{"version":2,"ops":[{"type":1,"author":{"id":"818a29386a430d42cbb57ad6dcccbe0fb486ffc3"},"timestamp":1606949522,"metadata":{"github-id":"MDU6SXNzdWU3NTU2NjkyNTM=","github-url":"https://github.com/dandi/dandi-cli/issues/300","origin":"github"},"title":"Download minio data in celery container","message":"When the `celery` service needs to communicate with other services (specifically `minio`), it needs to address them directly by service name like `http://minio:9000/whatever` instead of `http://localhost:9000/whatever`. When generating the URL to download the data for validation, it looks something like `http://localhost:9000/dandi-dandisets/test.txt?X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=minioAccessKey%2F20201202%2Fus-east-1%2Fs3%2Faws4_request\u0026X-Amz-Date=20201202T223646Z\u0026X-Amz-Expires=604800\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=6ba8022bd45a5e9242c71adc891f3f724a4ac4ac1f83ed7b2f221f00d9ced7ec`. This is arguably correct, because this link works correctly from outside the containers. When the `celery` service tries to use that URL however, it does not know to associate `localhost` with the `minio` service, so it just fails. \n\n\n_Originally posted by @dchiquit in https://github.com/dandi/dandi-cli/issues/277#issuecomment-737543809_","files":null}]}