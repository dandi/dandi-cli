{"version":2,"ops":[{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1647962796,"metadata":{"github-id":"UCE_lAHODBZtRc5GFjw7zit7V34"},"target":"956f29f8173762c205376cf09988d782eb34a75fda9d4823d0f10a72f7b739a6","message":"Currently `validate` is just collecting a list of string error representations.  As @CodyCBakerPhD mentions in https://github.com/dandi/dandi-cli/pull/941/files#r830671373 , nwbinspector provides more informative result records with contextual information about the error etc.\n\nSimilarly for BIDS validation being added in #896 error messages are also serialized/simplified, although stock `bids-validator` has quite an extensive registry of warnings/errors: [google spreadsheet](https://docs.google.com/spreadsheets/d/181vtw2bt2nHcUgw__G_gFSkKGyuxOxUNr5wHrZXY_uI/edit?usp=sharing)\n\nLooking forward we should establish a ValidationResult data type/class/record which would be expressive to cover validation results from various validators.  I foresee it to also reflect the \"source\" of the validation result, so overall should have (more to be filled out later on; yet to look at what nwbinspector provides):\n\n- origin: what produced this validation result\n  - `name: str` , `{\"pynwb.load\", \"pynwb.validate\", \"nwbinspector\", \"dandischema\"}`\n  - `version: str` -- version of the tool producing the result, e.g. `\"0.3.1\"`\n- `severity: {'ERROR', 'WARNING', 'HINT'}`  -- for now just reflecting \n- `id: str` (or `id: list`?) -- identifier of that particular type of result. For BIDS could be its Key or numeric ID. Providing a unique string ID like BIDS does quite nice since gives immediate summary in its name \n- `scope: {'file', 'dandiset'}` -- either it is\n- `path: str` - path to file or folder/dandiset which triggered the error\n- `message: str` - it would be the \"Reason\" of BIDS or a string interpolation of nwbinspector record?","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1647963095,"metadata":{"github-id":"UCE_lAHODBZtRc5GFjw7zit7a30"},"target":"956f29f8173762c205376cf09988d782eb34a75fda9d4823d0f10a72f7b739a6","message":"Currently `validate` is just collecting a list of string error representations.  As @CodyCBakerPhD mentions in https://github.com/dandi/dandi-cli/pull/941/files#r830671373 , nwbinspector provides more informative result records with contextual information about the error etc.\n\nSimilarly for BIDS validation being added in #896 error messages are also serialized/simplified, although stock `bids-validator` has quite an extensive registry of warnings/errors: [google spreadsheet](https://docs.google.com/spreadsheets/d/181vtw2bt2nHcUgw__G_gFSkKGyuxOxUNr5wHrZXY_uI/edit?usp=sharing)\n\nLooking forward we should establish a ValidationResult data type/class/record which would be expressive to cover validation results from various validators.  I foresee it to also reflect the \"source\" of the validation result, so overall should have (more to be filled out later on; yet to look at what nwbinspector provides):\n\n- origin: what produced this validation result\n  - `name: str` , `{\"pynwb.load\", \"pynwb.validate\", \"nwbinspector\", \"dandischema\"}`\n  - `version: str` -- version of the tool producing the result, e.g. `\"0.3.1\"`\n- `severity: {'ERROR', 'WARNING', 'HINT'}`  -- for now just reflecting \n- `id: str` (or `id: list`?) -- identifier of that particular type of result. For BIDS could be its Key or numeric ID. Providing a unique string ID like BIDS does quite nice since gives immediate summary in its name \n- `scope: {'file', 'dandiset'}` -- either it is\n- `path: str` - path to file or folder/dandiset which triggered the error\n- `message: str` - it would be the \"Reason\" of BIDS or a string interpolation of nwbinspector record?\n\n### Use\n\n- `dandi validate` should gain `--severity=HINT,WARNING,ERROR` switch to provide minimal level for what to include in the report\n- `dandi upload` should use validate with `severity='ERROR'` thus only allowing for uploads without errors but possibly which would trigger WARNINGs and any other lower level problems","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1648754877,"metadata":{"github-id":"UCE_lAHODBZtRc5GFjw7zivujag"},"target":"956f29f8173762c205376cf09988d782eb34a75fda9d4823d0f10a72f7b739a6","message":"Currently `validate` is just collecting a list of string error representations.  As @CodyCBakerPhD mentions in https://github.com/dandi/dandi-cli/pull/941/files#r830671373 , nwbinspector provides more informative result records with contextual information about the error etc.\n\nSimilarly for BIDS validation being added in #896 error messages are also serialized/simplified, although stock `bids-validator` has quite an extensive registry of warnings/errors: [google spreadsheet](https://docs.google.com/spreadsheets/d/181vtw2bt2nHcUgw__G_gFSkKGyuxOxUNr5wHrZXY_uI/edit?usp=sharing)\n\nLooking forward we should establish a ValidationResult data type/class/record which would be expressive to cover validation results from various validators.  I foresee it to also reflect the \"source\" of the validation result, so overall should have (more to be filled out later on; yet to look at what nwbinspector provides):\n\n- origin: what produced this validation result\n  - `name: str` , `{\"pynwb.load\", \"pynwb.validate\", \"nwbinspector\", \"dandischema\"}`\n  - `version: str` -- version of the tool producing the result, e.g. `\"0.3.1\"`\n- `severity: {'ERROR', 'WARNING', 'HINT'}`  -- for now just reflecting \n- `id: str` (or `id: list`?) -- identifier of that particular type of result. For BIDS could be its Key or numeric ID. Providing a unique string ID like BIDS does quite nice since gives immediate summary in its name \n- `scope: {'file', 'dandiset'}` -- either it is\n- `path: str` - path to file or folder/dandiset which triggered the error\n- `message: str` - it would be the \"Reason\" of BIDS or a string interpolation of nwbinspector record?\n\n### Use\n\n- `dandi validate` should gain `--severity=HINT,WARNING,ERROR` switch to provide minimal level for what to include in the report\n- `dandi upload` should use validate with `severity='ERROR'` thus only allowing for uploads without errors but possibly which would trigger WARNINGs and any other lower level problems \n\nedit:\n- here is what @nellh has for data structures to encapsulate in schema-based bids-validator: https://github.com/bids-standard/bids-validator/pull/1413/files#diff-3e29891088bc511ec972c5b36dcb579d59db3552fa69b3c882e065931d790664R6\n- @effigies also expressed some utopian idea -- if schema-based errors could point to specific BIDS schema file which instructed that particular structure, that would be useful; but to me it sounds like tricky to implement to make checks aware of original location of definitions in schema","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1648754983,"metadata":{"github-id":"UCE_lAHODBZtRc5GFjw7zivukoc"},"target":"956f29f8173762c205376cf09988d782eb34a75fda9d4823d0f10a72f7b739a6","message":"Currently `validate` is just collecting a list of string error representations.  As @CodyCBakerPhD mentions in https://github.com/dandi/dandi-cli/pull/941/files#r830671373 , nwbinspector provides more informative result records with contextual information about the error etc.\n\nSimilarly for BIDS validation being added in #896 error messages are also serialized/simplified, although stock `bids-validator` has quite an extensive registry of warnings/errors: [google spreadsheet](https://docs.google.com/spreadsheets/d/181vtw2bt2nHcUgw__G_gFSkKGyuxOxUNr5wHrZXY_uI/edit?usp=sharing)\n\nLooking forward we should establish a ValidationResult data type/class/record which would be expressive to cover validation results from various validators.  I foresee it to also reflect the \"source\" of the validation result, so overall should have (more to be filled out later on; yet to look at what nwbinspector provides):\n\n- origin: what produced this validation result\n  - `name: str` , `{\"pynwb.load\", \"pynwb.validate\", \"nwbinspector\", \"dandischema\"}`\n  - `version: str` -- version of the tool producing the result, e.g. `\"0.3.1\"`\n- `severity: {'ERROR', 'WARNING', 'HINT'}`  -- for now just reflecting \n- `id: str` (or `id: list`?) -- identifier of that particular type of result. For BIDS could be its Key or numeric ID. Providing a unique string ID like BIDS does quite nice since gives immediate summary in its name \n- `scope: {'file', 'dandiset'}` -- either it is\n- `path: str` - path to file or folder/dandiset which triggered the error\n- `message: str` - it would be the \"Reason\" of BIDS or a string interpolation of nwbinspector record?\n\n### Use\n\n- `dandi validate` should gain `--severity=HINT,WARNING,ERROR` switch to provide minimal level for what to include in the report\n- `dandi upload` should use validate with `severity='ERROR'` thus only allowing for uploads without errors but possibly which would trigger WARNINGs and any other lower level problems \n\nedits:\n- here is what @nellh has for data structures to encapsulate in schema-based bids-validator: https://github.com/bids-standard/bids-validator/pull/1413/files#diff-3e29891088bc511ec972c5b36dcb579d59db3552fa69b3c882e065931d790664R6\n- @effigies also expressed some utopian idea -- if schema-based errors could point to specific BIDS schema file which instructed that particular structure, that would be useful; but to me it sounds like tricky to implement to make checks aware of original location of definitions in schema","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1651247189,"metadata":{"github-id":"UCE_lAHODBZtRc5GFjw7zi1EgSo"},"target":"956f29f8173762c205376cf09988d782eb34a75fda9d4823d0f10a72f7b739a6","message":"Currently `validate` is just collecting a list of string error representations.  As @CodyCBakerPhD mentions in https://github.com/dandi/dandi-cli/pull/941/files#r830671373 , nwbinspector provides more informative result records with contextual information about the error etc.\n\nSimilarly for BIDS validation being added in #896 error messages are also serialized/simplified, although stock `bids-validator` has quite an extensive registry of warnings/errors: [google spreadsheet](https://docs.google.com/spreadsheets/d/181vtw2bt2nHcUgw__G_gFSkKGyuxOxUNr5wHrZXY_uI/edit?usp=sharing)\n\nLooking forward we should establish a ValidationResult data type/class/record which would be expressive to cover validation results from various validators.  I foresee it to also reflect the \"source\" of the validation result, so overall should have (more to be filled out later on; yet to look at what nwbinspector provides):\n\n- origin: what produced this validation result\n  - `name: str` , `{\"pynwb.load\", \"pynwb.validate\", \"nwbinspector\", \"dandischema\", \"dandi-bids\"}`\n  - `version: str` -- version of the tool producing the result, e.g. `\"0.3.1\"`\n- `severity: {'ERROR', 'WARNING', 'HINT'}`  -- for now just reflecting \n- `id: str` (or `id: list`?) -- identifier of that particular type of result. For BIDS could be its Key or numeric ID. Providing a unique string ID like BIDS does quite nice since gives immediate summary in its name \n- `scope: {'file', 'dandiset'}` -- either it is\n- `path: str` - path to file or folder/dataset (e.g. BIDS of dandiset) which triggered the error\n- `message: str` - it would be the \"Reason\" of BIDS or a string interpolation of nwbinspector record?\n\n### Use\n\n- `dandi validate` should gain `--severity=HINT,WARNING,ERROR` switch to provide minimal level for what to include in the report\n- `dandi upload` should use validate with `severity='ERROR'` thus only allowing for uploads without errors but possibly which would trigger WARNINGs and any other lower level problems \n\nedits:\n- here is what @nellh has for data structures to encapsulate in schema-based bids-validator: https://github.com/bids-standard/bids-validator/pull/1413/files#diff-3e29891088bc511ec972c5b36dcb579d59db3552fa69b3c882e065931d790664R6\n- @effigies also expressed some utopian idea -- if schema-based errors could point to specific BIDS schema file which instructed that particular structure, that would be useful; but to me it sounds like tricky to implement to make checks aware of original location of definitions in schema","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1651247326,"metadata":{"github-id":"UCE_lAHODBZtRc5GFjw7zi1EiBU"},"target":"956f29f8173762c205376cf09988d782eb34a75fda9d4823d0f10a72f7b739a6","message":"Currently `validate` is just collecting a list of string error representations.  As @CodyCBakerPhD mentions in https://github.com/dandi/dandi-cli/pull/941/files#r830671373 , nwbinspector provides more informative result records with contextual information about the error etc.\n\nSimilarly for BIDS validation being added in #896 error messages are also serialized/simplified, although stock `bids-validator` has quite an extensive registry of warnings/errors: [google spreadsheet](https://docs.google.com/spreadsheets/d/181vtw2bt2nHcUgw__G_gFSkKGyuxOxUNr5wHrZXY_uI/edit?usp=sharing)\n\nLooking forward we should establish a ValidationResult data type/class/record which would be expressive to cover validation results from various validators.  I foresee it to also reflect the \"source\" of the validation result, so overall should have (more to be filled out later on; yet to look at what nwbinspector provides):\n\n- origin: what produced this validation result\n  - `name: str` , `{\"pynwb.load\", \"pynwb.validate\", \"nwbinspector\", \"dandischema\", \"dandi-bids\"}`\n  - `version: str` -- version of the tool producing the result, e.g. `\"0.3.1\"`\n- `severity: {'ERROR', 'WARNING', 'HINT'}`  -- for now just reflecting \n- `id: str` (or `id: list`?) -- identifier of that particular type of result. For BIDS could be its Key or numeric ID. Providing a unique string ID like BIDS does quite nice since gives immediate summary in its name \n- `scope: {'file', 'dandiset'}` -- either it is\n- `path: str` - path to file or folder/dataset (e.g. BIDS of dandiset) which triggered the error\n- `message: str` - it would be the \"Reason\" of BIDS or a string interpolation of nwbinspector record?\n\n### Use\n\n- `dandi validate` should gain `--severity=HINT,WARNING,ERROR` switch to provide minimal level for what to include in the report\n- `dandi upload` should use validate with `severity='ERROR'` thus only allowing for uploads without errors but possibly which would trigger WARNINGs and any other lower level problems \n\nedits:\n- here is what @nellh has for data structures to encapsulate in schema-based bids-validator: https://github.com/bids-standard/bids-validator/pull/1413/files#diff-3e29891088bc511ec972c5b36dcb579d59db3552fa69b3c882e065931d790664R6\n- @effigies also expressed some utopian idea -- if schema-based errors could point to specific BIDS schema file which instructed that particular structure, that would be useful; but to me it sounds like tricky to implement to make checks aware of original location of definitions in schema \n- nwbinspector's `@dataclass` describing InspectorMessage: https://github.com/NeurodataWithoutBorders/nwbinspector/blob/dev/nwbinspector/register_checks.py#L38","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1651247595,"metadata":{"github-id":"UCE_lAHODBZtRc5GFjw7zi1ElUc"},"target":"956f29f8173762c205376cf09988d782eb34a75fda9d4823d0f10a72f7b739a6","message":"Currently `validate` is just collecting a list of string error representations.  As @CodyCBakerPhD mentions in https://github.com/dandi/dandi-cli/pull/941/files#r830671373 , nwbinspector provides more informative result records with contextual information about the error etc.\n\nSimilarly for BIDS validation being added in #896 error messages are also serialized/simplified, although stock `bids-validator` has quite an extensive registry of warnings/errors: [google spreadsheet](https://docs.google.com/spreadsheets/d/181vtw2bt2nHcUgw__G_gFSkKGyuxOxUNr5wHrZXY_uI/edit?usp=sharing)\n\nLooking forward we should establish a ValidationResult data type/class/record which would be expressive to cover validation results from various validators.  I foresee it to also reflect the \"source\" of the validation result, so overall should have (more to be filled out later on; yet to look at what nwbinspector provides):\n\n- `origin`: what produced this validation result\n  - `name: str` , `{\"pynwb.load\", \"pynwb.validate\", \"nwbinspector\", \"dandischema\", \"dandi-bids\"}`\n  - `version: str` -- version of the tool producing the result, e.g. `\"0.3.1\"`\n- `severity: {'ERROR', 'WARNING', 'HINT'}`  -- for now just reflecting \n- `id: str` (or `id: list`?) -- identifier of that particular type of result. For BIDS could be its Key or numeric ID. Providing a unique string ID like BIDS does quite nice since gives immediate summary in its name \n- `scope: {'file', 'dandiset'}` -- either it is\n- `path: str` - path to file or folder/dataset (e.g. BIDS of dandiset) which triggered the error\n- `message: str` - it would be the \"Reason\" of BIDS or a string interpolation of nwbinspector record?\n\n### Use\n\n- `dandi validate` should gain `--severity=HINT,WARNING,ERROR` switch to provide minimal level for what to include in the report\n- `dandi upload` should use validate with `severity='ERROR'` thus only allowing for uploads without errors but possibly which would trigger WARNINGs and any other lower level problems \n\nedits:\n- here is what @nellh has for data structures to encapsulate in schema-based bids-validator: https://github.com/bids-standard/bids-validator/pull/1413/files#diff-3e29891088bc511ec972c5b36dcb579d59db3552fa69b3c882e065931d790664R6\n- @effigies also expressed some utopian idea -- if schema-based errors could point to specific BIDS schema file which instructed that particular structure, that would be useful; but to me it sounds like tricky to implement to make checks aware of original location of definitions in schema \n- nwbinspector's `@dataclass` describing InspectorMessage: https://github.com/NeurodataWithoutBorders/nwbinspector/blob/dev/nwbinspector/register_checks.py#L38","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1651261369,"metadata":{"github-id":"UCE_lAHODBZtRc5GFjw7zi1G-Lg"},"target":"956f29f8173762c205376cf09988d782eb34a75fda9d4823d0f10a72f7b739a6","message":"Currently `validate` is just collecting a list of string error representations.  As @CodyCBakerPhD mentions in https://github.com/dandi/dandi-cli/pull/941/files#r830671373 , nwbinspector provides more informative result records with contextual information about the error etc.\n\nSimilarly for BIDS validation being added in #896 error messages are also serialized/simplified, although stock `bids-validator` has quite an extensive registry of warnings/errors: [google spreadsheet](https://docs.google.com/spreadsheets/d/181vtw2bt2nHcUgw__G_gFSkKGyuxOxUNr5wHrZXY_uI/edit?usp=sharing)\n\nLooking forward we should establish a ValidationResult data type/class/record which would be expressive to cover validation results from various validators.  I foresee it to also reflect the \"source\" of the validation result, so overall should have (more to be filled out later on; yet to look at what nwbinspector provides):\n\n- `origin`: what produced this validation result\n  - `name: str` , `{\"pynwb.load\", \"pynwb.validate\", \"nwbinspector\", \"dandischema\", \"dandi-bids\"}`\n  - `version: str` -- version of the tool producing the result, e.g. `\"0.3.1\"`\n- `severity: {'ERROR', 'WARNING', 'HINT'}`  -- for now just reflecting \n- `id: str` (or `id: list`?) -- identifier of that particular type of result. For BIDS could be its Key or numeric ID. Providing a unique string ID like BIDS does quite nice since gives immediate summary in its name \n- `scope: {'file', 'dandiset'}` -- either it is\n- `path: str` - path to file or folder/dataset (e.g. BIDS of dandiset) which triggered the error\n- `asset_paths: Optional[list[str]]` - defaults to `[.path]` if not defined. Otherwise - could point to an actual file (or collection of files) which are affected by a warning/error in the `.path`. E.g. `{\"path\": \"task-broken_bold.json\", \"asset_paths\": [\"sub-01/func/sub-01_task-broken_bold.json\", \"sub-02/func/sub-02_task-broken_bold.json\"]}`.\n- `message: str` - it would be the \"Reason\" of BIDS or a string interpolation of nwbinspector record?\n\n### Use\n\n- `dandi validate` should gain `--severity=HINT,WARNING,ERROR` switch to provide minimal level for what to include in the report\n- `dandi upload` should use validate with `severity='ERROR'` thus only allowing for uploads without errors but possibly which would trigger WARNINGs and any other lower level problems \n\nedits:\n- here is what @nellh has for data structures to encapsulate in schema-based bids-validator: https://github.com/bids-standard/bids-validator/pull/1413/files#diff-3e29891088bc511ec972c5b36dcb579d59db3552fa69b3c882e065931d790664R6\n- @effigies also expressed some utopian idea -- if schema-based errors could point to specific BIDS schema file which instructed that particular structure, that would be useful; but to me it sounds like tricky to implement to make checks aware of original location of definitions in schema \n- nwbinspector's `@dataclass` describing InspectorMessage: https://github.com/NeurodataWithoutBorders/nwbinspector/blob/dev/nwbinspector/register_checks.py#L38","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1651262312,"metadata":{"github-id":"UCE_lAHODBZtRc5GFjw7zi1HHwc"},"target":"956f29f8173762c205376cf09988d782eb34a75fda9d4823d0f10a72f7b739a6","message":"Currently `validate` is just collecting a list of string error representations.  As @CodyCBakerPhD mentions in https://github.com/dandi/dandi-cli/pull/941/files#r830671373 , nwbinspector provides more informative result records with contextual information about the error etc.\n\nSimilarly for BIDS validation being added in #896 error messages are also serialized/simplified, although stock `bids-validator` has quite an extensive registry of warnings/errors: [google spreadsheet](https://docs.google.com/spreadsheets/d/181vtw2bt2nHcUgw__G_gFSkKGyuxOxUNr5wHrZXY_uI/edit?usp=sharing)\n\nLooking forward we should establish a ValidationResult data type/class/record which would be expressive to cover validation results from various validators.  I foresee it to also reflect the \"source\" of the validation result, so overall should have (more to be filled out later on; yet to look at what nwbinspector provides):\n\n- `origin`: what produced this validation result\n  - `name: str` , `{\"pynwb.load\", \"pynwb.validate\", \"nwbinspector\", \"dandischema\", \"dandi-bids\"}`\n  - `version: str` -- version of the tool producing the result, e.g. `\"0.3.1\"`\n- `severity: {'ERROR', 'WARNING', 'HINT'}`  -- for now just reflecting \n- `id: str` (or `id: list`?) -- identifier of that particular type of result. For BIDS could be its Key or numeric ID. Providing a unique string ID like BIDS does quite nice since gives immediate summary in its name \n- `scope: {'file', 'dandiset'}` -- either it is\n- `path: str` - path to file or folder/dataset (e.g. BIDS of dandiset) which triggered the error\n- `asset_paths: Optional[list[str]]` - defaults to `[.path]` if not defined. Otherwise - could point to an actual file (or collection of files) which are affected by a warning/error in the `.path`. E.g. `{\"path\": \"task-broken_bold.json\", \"asset_paths\": [\"sub-01/func/sub-01_task-broken_bold.json\", \"sub-02/func/sub-02_task-broken_bold.json\"]}`.\n- `dataset_path: Optional[str]` -- path to the dataset based on validation of which message is based (e.g. could be a nested BIDS dataset, or not present for `pynwb` validations since they do not care)\n- `message: str` - it would be the \"Reason\" of BIDS or a string interpolation of nwbinspector record?\n\n### Use\n\n- `dandi validate` should gain `--severity=HINT,WARNING,ERROR` switch to provide minimal level for what to include in the report\n- `dandi upload` should use validate with `severity='ERROR'` thus only allowing for uploads without errors but possibly which would trigger WARNINGs and any other lower level problems \n\nedits:\n- here is what @nellh has for data structures to encapsulate in schema-based bids-validator: https://github.com/bids-standard/bids-validator/pull/1413/files#diff-3e29891088bc511ec972c5b36dcb579d59db3552fa69b3c882e065931d790664R6\n- @effigies also expressed some utopian idea -- if schema-based errors could point to specific BIDS schema file which instructed that particular structure, that would be useful; but to me it sounds like tricky to implement to make checks aware of original location of definitions in schema \n- nwbinspector's `@dataclass` describing InspectorMessage: https://github.com/NeurodataWithoutBorders/nwbinspector/blob/dev/nwbinspector/register_checks.py#L38","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1655993547,"metadata":{"github-id":"UCE_lAHODBZtRc5GFjw7zi_rqWU"},"target":"956f29f8173762c205376cf09988d782eb34a75fda9d4823d0f10a72f7b739a6","message":"Currently `validate` is just collecting a list of string error representations.  As @CodyCBakerPhD mentions in https://github.com/dandi/dandi-cli/pull/941/files#r830671373 , nwbinspector provides more informative result records with contextual information about the error etc.\n\nSimilarly for BIDS validation being added in #896 error messages are also serialized/simplified, although stock `bids-validator` has quite an extensive registry of warnings/errors: [google spreadsheet](https://docs.google.com/spreadsheets/d/181vtw2bt2nHcUgw__G_gFSkKGyuxOxUNr5wHrZXY_uI/edit?usp=sharing)\n\nLooking forward we should establish a ValidationResult data type/class/record which would be expressive to cover validation results from various validators.  I foresee it to also reflect the \"source\" of the validation result, so overall should have (more to be filled out later on; yet to look at what nwbinspector provides):\n\n- `origin`: what produced this validation result\n  - `name: str` , `{\"pynwb.load\", \"pynwb.validate\", \"nwbinspector\", \"dandischema\", \"dandi-bids\", \"ome-zarr\"}`\n  - `version: str` -- version of the tool producing the result, e.g. `\"0.3.1\"`\n- `severity: {'ERROR', 'WARNING', 'HINT'}`  -- for now just reflecting \n- `id: str` (or `id: list`?) -- identifier of that particular type of result. For BIDS could be its Key or numeric ID. Providing a unique string ID like BIDS does quite nice since gives immediate summary in its name \n- `scope: {'file', 'dandiset'}` -- either it is\n- `path: str` - path to file or folder/dataset (e.g. BIDS of dandiset) which triggered the error\n- `asset_paths: Optional[list[str]]` - defaults to `[.path]` if not defined. Otherwise - could point to an actual file (or collection of files) which are affected by a warning/error in the `.path`. E.g. `{\"path\": \"task-broken_bold.json\", \"asset_paths\": [\"sub-01/func/sub-01_task-broken_bold.json\", \"sub-02/func/sub-02_task-broken_bold.json\"]}`.\n- `dataset_path: Optional[str]` -- path to the dataset based on validation of which message is based (e.g. could be a nested BIDS dataset, or not present for `pynwb` validations since they do not care)\n- `message: str` - it would be the \"Reason\" of BIDS or a string interpolation of nwbinspector record?\n\n### Use\n\n- `dandi validate` should gain `--severity=HINT,WARNING,ERROR` switch to provide minimal level for what to include in the report\n- `dandi upload` should use validate with `severity='ERROR'` thus only allowing for uploads without errors but possibly which would trigger WARNINGs and any other lower level problems \n\nedits:\n- here is what @nellh has for data structures to encapsulate in schema-based bids-validator: https://github.com/bids-standard/bids-validator/pull/1413/files#diff-3e29891088bc511ec972c5b36dcb579d59db3552fa69b3c882e065931d790664R6\n- @effigies also expressed some utopian idea -- if schema-based errors could point to specific BIDS schema file which instructed that particular structure, that would be useful; but to me it sounds like tricky to implement to make checks aware of original location of definitions in schema \n- nwbinspector's `@dataclass` describing InspectorMessage: https://github.com/NeurodataWithoutBorders/nwbinspector/blob/dev/nwbinspector/register_checks.py#L38","files":null},{"type":5,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1647891958,"metadata":{"github-id":"LE_lADODBZtRc5GFjw7zwAAAAF2OObZ"},"added":["cmd-validate"],"removed":[]},{"type":3,"author":{"id":"d529b7cd76c3ce2ae50e15092ade38aa78c9ccb1"},"timestamp":1648820219,"metadata":{"github-id":"IC_kwDODBZtRc5AubZV","github-url":"https://github.com/dandi/dandi-cli/issues/943#issuecomment-1085912661"},"message":"\u003e * @effigies also expressed some utopian idea -- if schema-based errors could point to specific BIDS schema file which instructed that particular structure, that would be useful; but to me it sounds like tricky to implement to make checks aware of original location of definitions in schema\n\n@yarikoptic To be clear, my utopian idea was that we could tell where errors in the BIDS dataset arose. For example:\n\n`task-rest_bold.json`: `{\"EchoTime\": 30}`\n`sub-01/func/sub-01_task-rest_bold.json`: `{\"RepetitionTime\": 2000}`\n\nWhen I look at the logical metadata now, I see `{\"EchoTime\": 30, \"RepetitionTime\": 2000}`, but if we tagged each entry like as `{\"EchoTime\": (30, \"task-rest_bold.json\"), \"RepetitionTime\": (2000, \"sub-01/func/sub-01_task-rest_bold.json\")}`, we could produce errors like:\n\n```\nIMPLAUSIBLE_ECHO_TIME: 30 seconds is an unlikely echo time (defined in file: task-rest_bold.json)\nIMPLAUSIBLE_REPETITION_TIME: 2000 seconds is an unlikely repetition time (defined in file: sub-01/func/sub-01_task-rest_bold.json)\n```","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1651261437,"metadata":{"github-id":"IC_kwDODBZtRc5CYSQe","github-url":"https://github.com/dandi/dandi-cli/issues/943#issuecomment-1113662494"},"message":"@effigies thanks for bringing it up. Please correct me or just elaborate:\n- in most of the cases it would correspond to the file (data or sidecar) which is \"validated\", and only in some cases it might correspond to some other file where value was actually defined and picked up through some available mechanism (e.g. \"inheritance\", \"sidecar\", another \"part\" of a data file which all need to be considered/validated together)\n- `nwbinspector` record already has smth like that:  https://github.com/NeurodataWithoutBorders/nwbinspector/blob/dev/nwbinspector/register_checks.py#L64 has `file_path` (the nwb file in question/being validated) and `location` (relative path to the inspected object, which might be external to that .nwb file)\n- altogether I feel that we might benefit from a notion of an `asset` [1] as a collection of files, and indeed track where data or metadata comes from for a more precise location pointing.  For now added `asset_path` such as\n\n- `asset_paths: Optional[list[str]]` - defaults to [.path] if not defined. Otherwise - could point to an actual file (or collection of files) which are affected by a warning/error in the .path. E.g. `{\"path\": \"task-broken_bold.json\", \"asset_paths\": [\"sub-01/func/sub-01_task-broken_bold.json\", \"sub-02/func/sub-02_task-broken_bold.json\"]}` .\n\nWDYT @effigies  ?\n\n\n[1] may be some other name to not overlap since our asset was envisioned to be such a collection but ended up being  at large 1-to-1 mapping from file or a directory (.zarr/) into an asset","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1651262407,"metadata":{"github-id":"UCE_lALODBZtRc5CYSQeziLia0A"},"target":"0573c1c6ca90630e58f9386c40336ec92be9566ab8516f8cf5b6cd12d35fa937","message":"@effigies thanks for bringing it up. Please correct me or just elaborate:\n- in most of the cases it would correspond to the file (data or sidecar) which is \"validated\", and only in some cases it might correspond to some other file where value was actually defined and picked up through some available mechanism (e.g. \"inheritance\", \"sidecar\", another \"part\" of a data file which all need to be considered/validated together)\n- `nwbinspector` record already has smth like that:  https://github.com/NeurodataWithoutBorders/nwbinspector/blob/dev/nwbinspector/register_checks.py#L64 has `file_path` (the nwb file in question/being validated) and `location` (relative path to the inspected object, which might be external to that .nwb file)\n- altogether I feel that we might benefit from a notion of an `asset` [1] as a collection of files, and indeed track where data or metadata comes from for a more precise location pointing.  For now added `asset_path` such as\n\n- `asset_paths: Optional[list[str]]` - defaults to [.path] if not defined. Otherwise - could point to an actual file (or collection of files) which are affected by a warning/error in the .path. E.g. `{\"path\": \"task-broken_bold.json\", \"asset_paths\": [\"sub-01/func/sub-01_task-broken_bold.json\", \"sub-02/func/sub-02_task-broken_bold.json\"]}` .\n\nWDYT @effigies  ?\n\n\n[1] may be some other name to not overlap since our asset was envisioned to be such a collection but ended up being  at large 1-to-1 mapping from file or a directory (.zarr/) into an asset\n\nedit 1: added `dataset_path` as well to disambiguate a possible \"reference\" for the validation.  But may be it should somehow be \"groupped\" into `origin` part of the record?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1651262523,"metadata":{"github-id":"IC_kwDODBZtRc5CYVU8","github-url":"https://github.com/dandi/dandi-cli/issues/943#issuecomment-1113675068"},"message":"\u003cdetails\u003e\n\u003csummary\u003eSome incomplete thinking about `path`s (absolute/relative/etc)\u003c/summary\u003e \n\n- recalled [a possible convention for `./`, `/` and \"pure relative\" paths in BIDS datasets](https://github.com/bids-standard/bids-specification/issues/471#issuecomment-700258967)\n- absolute paths (e.g. datalad result records are returned with abs paths)\n  - pros: would make it non-ambiguous \n  - cons: any permanent serialization would be fragile (broken if dandiset is moved etc)\n- could be relative to the top of the dandiset\n  - it is ok as long as we do not allow for nesting of dandisets, but I guess we might arrive to those later\n...\n\u003c/details\u003e","files":null},{"type":4,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1666966660,"metadata":{"github-id":"CE_lADODBZtRc5GFjw7zwAAAAHKfIW5"},"status":2}]}