{"version":2,"ops":[{"type":3,"author":{"id":"0ab0e40999605aa8d5ec6be68372511fdc4a2fdf"},"timestamp":1688384005,"metadata":{"github-id":"IC_kwDODBZtRc5gcRrm","github-url":"https://github.com/dandi/dandi-cli/issues/78#issuecomment-1618025190"},"message":"@yarikoptic @bendichter has this been addressed in the mean time? can we close this?","files":null},{"type":3,"author":{"id":"f068089e26f6e2e30d51a62e75a77af7d9dc5ecb"},"timestamp":1688385186,"metadata":{"github-id":"IC_kwDODBZtRc5gcd_4","github-url":"https://github.com/dandi/dandi-cli/issues/78#issuecomment-1618075640"},"message":"\u003e 1) `dandi validate` does not enforce that `subject_id` is present, but `dandi organize` requires it. \n\nThis is fixed\n\n```\n$ dandi validate ../test_no_subj/\n[DANDI.NO_DANDISET_FOUND] /Users/bendichter/dev/sandbox/test_no_subj — Path is not inside a Dandiset\n[NWBI.check_subject_exists] /Users/bendichter/dev/sandbox/test_no_subj/no_subject.nwb — Subject is missing.\n```\n\n\u003e 2) When `dandi organize` runs on a file that is missing `subject_id` it complains about missing metadata, but does not specify what this missing metadata is. \n\n```\n$ dandi organize ../test_no_subj/ -f dry\n2023-07-03 07:42:23,272 [    INFO] Loading metadata from 1 files\n[Parallel(n_jobs=-1)]: Using backend LokyBackend with 10 concurrent workers.\n[Parallel(n_jobs=-1)]: Done   1 tasks      | elapsed:    1.7s\n[Parallel(n_jobs=-1)]: Done   1 out of   1 | elapsed:    1.7s finished\n2023-07-03 07:42:24,962 [ WARNING] subject_id is missing for ../test_no_subj/no_subject.nwb\n2023-07-03 07:42:24,962 [    INFO] Logs saved in /Users/bendichter/Library/Logs/dandi-cli/20230703114221Z-28770.log\nError: 1 out of 1 files were found not containing all necessary metadata: ../test_no_subj/no_subject.nwb\n\n```\n\nThis is still the case. It reports that the file does not have all of the necessary metadata, but does not inform the user specifically that the subject_id is missing. I think it would be a smoother UX for `dandi organize` to output the same itemized messages as `dandi validate`, including the red color.\n\n\u003e 3) Our [user guide](https://docs.google.com/document/d/1ehxd5a6Hurz7VqQDAszEpGASRTUP6muXYwJ5wgXhzU4/edit) does not mention what to do in the case of `dandi organize` complaining, so a user will just carry on and will be confused when no data is uploaded.\n\nThis is still the case, though I think this would be addressed sufficiently by fixing #2.","files":null},{"type":6,"author":{"id":"f068089e26f6e2e30d51a62e75a77af7d9dc5ecb"},"timestamp":1688385362,"metadata":{"github-id":"UCE_lALODBZtRc5gcd_4zjOnAWo"},"target":"d4ee3483f81577b8ea9a72774b54de113e4ef38a4f319b3e076d15d619c1e0b4","message":"\u003e 1) `dandi validate` does not enforce that `subject_id` is present, but `dandi organize` requires it. \n\nThis is fixed\n\n```\n$ dandi validate ../test_no_subj/\n[DANDI.NO_DANDISET_FOUND] /Users/bendichter/dev/sandbox/test_no_subj — Path is not inside a Dandiset\n[NWBI.check_subject_exists] /Users/bendichter/dev/sandbox/test_no_subj/no_subject.nwb — Subject is missing.\n```\n\n\u003e 2) When `dandi organize` runs on a file that is missing `subject_id` it complains about missing metadata, but does not specify what this missing metadata is. \n\n```\n$ dandi organize ../test_no_subj/ -f dry\n2023-07-03 07:42:23,272 [    INFO] Loading metadata from 1 files\n[Parallel(n_jobs=-1)]: Using backend LokyBackend with 10 concurrent workers.\n[Parallel(n_jobs=-1)]: Done   1 tasks      | elapsed:    1.7s\n[Parallel(n_jobs=-1)]: Done   1 out of   1 | elapsed:    1.7s finished\n2023-07-03 07:42:24,962 [ WARNING] subject_id is missing for ../test_no_subj/no_subject.nwb\n2023-07-03 07:42:24,962 [    INFO] Logs saved in /Users/bendichter/Library/Logs/dandi-cli/20230703114221Z-28770.log\nError: 1 out of 1 files were found not containing all necessary metadata: ../test_no_subj/no_subject.nwb\n\n```\n\nThis is still the case. It reports that the file does not have all of the necessary metadata, but does not inform the user specifically that the subject_id is missing. I think it would be a smoother UX for `dandi organize` to output the same itemized messages as `dandi validate`, including the red color. Or, at least for NWB, you could output the report produced by NWB inspector.\n\n\u003e 3) Our [user guide](https://docs.google.com/document/d/1ehxd5a6Hurz7VqQDAszEpGASRTUP6muXYwJ5wgXhzU4/edit) does not mention what to do in the case of `dandi organize` complaining, so a user will just carry on and will be confused when no data is uploaded.\n\nThis is still the case, though I think this would be addressed sufficiently by fixing #2.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1688581137,"metadata":{"github-id":"IC_kwDODBZtRc5gsZzL","github-url":"https://github.com/dandi/dandi-cli/issues/78#issuecomment-1622252747"},"message":"\u003e This is still the case. It reports that the file does not have all of the necessary metadata, but does not inform the user specifically that the subject_id is missing\n\nisn't that what it says in \n\n```\n2023-07-03 07:42:24,962 [ WARNING] subject_id is missing for ../test_no_subj/no_subject.nwb\n```\n?  I would also like to see colors to indicate errors","files":null},{"type":3,"author":{"id":"f068089e26f6e2e30d51a62e75a77af7d9dc5ecb"},"timestamp":1688598868,"metadata":{"github-id":"IC_kwDODBZtRc5gt9xh","github-url":"https://github.com/dandi/dandi-cli/issues/78#issuecomment-1622662241"},"message":"oh shoot there it is. OK yeah we can close this","files":null},{"type":4,"author":{"id":"f068089e26f6e2e30d51a62e75a77af7d9dc5ecb"},"timestamp":1688598868,"metadata":{"github-id":"CE_lADODBZtRc4jpOBNzwAAAAJEZZ8N"},"status":2}]}