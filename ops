{"version":2,"ops":[{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1614814019,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdElzc3VlRWRpdDo1MDI0OTY1ODQ="},"target":"24f9a0610717e37d7b3c24b9afe58df99447f4d5b47a58063cee02f9311ee0be","message":"https://schema.org/dateModified\n\nshould be non optional, ready only in mediator\n\nwill correspond to file mtime, uploaded, and used for refresh (#367 )\n\nAny objections @satra ?","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1614820131,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDc5MDIwMzE0NA==","github-url":"https://github.com/dandi/dandi-cli/issues/448#issuecomment-790203144"},"message":"you could add `dateModified` but isn't that somewhat weird given that UUID is minted for any modification to metadata or blob? and thus object creation time exists. \n\ni also thought you implemented local caching.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1614821443,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDc5MDIxMjQ2Mg==","github-url":"https://github.com/dandi/dandi-cli/issues/448#issuecomment-790212462"},"message":"Well, the db modified date isn't part of metadata afaik (and that is good IMHO ;-)).\n\nLocal caching - we cache many things now, which one do you have in mind? ;-) I was thinking about adding dateModified so user could tell either local file is newer or older, not just different (what checksum can tell us, and yes we cache checksums)","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1614822332,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDc5MDIxODk3NA==","github-url":"https://github.com/dandi/dandi-cli/issues/448#issuecomment-790218974"},"message":"what happens if i download a dandiset. won't it show that my local mtime is ahead of the remote mtime?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1614824805,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDc5MDIzNTMxMA==","github-url":"https://github.com/dandi/dandi-cli/issues/448#issuecomment-790235310"},"message":"For girder downloads we set mtime of the downloaded file to match the one from metadata iirc. Iirc wget does the same if last-modified is provided (makes me think to check if we could feed that was well into s3 urls as well... Hmm)","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1614825751,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDc5MDI0MzM0Mg==","github-url":"https://github.com/dandi/dandi-cli/issues/448#issuecomment-790243342"},"message":"feel free to add some of the time properties, but i don't know which `Last-Modified` you will attach to the blob when used in multiple assets :)","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1614826345,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDc5MDI0Njk5Nw==","github-url":"https://github.com/dandi/dandi-cli/issues/448#issuecomment-790246997"},"message":"Well, this metadata isn't available for blobs, so they will go without mtime","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1614826466,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDc5MDI0NzczMA==","github-url":"https://github.com/dandi/dandi-cli/issues/448#issuecomment-790247730"},"message":"but just like we will add `content-disposition` to blob, we can add `Last-Modified` to blob as well. but i guess for this need you only care about metadata.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1614828738,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDc5MDI2Mjg5NQ==","github-url":"https://github.com/dandi/dandi-cli/issues/448#issuecomment-790262895"},"message":"yeap, that is the idea.\n\nFWIW: double checked about wget -- I remembered it right:\n\n```shell\n$\u003e wget -S 'https://api.dandiarchive.org/api/dandisets/001001/versions/draft/assets/872ad8bf-ee32-4b3d-8659-c85c4995cc86/download' 2\u003e\u00261 | grep Last-Modified\n  Last-Modified: Mon, 25 Jan 2021 21:06:14 GMT\n$\u003e stat download\n ...\nModify: 2021-01-25 16:06:14.000000000 -0500\n```\nand apparently it is probably the mtime of the file whenever it was uploaded to the blob store since that date is nowhere in the metadata associated with the asset:\n```\n$\u003e curl --silent -X GET -H \"accept: application/json\" https://api.dandiarchive.org/api/dandisets/001001/versions/draft/assets/872ad8bf-ee32-4b3d-8659-c85c4995cc86/ | jq . | grep 2021\n  \"created\": \"2021-02-02T15:05:27.045124Z\",\n  \"modified\": \"2021-02-02T15:05:27.045168Z\",\n    \"created\": \"2021-02-02T15:02:27.024880Z\",\n    \"modified\": \"2021-02-02T15:24:57.435116Z\",\n      \"created\": \"2021-02-02T15:02:27.002581Z\",\n      \"modified\": \"2021-02-02T15:02:27.002622Z\"\n```\n\n@jwodder -- please add dateModified to BareAssetMeta, and add handling for it in API based upload (thus addressing #367 by adding proper \"refresh\" mode)/download.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1614871462,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDc5MDY5NzU5NA==","github-url":"https://github.com/dandi/dandi-cli/issues/448#issuecomment-790697594"},"message":"@yarikoptic What exactly do you want the upload behavior of \"refresh\" to be?  For Girder, refresh proceeds iff the local \u0026 remote files differ in size or mtime (without taking digests into account) and the remote file is older than the local file.  Should the new API use the digests instead of the file sizes?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1614875223,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDc5MDc0NDMxOA==","github-url":"https://github.com/dandi/dandi-cli/issues/448#issuecomment-790744318"},"message":"yes - use digest as the first check and then if differ, proceed iff remote file is older than the local file.","files":null},{"type":4,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1615231608,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50NDQyMzEzMjMzNA=="},"status":2}]}