{"version":2,"ops":[{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1652278361,"metadata":{"github-id":"UCE_lAHODBZtRc5Jebk-zi3H2Cs"},"target":"4ed41fac47c7aad33931fa25ee815229399a6e681e561261176782f5913fd30d","message":"Prior mentioning/need for such (`dandi mv`) command is at https://github.com/dandi/dandi-cli/issues/848#issuecomment-988055068 and it came up again in context of zarr archives. Since they are mutable ATM, asset ids are changing upon metadata change and not stored locally, there is no sense of identity of a zarr folder.  That forbids any efficient renaming of a zarr archive locally. \n\nWith `dandi move`, similar one to `dandi delete` we have, we could rename locally and on the server really fast, thus making subsequent `dandi upload` if so needed update an existing zarr archive instead of uploading a new one and deleting an old one. \n\nExtra points to keep in mind\n- IIRC `dandi organize` can operate in-place (within existing dandiset).  Then in such scenario \"by default\" it should use `dandi move` internally to move files. But it should be some kind of a switch which would do server side change as well or not.\n- Originally I thought to file it as `dandi mv` but decided to name it `dandi move` instead -- https://github.com/dandi/dandi-cli/issues/1005","files":null},{"type":5,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1652278353,"metadata":{"github-id":"LE_lADODBZtRc5Jebk-zwAAAAGI131j"},"added":["enhancement"],"removed":[]},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1652370676,"metadata":{"github-id":"IC_kwDODBZtRc5DEJK_","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1125159615"},"message":"@yarikoptic\n\n* What exactly do you want the syntax of this command to be?  Should it be possible to run it outside of a local Dandiset folder, or is a local Dandiset required?\n* What exactly are you asking for with regard to `dandi organize`?  That sort of seems like it should be a separate issue+PR.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1652377956,"metadata":{"github-id":"IC_kwDODBZtRc5DEkUV","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1125270805"},"message":"\u003e * What exactly do you want the syntax of this command to be?  \n\nsomething simple/obvious, thus basic functionality very close to\n\n```\n$\u003e mv --help\nUsage: mv [OPTION]... [-T] SOURCE DEST\n  or:  mv [OPTION]... SOURCE... DIRECTORY\n  or:  mv [OPTION]... -t DIRECTORY SOURCE...\nRename SOURCE to DEST, or move SOURCE(s) to DIRECTORY.\n```\n\nfor starters I think we can avoid needing -T or -t, and just have `move [OPTIONS] SOURCE(S) DEST`,  and if `DEST` is not a directory -- just a single SOURCE should it be, otherwise -- error. If DEST is a directory -- move ALL SOURCE(S) into that directory. SOURCE(S) could be folders.\n\nOPTIONS:\n\n- `--regex FROM_REGEX`, so if specified, SOURCEs would be regexes to select paths by [*], DEST is a regex \"TO\" rename to each of the SOURCE(S) (if application of regex changes the filename). \n- `--work-on auto,local,remote,both`: if `--dataset` (below) is specified -- explicit 'local' or 'both' should cause error. Otherwise 'auto' == 'both' i.e. changes would performed on local and remote dandisets. if 'remote' is specified, must be in a dandiset or have `--dandiset` option to point to dandiset\n- `--existing error,overwrite,skip`: if destination path (not just `DEST/` but the destination path) already exists -- what to do?! \n\nFWIW -- I would be ok if restriction  for `--regex REGEX` mode would be to have a single SOURCE to not gather a union from multiple regex match sets.\n\n\u003e Should it be possible to run it outside of a local Dandiset folder, or is a local Dandiset required?\n\nGood question.  I think it would be valuable to allow to operate on remote dandiset.\nLet's add `-d|--dandiset URI` (so could be `-d DANDI:000029`) option to specify remote dandiset. Then `SOURCE(S)` and must be paths  relative to the top of the dandiset.  \n\nSo sample uses\n- UC1: rename all `.tiff` to `.tif` in a dandiset in the main archive: `dandi move -d DANDI:009999 --regex '\\.tiff$' '.*' '.tif'` which would just apply that regex to all files but will not do anything to non-.tiff files since transformation would not change their names.  More specific targetting would be `dandi move -d DANDI:009999 --regex '\\.tiff$' '.*\\.tiff$' '.tif'`\n- UC2: move data files (or could be dirs - who knows) starting with `sub-` under a `micr/` folder: `dandi move --regex '\\(ses-[^/]+\\)/sub-' '.*' '\\1/micr/sub-'`  (demonstrates reuse of group from `FROM_REGEX` in `DEST`)\n\nNB alternative is just to make it `--regex` option, and then SOURCE is both regex for selection and specification (via groups) on what to replace in DEST.  So UC1: `dandi move -d DANDI:009999 --regex '\\.tiff$' '.tif'`; UC2: `dandi move --regex  '\\(ses-[^/]+\\)/sub-' '\\1/micr/sub-'`. WDYT @jwodder -- would this be better?\n\n\u003e * What exactly are you asking for with regard to `dandi organize`?  That sort of seems like it should be a separate issue+PR.\n\nSure -- could be a separate one (will do later), but I thought that might be good to have that use case in mind. \n\nNotes:\n- regex option makes it easier to shoot in the foot so that multiple renamed files point to the same filename. In such a case we must just error out\n  - to implement that , first the `renames: dict` of `from: to`  should be prepared and target list should have only unique entries `len(list(renames.values())) == len(set(renames.values())))`\n  - `renames` includes only renames -- i.e. key != value\n- a tricky case could be renames like `swap filenames between A and B` but I don't think we can easily specify such rename with regex.  But let's guard for that specifically:\n  -  `assert not set(renames).intersection(renames.values())`  since if there is intersection - there might (but not guaranteed) to be a loop, and also renames order would matter -- we can just raise NotImplemntedError for now\n- [*] eventually using native regex support #979 but could start with getting all assets and applying regex to include if matches. Also if --existing is not equal to \"overwrite\" - we are likely doomed to get a full list of assets first to ensure that we are not overwriting some existing one.  Of cause in case of just few files renames it is cheaper just to test for those specific paths... dunno yet if we should check destinations one by one or get a full list first.\n\nWDYT @jwodder and @satra ?","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1654017301,"metadata":{"github-id":"IC_kwDODBZtRc5EF619","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1142402429"},"message":"@yarikoptic\n\n* I think I prefer the `--regex MATCH DEST` syntax to `--regex MATCH FIND REPLACE`.\n* Should there be a corresponding `move()` function, like there is for `upload()`, `download()`, and `organize()`?  If so, what should its signature be?\n* What should happen when `--work-on both` is given and the local \u0026 remote file hierarchies don't match?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1654019064,"metadata":{"github-id":"IC_kwDODBZtRc5EGBVP","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1142429007"},"message":"\u003e * I think I prefer the `--regex MATCH DEST` syntax to `--regex MATCH FIND REPLACE`.\n\ngood. so like in the `NB` above -- Let's proceed with it then. So in a way `MATCH` will provide `FIND` since if there is no MATCH, there is no REPLACE and thus no \"move\" to happen.\n\n\u003e * Should there be a corresponding `move()` function, like there is for `upload()`, `download()`, and `organize()`?  If so, what should its signature be?\n\nI think so.   Signature -- following CLI, I guess smth like\n\n```python\ndef move(source: Union[str,list], destination: str, *, regex:bool=False, work_on:str='auto', dandiset: Optional[Union[str,Dandiset]]=None, existing: str='error')\n```\n\nso `regex` would turn `source` into a regex to match (on `list` just raise ValueError that should be a single regex) and `destination` is what to rename into.  So following the NB\n\n\u003e * What should happen when `--work-on both` is given and the local \u0026 remote file hierarchies don't match?\n\nGood point! let's just error out with \n\n```\nRuntimeError('Local \u0026 remote hierarchies do not match. 10 files (e.g., mumba.nwb) are local only. 5 files (e.g., onserver.nwb) are only on server')\n```\nor alike - i.e. providing minimal sufficient information to point to the problem and possibly troubleshoot it.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1654026516,"metadata":{"github-id":"IC_kwDODBZtRc5EGlul","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1142578085"},"message":"@yarikoptic \n\n\u003e `dandiset: Optional[Union[str,Dandiset]]=None`\n\nI assume that the `str` option is a path to a local Dandiset.  Is `Dandiset` here supposed to be `dandi.dandiset.Dandiset` or a typo for `dandi.dandiapi.RemoteDandiset`?  If the former, how would one specify the archive instance without being able to pass a `RemoteDandiset`?","files":null},{"type":6,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1654026592,"metadata":{"github-id":"UCE_lALODBZtRc5EGlulziO96TE"},"target":"abfc64ff87e6c49da05a48466aa40ac86866467fa40c2e03ef8f8749b1fd2044","message":"@yarikoptic \n\n\u003e `dandiset: Optional[Union[str,Dandiset]]=None`\n\nI assume that the `str` option is a path to a local Dandiset, and `None` means to the use the current directory.  Is `Dandiset` here supposed to be `dandi.dandiset.Dandiset` or a typo for `dandi.dandiapi.RemoteDandiset`?  If the former, how would one specify the archive instance without being able to pass a `RemoteDandiset`?","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1654092742,"metadata":{"github-id":"IC_kwDODBZtRc5EKvOB","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1143665537"},"message":"@yarikoptic Also:\n\n* What should be the default value of `--existing`?\n* Exactly what should trigger an error when the local \u0026 remote file hierarchies don't match?  Should `move()` only care if a given source or destination path doesn't match, or should it also error if a path not involved in the move doesn't match?\n* Do you want the interface to use pyout like `dandi delete` does, or should it just log each renaming and call it a day?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1654099496,"metadata":{"github-id":"IC_kwDODBZtRc5ELQJP","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1143800399"},"message":"\u003e \u003e `dandiset: Optional[Union[str,Dandiset]]=None`\n\u003e \n\u003e I assume that the `str` option is a path to a local Dandiset, and `None` means to the use the current directory. Is `Dandiset` here supposed to be `dandi.dandiset.Dandiset` or a typo for `dandi.dandiapi.RemoteDandiset`? If the former, how would one specify the archive instance without being able to pass a `RemoteDandiset`?\n\ncouldn't give an answer right away... as I depicted in UC1 I thought to have it correspond to the remote dandiset so people could perform operations on it if work_on is `\"remote\"` or `\"both\"`... \n\nATM: in most of the high level APIs we rely on CWD to point to local dandiset:\n- `dandi organize`: There is `-d|--dandiset-path` in `organize` *only*.\n- `dandi delete` : 1. exposes `-i|--dandi-instance` to be used along with PATHs. 2. uses provided arg PATH to possibly point to remote dandiset/path - so does not use/need `-d` . Relies on CWD\n- `dandi download` - relies on URL args but also has the `-i|--dandi-instance` (I guess for the cases to overload or disambiguate server deduced from URL?? or why?). Uses CWD to dump to.\n- `dandi upload` - deduces from CWD, has `--dandi-instance`\n-  `dandi digest` uses `-d` but for  `--digest ` and since never to operate on dandiset afaik -- no problem/inconsistency\n\nSo, none command besides `organize` has explicit way to point to local dandiset path and at large relies on CWD if it is needed to figure out a local dandiset. And then based on id for local, uses dandi-instance to figure out remote.  `delete` and `download` also use URI arguments to identify remote dandisets. \n\nIt feels that for some consistency we want \n- stay close to `delete` syntax/semantics\n- get `--dandi-instance` here too to map to remote dandiset similarly to how `delete` and `upload` do\n- need a way to point to remote dandiset for `work_on=\"remote\"` so `-d` should allow to take URI to identify the remote dandiset\n- rely on CWD being in the target dandiset if work_on `local` or `both`  (we might want later on to add `--dandiset-path`, to allow for \"operate on a dandiset not under CWD, and add it also to `upload`)\n\nWDYT @jwodder -- may be you see some other, simpler/more intuitive interface?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1654101108,"metadata":{"github-id":"IC_kwDODBZtRc5ELbTL","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1143846091"},"message":"\u003e * What should be the default value of `--existing`?\n\n\"error\" as I have it in https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1142429007 -- we do not want to blindly overwrite.\n\n\u003e * Exactly what should trigger an error when the local \u0026 remote file hierarchies don't match?  Should `move()` only care if a given source or destination path doesn't match, or should it also error if a path not involved in the move doesn't match?\n\nI would KISS - compare entire hierarchies in case of work_on \"both\" . If any difference -- error.\n\n\u003e * Do you want the interface to use pyout like `dandi delete` does, or should it just log each renaming and call it a day?\n\nI don't think there is much of job for `pyout` but we could keep it consistent with `delete` for now -- at some point we should provide alternative \"frontends\" to render those messages. Could also then (ab)use its parallelization.  Can have `source`, `target` `local`, `remote`, `message` columns I guess, where `local` and `remote` are for corresponding status'es and would be present/absent depending on `work_on` setting.\n\nanother wishlist item which came to mind due to presence of `--regex`: `--dry-run` which would just show what would have been done without doing it.  Then those status'es (local/remote) could just say 'dry'.\n\nAnd later we would add some flag like `ls` has `-f, --format` to switch from `pyout` to simple logging or whatnot... some time...","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1654102948,"metadata":{"github-id":"IC_kwDODBZtRc5ELkCL","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1143881867"},"message":"@yarikoptic That command-line syntax for `dandi move` sounds fine, but I was primarily asking about the `move()` function.  I'm thinking that it should take `dandiset: Union[str, Path, RemoteDandiset, None] = None`, where the `RemoteDandiset` option is for when `-d` is given on the command line, along with a `dandi_instance` argument for use when `dandiset` is a path and `work_on` is not `local`.\n\nAnother question: Should this be able to operate locally on folders that are not Dandisets?","files":null},{"type":6,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1654102961,"metadata":{"github-id":"UCE_lALODBZtRc5ELkCLziPHI-w"},"target":"a8f27ab637a8df785f54d596824e61bfb30636ab91e28c0f4f765490f9050495","message":"@yarikoptic That command-line syntax for `dandi move` sounds fine, but I was primarily asking about the `move()` function.  I'm thinking that it should take `dandiset: Union[str, Path, RemoteDandiset, None] = None`, where the `RemoteDandiset` option is for when `-d` is given on the command line, along with a `dandi_instance` argument for use when `dandiset` is a path and `work_on` is not `local`.\n\nAnother question: Should this be able to operate locally on folders that are not Dandisets (i.e., that do not have a `dandiset.yaml`)?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1654104560,"metadata":{"github-id":"IC_kwDODBZtRc5ELtn4","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1143921144"},"message":"\u003e @yarikoptic That command-line syntax for `dandi move` sounds fine, but I was primarily asking about the `move()` function.\n\nwell, those (CLI and function) should at large be the same where CLI just passes in args into `move` function. `move` indeed just could be smarter to accept the `RemoteDandiset` and `Path` so could be more flexible I guess, but if it would be -- it should probably be \"consistent\" with CLI:\n\n\u003e ... where the `RemoteDandiset` option is for when `-d` is given on the command line ...\n\nIMHO it would be \"consistent\"  if `dandiset: str` when passed to `move` function is treated as a URI of a remote dandiset (thus mapping into `RemoteDandiset`), and to point to local path it would have to be `Path`.  Then CLI `-d \"DANDI:000009\"` and Python code `move(dandiset=\"DANDI:000009\",...)` would mean the same thing.\n\n\u003e Another question: Should this be able to operate locally on folders that are not Dandisets (i.e., that do not have a `dandiset.yaml`)?\n\nATM \"I don't think so\" although I can see then how someone could start using `dandi move --work_on local --regex` as some kind of a generic renamer helper ;)","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1654109698,"metadata":{"github-id":"IC_kwDODBZtRc5EME01","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1144016181"},"message":"@yarikoptic When determining whether the local and remote file hierarchies differ, what should be considered part of the local file hierarchy?  Keep in mind that `upload()` only considers NWB, Zarr, and NGFF assets to be part of the Dandiset unless `--allow-any-path` is given.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1654116516,"metadata":{"github-id":"IC_kwDODBZtRc5EMeKT","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1144119955"},"message":"oh right... that makes it tricky/impossible... but may be we want to error out with above information , mention --dry-run, and add explicit flag (`--force`) to do despite discrepancies?  but then it would need to allow for a  superset of matching paths (if regex) where some are present only locally or only remotely I guess.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1654175737,"metadata":{"github-id":"IC_kwDODBZtRc5EPQtz","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1144851315"},"message":"@yarikoptic I'm not clear on what behavior you're describing.  Are you saying that only NWB, Zarr, and NGFF assets should be honored in local Dandisets, and if anything else is present, we error out?","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1654196633,"metadata":{"github-id":"IC_kwDODBZtRc5EQpCG","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1145213062"},"message":"@yarikoptic Also, how should this work when run from inside a subdirectory of a Dandiset?  Should assets outside the sub-hierarchy be movable?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1654200381,"metadata":{"github-id":"IC_kwDODBZtRc5EQ8ac","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1145292444"},"message":"\u003e @yarikoptic I'm not clear on what behavior you're describing. Are you saying that only NWB, Zarr, and NGFF assets should be honored in local Dandisets, and if anything else is present, we error out?\n\nI was thinking -- not specifically any type of an asset, just\n- if no `--force`:\n  - get all local files as we were during `dandi upload`\n  - compare that list to the list of assets on server\n  - if different -- raise an Error\n\nbut I reflected back on your [comment/question yesterday](https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1143665537)\n\n\u003e Should move() only care if a given source or destination path doesn't match...?\n\nand may be let's do just that!  i.e. instead of the list of files for `dandi upload`, do get the files as specified in CLI (regex or not), compare that one to matching assets on the server.  They should match.  For now then we can even avoid providing `--force`ed mode of operation until someone asks for it, since it might also be needed to be parametrized so let's wait for use case.\n\n\u003e @yarikoptic Also, how should this work when run from inside a subdirectory of a Dandiset? Should assets outside the sub-hierarchy be movable?\n\nI think it would be great to be able to support that since I might want to `move * ../somefolder` or alike. So, as long as we are not moving outside of the dandiset boundary -- should be all legit/supported.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1654531896,"metadata":{"github-id":"IC_kwDODBZtRc5EZ13y","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1147624946"},"message":"@yarikoptic \n\n* When `--work-on` is `both`, if moving a local path fails (assuming the local move happens first), should the corresponding remote path still be moved?\n* When `--work-on` is `remote` or `both`, should the client fetch all asset paths from the server at the start, or should it make a request whenever it needs to look up a path or collection of paths?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1654887964,"metadata":{"github-id":"IC_kwDODBZtRc5EtBVy","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1152652658"},"message":"- I don't think so, let's error that file move so we retain consistency.\n- I think all at the start, so we could analyze if move would overwrite anything","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1655388063,"metadata":{"github-id":"IC_kwDODBZtRc5FAQ1g","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1157696864"},"message":"@yarikoptic You said you want to support moving assets outside of the current directory when running inside a subdirectory.  Should this also apply when using regexes?  Specifically, when `--regex` is given, should only assets in the current directory be taken into account, or all assets in the Dandiset?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1655388973,"metadata":{"github-id":"IC_kwDODBZtRc5FAUuQ","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1157712784"},"message":"I think assets from current directory. So, ever ran on the top directory of dandiset - would be all assets","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1655389010,"metadata":{"github-id":"UCE_lALODBZtRc5FAUuQziQ_Urk"},"target":"20fc1bd17bb28fa9a05b9d8ea5a98c83185fefb1dccad9c86ecd368d821a5e9f","message":"I think assets from current directory. So, whenever ran on the top directory of dandiset - would be all assets","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1655391234,"metadata":{"github-id":"IC_kwDODBZtRc5FAez1","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1157754101"},"message":"@yarikoptic If a non-regex `move` command says to move a file to itself, should that be a warning or error, or should the movement just be ignored?  For comparison, `mv` allows moving a file to itself, and the `--regex` code currently discards any replacements that don't change anything.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1655391996,"metadata":{"github-id":"IC_kwDODBZtRc5FAicX","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1157768983"},"message":"@yarikoptic Also, if the user runs `move --work-on=\u003c\"both\" or \"remote\"\u003e somepath somedir`, where `somedir` is a directory that exists locally but not remotely (and it doesn't end in a slash), what should happen?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1655392579,"metadata":{"github-id":"IC_kwDODBZtRc5FAl3i","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1157783010"},"message":"Hmm, if both, and exists locally paths on server should be adjusted as if there was a directory on the server (but we don't have a notion of directory). But if it is 'remote' then we shouldn't AFAIK consult local filesystem and it becomes tricky - consider it a directory only if trailing / was provided in its name","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1655392660,"metadata":{"github-id":"IC_kwDODBZtRc5FAmO0","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1157784500"},"message":"\u003e @yarikoptic If a non-regex `move` command says to move a file to itself, should that be a warning or error, or should the movement just be ignored? For comparison, `mv` allows moving a file to itself, and the `--regex` code currently discards any replacements that don't change anything.\n\nI guess just ignore (thus in effect move into itself) with a debug log message","files":null},{"type":4,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1656359607,"metadata":{"github-id":"CE_lADODBZtRc5Jebk-zwAAAAGakHrr"},"status":2},{"type":3,"author":{"id":"7a8552494914d3e4116f4b434eb4812a914ca405"},"timestamp":1656359670,"metadata":{"github-id":"IC_kwDODBZtRc5Fm3fl","github-url":"https://github.com/dandi/dandi-cli/issues/1006#issuecomment-1167816677"},"message":"\u003c!-- GITHUB_RELEASE COMMENT: released --\u003e\n:rocket: Issue was released in [`0.41.0`](https://github.com/dandi/dandi-cli/releases/tag/0.41.0) :rocket:","files":null},{"type":5,"author":{"id":"7a8552494914d3e4116f4b434eb4812a914ca405"},"timestamp":1656359671,"metadata":{"github-id":"LE_lADODBZtRc5Jebk-zwAAAAGakJND"},"added":["released"],"removed":[]}]}