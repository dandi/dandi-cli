{"version":2,"ops":[{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1647350246,"metadata":{"github-id":"IC_kwDODBZtRc4_qAuH","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1067977607"},"message":"@satra Despite what @yarikoptic said in Slack, `--metadata` isn't really a filter; its only effect is that, if it's set to `all` or `assets` (the only other allowed value being `api`, the default), then, when listing assets, their metadata will be included instead of just showing what the pagination endpoint returns.  [The original specification](https://github.com/dandi/dandi-cli/issues/534) was:\n\n\u003e So let's go for an explicit `--metadata api,all,dandiset,assets` ? `api` -- just return what API returns for a given case, and that would be current behavior. `all`/`dandiset`/`assets` -- would query metadata (for the dandiset or an asset) if no `metadata` in the corresponding record.\n\n(`dandiset` was not implemented as it would not make a difference.)\n\n@yarikoptic Given that, exactly what should be changed for this issue?","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1647351042,"metadata":{"github-id":"IC_kwDODBZtRc4_qEIf","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1067991583"},"message":"@jwodder - thanks for clarifying. \n\nin that case perhaps we can add a `dandi ls --include all, assets, dandiset (default)` with `--metadata` doing the same as before, but reduced to a flag without options. \n\ncan you clarify what the lack of `--metadata` currently means for a `dandiset`? and whether `dandi ls` can be used to list an endpoint itself (i couldn't figure out based on trying). if not, then perhaps the above formulation is better, and we could add the ability to query an API endpoint\n\n`dandi ls https://api.dandiarchive.org/ or DANDI or https://dandiarchive.org` would list all dandisets by default, assets if `--recursive` or `--include assets` is added, and their metadata if `--metadata` is added. wdyt?","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1647351379,"metadata":{"github-id":"IC_kwDODBZtRc4_qFg8","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1067997244"},"message":"@satra\n\n\u003e perhaps we can add a `dandi ls --include all, assets, dandiset (default)`\n\nWhat exactly would this option do?\n\n\u003e can you clarify what the lack of `--metadata` currently means for a `dandiset`?\n\nNothing.  `--metadata` only affects what gets displayed for assets.\n\n\u003e and whether `dandi ls` can be used to list an endpoint itself\n\nWhat do you mean by \"list an endpoint\"?\n\n\u003e `dandi ls https://api.dandiarchive.org/ or DANDI or https://dandiarchive.org` would list all dandisets by default, assets if `--recursive` or `--include assets` is added, and their metadata if `--metadata` is added. wdyt?\n\nThe code is really not structured for taking URLs that don't point to specific Dandisets or their assets, and listing every asset for every Dandiset strikes me as a query-intensive operation that we wouldn't want to natively support.","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1647388240,"metadata":{"github-id":"IC_kwDODBZtRc4_sS4g","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1068576288"},"message":"\u003e --metadata only affects what gets displayed for assets.\n\nsince this is the case, then metadata is not really universal, so let's make it universal\n\n`dandi ls \u003cDS\u003e` could return this info `https://api.dandiarchive.org/api/dandisets/\u003cDS\u003e/`\n`dandi ls \u003cDS\u003e --metadata` could return the metadata of all versions\n`dandi ls \u003cDS\u003e/\u003cversion\u003e` could return the info of the specific version\n`dandi ls \u003cDS\u003e/\u003cversion\u003e --metadata` could return the metadata of specific version\n\nif `--include` was switched to `assets` then it would return the asset info in the same way.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1647435933,"metadata":{"github-id":"IC_kwDODBZtRc4_uUST","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1069106323"},"message":"@yarikoptic Thoughts?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1647885064,"metadata":{"github-id":"IC_kwDODBZtRc5AB2T9","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1074226429"},"message":"uff, took me awhile to stop deliberating on this, sorry about that.  I see following dimensions we would like to \"expose\" to the user to tune\n\n- D1. optional `/\u003cversion\u003e`-  AFAIK we already support that and obviously only for URLs, not for local files.  Version is part of the URL specification.  Nothing to be done for that AFAIK.\n  - **BUT** there is a desire to be able to list versions of the dandiset (https://github.com/dandi/dandi-cli/issues/236) \n  - `UC1`: Also @satra did express (don't remember if there is an issue) desire to be able to list all dandisets for a given location (server, but why not path(s)?)\n- D2. target \"object\"s of interest - dandiset, assets, both of those. \n  - \"both\" is confusing and side-effect of having `dandiset.yaml` locally (just a file, can extract metadata) and no such thing on the server.  So, if we work with a server/URL, there is no \"asset\" dandiset.yaml.\n  - I never saw need in \"both\", but due to `dandiset.yaml` being a file, it was included in listing when pointed to\n  - D2.1. sub-dimension -- \"assets under the prefix\" (`/assets/` end point) vs \"assets and folders in the directory\" (`/assets/paths/` end point; desire to support - #617) .\n- D3. \"API\" response vs metadata for the object\"s of interest.  I mention \"API\" because we could do similar responses for local files as well -- would just lack `asset_id` and `blob` IDs\n\nATM the last two are somewhat conflated in `-r` and `--metadata` options, but lack expressiveness to distinguish `/assets/` vs `/assets/paths/` etc.  So we indeed should come up with two dedicated for D2 and D3.  What about \n\n- D3: `--what attrs,metadata,versions` -- for \"attributes\" vs \"metadata\" querying + if \"versions\" - list available versions if object is `dandiset`.  Eventually might even list which versions of the dandiset a given asset/path is present in, but for now some kind of Error.\n\nFor D2 I am thinking on either it is worth to separate out \"assets under the prefix\" vs \"assets and folders in the directory\"....\n\n- `--recurse none` -- information on specific object (dandiset, folder, asset).  Would not be available for `--what metadata` or `version` and pointing to a folder prefix.\n- `--recurse assets` -- \"assets under the prefix\", so no dandiset or folders of any kind -- just listing of all the assets\n- `--recurse path` -- \"assets and folders in the directory\" -- the `/assets/paths` as in the web UI. Can for now error out for `--what metadata` for now.\n\n**Note**: we stop treating `dandiset.yaml` as an asset locally for the purpose of `ls`. It will just be skipped.\n\nI think with above `--what` and `--recurse` combination we should cover all the desired so far use cases, besides the `UC1` but IMHO it is more of the \"target\" specification aspect, and would just need `--recurse dandiset` to make it explicit either want to see info about server vs dandisets in it... \n\n Or am I missing any or you see better options/dimensions @satra @jwodder and other @dandi/dandi-cli developers?","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1651606069,"metadata":{"github-id":"UCE_lALODBZtRc5AB2T9ziL1ycs"},"target":"5329918d040304bef5266305f745d6d72ce314f683757c66cf61d861adfae04a","message":"uff, took me awhile to stop deliberating on this, sorry about that.  I see following dimensions we would like to \"expose\" to the user to tune\n\n- D1. optional `/\u003cversion\u003e`-  AFAIK we already support that and obviously only for URLs, not for local files.  Version is part of the URL specification.  Nothing to be done for that AFAIK.\n  - **BUT** there is a desire to be able to list versions of the dandiset (https://github.com/dandi/dandi-cli/issues/236) \n  - `UC1`: Also @satra did express (don't remember if there is an issue) desire to be able to list all dandisets for a given location (server, but why not path(s)?)\n- D2. target \"object\"s of interest - dandiset, assets, both of those. \n  - \"both\" is confusing and side-effect of having `dandiset.yaml` locally (just a file, can extract metadata) and no such thing on the server.  So, if we work with a server/URL, there is no \"asset\" dandiset.yaml.\n  - I never saw need in \"both\", but due to `dandiset.yaml` being a file, it was included in listing when pointed to\n  - D2.1. sub-dimension -- \"assets under the prefix\" (`/assets/` end point) vs \"assets and folders in the directory\" (`/assets/paths/` end point; desire to support - #617) .\n- D3. \"API\" response vs metadata for the object\"s of interest.  I mention \"API\" because we could do similar responses for local files as well -- would just lack `asset_id` and `blob` IDs\n\nATM the last two are somewhat conflated in `-r` and `--metadata` options, but lack expressiveness to distinguish `/assets/` vs `/assets/paths/` etc.  So we indeed should come up with two dedicated for D2 and D3.  What about \n\n- D3: `--what attrs,metadata,versions` -- for \"attributes\" vs \"metadata\" querying + if \"versions\" - list available versions if object is `dandiset`.  Eventually might even list which versions of the dandiset a given asset/path is present in, but for now some kind of Error.\n\nFor D2 I am thinking on either it is worth to separate out \"assets under the prefix\" vs \"assets and folders in the directory\"....\n\n- `--recurse none` -- information on specific object (dandiset, folder, asset).  Would not be available for `--what metadata` or `version` and pointing to a folder prefix.\n- `--recurse assets` -- \"assets under the prefix\", so no dandiset or folders of any kind -- just listing of all the assets\n- `--recurse path` -- \"assets and folders in the directory\" -- the `/assets/paths` as in the web UI. Can for now error out for `--what metadata` for now.\n\n**Note**: we stop treating `dandiset.yaml` as an asset locally for the purpose of `ls`. It will just be ~~skipped~~ a file without any extra metadata.\n\nI think with above `--what` and `--recurse` combination we should cover all the desired so far use cases, besides the `UC1` but IMHO it is more of the \"target\" specification aspect, and would just need `--recurse dandiset` to make it explicit either want to see info about server vs dandisets in it... \n\n Or am I missing any or you see better options/dimensions @satra @jwodder and other @dandi/dandi-cli developers?","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1651681917,"metadata":{"github-id":"UCE_lALODBZtRc5AB2T9ziL84hU"},"target":"5329918d040304bef5266305f745d6d72ce314f683757c66cf61d861adfae04a","message":"uff, took me awhile to stop deliberating on this, sorry about that.  I see following dimensions we would like to \"expose\" to the user to tune\n\n- D1. optional `/\u003cversion\u003e`-  AFAIK we already support that and obviously only for URLs, not for local files.  Version is part of the URL specification.  Nothing to be done for that AFAIK.\n  - **BUT** there is a desire to be able to list versions of the dandiset (https://github.com/dandi/dandi-cli/issues/236) \n  - `UC1`: Also @satra did express (don't remember if there is an issue) desire to be able to list all dandisets for a given location (server, but why not path(s)?)\n- D2. target \"object\"s of interest - dandiset, assets, both of those. \n  - \"both\" is confusing and side-effect of having `dandiset.yaml` locally (just a file, can extract metadata) and no such thing on the server.  So, if we work with a server/URL, there is no \"asset\" dandiset.yaml.\n  - I never saw need in \"both\", but due to `dandiset.yaml` being a file, it was included in listing when pointed to\n  - D2.1. sub-dimension -- \"assets under the prefix\" (`/assets/` end point) vs \"assets and folders in the directory\" (`/assets/paths/` end point; desire to support - #617) .\n- D3. \"API\" response vs metadata for the object\"s of interest.  I mention \"API\" because we could do similar responses for local files as well -- would just lack `asset_id` and `blob` IDs\n\nATM the last two are somewhat conflated in `-r` and `--metadata` options, but lack expressiveness to distinguish `/assets/` vs `/assets/paths/` etc.  So we indeed should come up with two dedicated for D2 and D3.  What about \n\n- D3: `--what attrs,metadata,versions` -- for \"attributes\" vs \"metadata\" querying + if \"versions\" - list available versions if object is `dandiset`.  Eventually might even list which versions of the dandiset a given asset/path is present in, but for now some kind of Error.\n\nFor D2 I am thinking on either it is worth to separate out \"assets under the prefix\" vs \"assets and folders in the directory\"....\n\n- `--recurse none` -- (default) information on specific object (dandiset, folder, asset) -- whatever argument points to.  Would not be available for `--what metadata` or `version` and pointing to a folder prefix (at least for now, might later e.g. `metadata` could provide \"overlap\" of metadata fields for all assets under if `--recurse assets`).\n- `--recurse assets` -- \"assets under the prefix\", so no dandiset or folders of any kind -- just listing of all the assets\n- `--recurse path` -- \"assets and folders in the directory\" -- the `/assets/paths` as in the web UI.\n- `--recurse dandisets` -- \"dandisets\" under that path (discover dandisets and display information on them)\n\nNotes: \n- If nothing of the desired type found under the specified path (e.g. `--recurse dandisets` but URL or folder points within dandiset) -- nothing is displayed\n- I thought to allow to \"mix\" multiple `--recurse` values, e.g. `--recurse none,assets` while pointing to dandiset to provide current behavior of showing both assets and dandiset, but I think it is not really needed/useful, so let's not bother.\n\n**Note**: we stop treating `dandiset.yaml` as an asset locally for the purpose of `ls`. It will just be ~~skipped~~ a file without any extra metadata.\n\nI think with above `--what` and `--recurse` combination we should cover all the desired so far use cases, besides the `UC1` but IMHO it is more of the \"target\" specification aspect, and would just need `--recurse dandiset` to make it explicit either want to see info about server vs dandisets in it... \n\n Or am I missing any or you see better options/dimensions @satra @jwodder and other @dandi/dandi-cli developers?","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1657050365,"metadata":{"github-id":"UCE_lALODBZtRc5AB2T9ziTU73g"},"target":"5329918d040304bef5266305f745d6d72ce314f683757c66cf61d861adfae04a","message":"uff, took me awhile to stop deliberating on this, sorry about that.  I see following dimensions we would like to \"expose\" to the user to tune\n\n- D1. optional `/\u003cversion\u003e`-  AFAIK we already support that and obviously only for URLs, not for local files.  Version is part of the URL specification.  Nothing to be done for that AFAIK.\n  - **BUT** there is a desire to be able to list versions of the dandiset (https://github.com/dandi/dandi-cli/issues/236) \n  - `UC1`: Also @satra did express (don't remember if there is an issue) desire to be able to list all dandisets for a given location (server, but why not path(s)?)\n- D2. target \"object\"s of interest - dandiset, assets, both of those. \n  - \"both\" is confusing and side-effect of having `dandiset.yaml` locally (just a file, can extract metadata) and no such thing on the server.  So, if we work with a server/URL, there is no \"asset\" dandiset.yaml.\n  - I never saw need in \"both\", but due to `dandiset.yaml` being a file, it was included in listing when pointed to\n  - D2.1. sub-dimension -- \"assets under the prefix\" (`/assets/` end point) vs \"assets and folders in the directory\" (`/assets/paths/` end point; desire to support - #617) .\n- D3. \"API\" response vs metadata for the object\"s of interest.  I mention \"API\" because we could do similar responses for local files as well -- would just lack `asset_id` and `blob` IDs\n\nATM the last two are somewhat conflated in `-r` and `--metadata` options, but lack expressiveness to distinguish `/assets/` vs `/assets/paths/` etc.  So we indeed should come up with two dedicated for D2 and D3.  What about \n\n- D3: `--what attrs,metadata,versions` -- for \"attributes\" vs \"metadata\" querying + if \"versions\" - list available versions if object is `dandiset`.  Eventually might even list which versions of the dandiset a given asset/path is present in, but for now some kind of Error.\n\nFor D2 I am thinking on either it is worth to separate out \"assets under the prefix\" vs \"assets and folders in the directory\"....\n\n- `--recurse none` -- (default) information on specific object (dandiset, folder, asset) -- whatever argument points to.  Would not be available for `--what metadata` or `version` and pointing to a folder prefix (at least for now, might later e.g. `metadata` could provide \"overlap\" of metadata fields for all assets under if `--recurse assets`).\n- `--recurse assets` -- \"assets under the prefix\", so no dandiset or folders of any kind -- just listing of all the assets\n- `--recurse path` -- \"assets and folders in the directory\" -- the `/assets/paths` as in the web UI.\n- `--recurse dandisets` -- \"dandisets\" under that path (discover dandisets and display information on them)\n\nNotes: \n- If nothing of the desired type found under the specified path (e.g. `--recurse dandisets` but URL or folder points within dandiset) -- nothing is displayed\n- I thought to allow to \"mix\" multiple `--recurse` values, e.g. `--recurse none,assets` while pointing to dandiset to provide current behavior of showing both assets and dandiset, but I think it is not really needed/useful, so let's not bother.\n\n**Note**: we stop treating `dandiset.yaml` as an asset locally for the purpose of `ls`. It will just be ~~skipped~~ a file without any extra metadata.\n\nI think with above `--what` and `--recurse` combination we should cover all the desired so far use cases, besides the `UC1` but IMHO it is more of the \"target\" specification aspect, and would just need `--recurse dandiset` to make it explicit either want to see info about server vs dandisets in it... \n\n Or am I missing any or you see better options/dimensions @satra @jwodder and other @dandi/dandi-cli developers?\n\n### edit : Use cases\n\n#### List dandisets on the instance of the archive\n\nwill provide information only about most current version\n```\ndandi ls --recurse dandisets dandi://dandi\n```\n\n#### List assets and folders (without metadata) under the path\n\n```\ndandi ls -f json_pp --recurse path dandi://dandi/000288@draft/sub-H19.03.316/\n```\n\n#### List all assets under that folder or below (without metadata)\n\n```\ndandi ls -f json_pp --recurse assets dandi://dandi/000288@draft/sub-H19.03.316/\n```\n\n#### List all assets under that folder or below (metadata records)\n\n```\ndandi ls -f json_pp --recurse assets --what metadata dandi://dandi/000288@draft/sub-H19.03.316/\n```","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1648135963,"metadata":{"github-id":"IC_kwDODBZtRc5APVJ6","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1077760634"},"message":"`/server/dandisets/versions/assets/` or \u003clocal\u003e/dandisets/assetpaths\n\nif we consider that both server and local are essentially realizations of the same api, then `ls` can simply be routed through the api concepts `dandisets`, `dandisets/versions` (for local the version will be fixed),  and `assets`. the `assets` can be treated either how we do in dandi and how aws s3 treats them, as keys with a separator, regex, etc.,. \n\ni would like to see if we can avoid conflicts where we don't have to inform the user that two options cannot be presented together.\n\ni think it would be nice if we could support globs like s5cmd (https://github.com/peak/s5cmd/blob/master/README.md#beast-mode-s5cmd) and that our api supports them.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1648240334,"metadata":{"github-id":"IC_kwDODBZtRc5AVoiC","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1079412866"},"message":"\u003e i would like to see if we can avoid conflicts where we don't have to inform the user that two options cannot be presented together.\n\nI would like that too, but I also would like to not complicate CLI/Python API with some artificial construct to replace options etc.  Could you provide example invocations for what you envision -- I could not quite grasp from your description.\n\n\u003e i think it would be nice if we could support globs like s5cmd (https://github.com/peak/s5cmd/blob/master/README.md#beast-mode-s5cmd) and that our api supports them.\n\nserver API or this library API? in any case -- probably worth a separate issue with some details/vision in the corresponding (or both) components. But it all might depend on what we come up with here indeed ;)","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1649104794,"metadata":{"github-id":"IC_kwDODBZtRc5A2XJO","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1087992398"},"message":"@jwodder - what CLI/python interface you see to cover all desired use cases?","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1651582460,"metadata":{"github-id":"IC_kwDODBZtRc5Chcyb","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1116064923"},"message":"Assigning to @yarikoptic for design; assign to me for implementation.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1651682125,"metadata":{"github-id":"IC_kwDODBZtRc5CnLGA","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1117565312"},"message":"@jwodder, I have adjusted [my comment above](https://github.com/dandi/dandi-cli/issues/939#issuecomment-1074226429) with desired values for `--what` and `--recurse` which would constitute the API/CLI for `ls`.  Positional argument(s) could point to either paths or URLs, but not a mix to avoid messy outputs etc.  Prior behavior of `-r` showing both dandiset and asset(s) doesn't need to be preserved anyhow.\n\nLet me know if anything needs to be clarified.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1651682955,"metadata":{"github-id":"IC_kwDODBZtRc5CnOPH","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1117578183"},"message":"note: I guess whenever we get glob/regex'es supported we would need to come up with interface(s) for that.  I think would need to be explicit `--glob GLOB` or `--regex REGEX` (mutually exclusive) which would channel to corresponding API (when pointed to URL) or `glob` being appended to the path and `glob.glob` used, and `regex` as just a filter for all assets received (would have sense only for `--recurse assets` and nothing else AFAIK).","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1657050618,"metadata":{"github-id":"IC_kwDODBZtRc5GD7pT","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1175435859"},"message":"@yarikoptic \n\n\u003e #### List assets and folders (without metadata) under the path\n\u003e \n\u003e ```\n\u003e dandi ls -f json_pp --recurse path dandi://dandi/000288@draft/sub-H19.03.316/\n\u003e ```\n\u003e \n\u003e #### List all assets under that folder or below (without metadata)\n\u003e \n\u003e ```\n\u003e dandi ls -f json_pp --recurse assets dandi://dandi/000288@draft/sub-H19.03.316/\n\u003e ```\n\nWhat exactly is the difference between these two commands?  Note that, from the API's perspective, there are no folder resources (at least, not outside of the `.../assets/paths/` endpoint, and https://github.com/dandi/dandi-archive/issues/869 indicates that pagination for that endpoint is currently broken).","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1657059682,"metadata":{"github-id":"IC_kwDODBZtRc5GEZpx","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1175558769"},"message":"\u003e What exactly is the difference between these two commands?\n\nexactly the difference between `.../assets/paths/` and `.../assets/` end-points. The former does provide us information about \"folders\" like  web UI does.  (pagination issue in dandi-archive for /paths/ I guess needs to be fixed)","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1657113256,"metadata":{"github-id":"IC_kwDODBZtRc5GG4Lt","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1176208109"},"message":"@yarikoptic\n* So the difference between `--recurse path` and `--recurse assets` is that the former includes folder paths?\n* Is the addition of a `--recurse` option the only change you want made to `dandi ls` for this issue?\n* Note that `dandi ls` already has a `--recursive` option; adding another named `--recurse` would just be confusing.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1657115958,"metadata":{"github-id":"IC_kwDODBZtRc5GHEU7","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1176257851"},"message":"\u003e @yarikoptic\n\u003e \n\u003e * So the difference between `--recurse path` and `--recurse assets` is that the former includes folder paths?\n\nyes. also `--recurse path` does not recurse into \"subfolders\" - it provides only the listing (with subfolder entries like web ui does) for that given folder level if URL points to the \"folder\"  (if points to the asset -- there is no difference between the two types of recurse at all -- only information about that asset is returned)\n\n\u003e * Is the addition of a `--recurse` option the only change you want made to `dandi ls` for this issue?\n\nit gains `--what` option to instruct specifically what to show -- information records or metadata on corresponding entries.\n\n\u003e * Note that `dandi ls` already has a `--recursive` option; adding another named `--recurse` would just be confusing.\n\nI thought we would just deprecate/remove `--recursive`","files":null},{"type":5,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1658935703,"metadata":{"github-id":"LE_lADODBZtRc5Fq7VHzwAAAAGlpVQi"},"added":["cmd-ls"],"removed":[]},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1659033492,"metadata":{"github-id":"IC_kwDODBZtRc5Hb7jv","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1198504175"},"message":"note: `--what metadata` for `--recurse assets` (since not implemented yet in dandi-archive for `/paths` end point) can now take advantage of the https://github.com/dandi/dandi-archive/pull/1216 which was merged/released to allow to include metadata in assets listing.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1661259928,"metadata":{"github-id":"IC_kwDODBZtRc5I9XyR","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1224047761"},"message":"@yarikoptic How exactly do you want `--recurse path` to be implemented?  Using the `.../assets/paths/` endpoint is not an option, as its pagination is currently broken.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1661260266,"metadata":{"github-id":"IC_kwDODBZtRc5I9ZpN","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1224055373"},"message":"@yarikoptic I honestly feel that this issue is too big/calls for too many changes at once and should be split into sub-issues, each one addressing one of your \"dimensions\" or one new/changed option.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1661275910,"metadata":{"github-id":"IC_kwDODBZtRc5I-xmZ","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1224415641"},"message":"\u003e @yarikoptic How exactly do you want `--recurse path` to be implemented? Using the `.../assets/paths/` endpoint is not an option, as its pagination is currently broken.\n\nassume that https://github.com/dandi/dandi-archive/issues/869 is fixed, and test on a case with only 1 page of entities at the level for now.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1661276675,"metadata":{"github-id":"IC_kwDODBZtRc5I-5Ge","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1224446366"},"message":"\u003e @yarikoptic I honestly feel that this issue is too big/calls for too many changes at once and should be split into sub-issues, each one addressing one of your \"dimensions\" or one new/changed option.\n\nnot yet sure if it is possible to \"decorrelate\" current options via independent issues/PRs (one per dimension) since they are still somewhat interdependent. \n\n- what particular aspect(s)/CLI among the ones I suggested [above](https://github.com/dandi/dandi-cli/issues/939#issuecomment-1074226429) causes you confusion on how it should be implemented?\n- can you propose interface which would be as expressive in terms of covered functionality, i.e. address those use cases which I listed and which triggered this issue?","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1661284057,"metadata":{"github-id":"IC_kwDODBZtRc5JAA88","github-url":"https://github.com/dandi/dandi-cli/issues/939#issuecomment-1224740668"},"message":"@yarikoptic \n\n\u003e what particular aspect(s)/CLI among the ones I suggested above causes you confusion on how it should be implemented?\n\nThe comment in question honestly does not serve as a decent specification of what to implement.  Too many ruminations on general desires are mixed in, and it's difficult for me to tell what are the things you actually want me to do.  I need more a lot more **precise** (I cannot emphasize that enough) detail, and it'd be easier to carry out a conversation in order to work out what to do if things were compartmentalized into smaller pieces so that the multiple necessary conversations could exist in separate threads.\n\nPlease do not respond to this by editing the same comment yet again.  If you're going to attempt another description of what to implement, make it a new comment that can stand on its own.\n\n\u003e can you propose interface which would be as expressive in terms of covered functionality, i.e. address those use cases which I listed and which triggered this issue?\n\nAre you asking me to come up with an alternative implementation?  I feel I'd need a comprehensive list of user stories for everything we want `dandi ls` to do, covering both current and proposed functionality.  Honestly, I feel like it might even be a good idea to split the command into two or more — one command for listing local assets, one command for listing remote assets, one command for listing remote Dandisets, one command for listing remote Dandiset versions, etc. — rather than trying to devise a syntax that covers all possible uses for multiple different types of objects with differing traversal methods.","files":null}]}