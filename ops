{"version":2,"ops":[{"type":5,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1620216794,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDQ2ODg2MTE3ODI="},"added":["bug"],"removed":[]},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1620225205,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDgzMjczODE2Mw==","github-url":"https://github.com/dandi/dandi-cli/issues/614#issuecomment-832738163"},"message":"uff... first I thought that it was just a single asset among many and it didn't have session while others had: which could have happened is that it was an incremental `organize` of more files (from the same session) into an existing dandiset. Since session is optional (relates to prior discussion in #69) and was the same among multiple files, it was not added.\n\nBut apparently it is just a single asset in that dandiset: https://gui.dandiarchive.org/#/dandiset/000069/draft/files?location=sub-anm106211%2F  and it is exactly the discussion we had in #69 and \"optional\" nature of the session field -- we do not populate it unless it would help to resolve conflicts.  So it did not \"disappear\", it was never in the filename to  begin with.","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1620225781,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDgzMjc0NTcwNw==","github-url":"https://github.com/dandi/dandi-cli/issues/614#issuecomment-832745707"},"message":"ok if it is optional, then indeed we should consider what partial updates means (like cody ran into): https://github.com/dandisets/000053/issues/1 \n\nthis seems to imply some logic needed beyond just naming locally.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1620240047,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDgzMjkyMTI2OQ==","github-url":"https://github.com/dandi/dandi-cli/issues/614#issuecomment-832921269"},"message":"for partial updates (also attn @CodyCBakerPhD), I think we should just instruct people ATM to follow up with a subsequent run of `dandi organize -f move` in that dandiset **after** \"they are done\" with all desired incremental additions.  The reason is that loading metadata does take time (although we cache it) so on a large dandiset it could take awhile, and thus loading metadata from all the files in dandiset should not be done \"all the time\" for incremental updates.\n\nI have now tried on the 000053, where I first renamed two files into \"without session\":\n\n```\ndrogon:/mnt/backup/dandi/trash/000053\n*$\u003e git status\nOn branch master\nYour branch is up to date with 'origin/master'.\n\nChanges not staged for commit:\n  (use \"git add/rm \u003cfile\u003e...\" to update what will be committed)\n  (use \"git restore \u003cfile\u003e...\" to discard changes in working directory)\n        deleted:    sub-npI1/sub-npI1_ses-20190415_behavior+ecephys.nwb\n        deleted:    sub-npI1/sub-npI1_ses-20190415_behavior.nwb\n\nUntracked files:\n  (use \"git add \u003cfile\u003e...\" to include in what will be committed)\n        sub-npI1/sub-npI1_behavior+ecephys.nwb\n        sub-npI1/sub-npI1_behavior.nwb\n```\n\nand then did \n\n```\ndrogon:/mnt/backup/dandi/trash/000053\n$\u003e dandi organize -f move\n2021-05-05 14:33:39,855 [    INFO] We will organize . in-place\n2021-05-05 14:33:39,861 [    INFO] Loading metadata from 359 files\n...\n2021-05-05 14:34:09,672 [    INFO] 16 out of 359 paths are not unique. We will try adding _obj- based on crc32 of object_id\n2021-05-05 14:34:09,915 [    INFO] Organized 2 out of 359 paths (357 same existing skipped). Visit ./\n2021-05-05 14:34:09,916 [    INFO] Logs saved in /home/yoh/.cache/dandi-cli/log/20210505183338Z-5780.log\n```\nand ended up with\n```\n$\u003e git status\nOn branch master\nYour branch is up to date with 'origin/master'.\n\nChanges not staged for commit:\n  (use \"git add \u003cfile\u003e...\" to update what will be committed)\n  (use \"git restore \u003cfile\u003e...\" to discard changes in working directory)\n        modified:   dandiset.yaml\n\nno changes added to commit (use \"git add\" and/or \"git commit -a\")\n```\ndue to \n```\n$\u003e git diff\ndiff --git a/dandiset.yaml b/dandiset.yaml\nindex 7fd865d..0e1d9f8 100644\n--- a/dandiset.yaml\n+++ b/dandiset.yaml\n@@ -100,3 +100,4 @@ repository: https://dandiarchive.org/\n schemaVersion: 0.3.0\n studyTarget: []\n wasGeneratedBy: []\n+number_of_subjects: 34\n```\nwhich I think we should get rid off, right @satra?","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1620311078,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDgzMzU2NTYwNg==","github-url":"https://github.com/dandi/dandi-cli/issues/614#issuecomment-833565606"},"message":"@yarikoptic - doesn't this assume you have all the files locally in place? what if you just converted one recording as cody did in his case?","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1620311119,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDgzMzU2NjE2Nw==","github-url":"https://github.com/dandi/dandi-cli/issues/614#issuecomment-833566167"},"message":"\u003e which I think we should get rid off, right @satra?\n\nyes, we should get rid of changes to dandiset.yaml from the CLI side.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1620314839,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDgzMzYxMzcyNA==","github-url":"https://github.com/dandi/dandi-cli/issues/614#issuecomment-833613724"},"message":"\u003e @yarikoptic - doesn't this assume you have all the files locally in place? \n\nyes it does. \n\n\u003e what if you just converted one recording as cody did in his case?\n\nFurther thoughts are in https://github.com/dandi/dandi-cli/issues/69#issuecomment-832932858 . Let's continue discussion there.  As I have mentioned, nothing really \"disappeared\" so I would just close this issue in favor of #69 .\n\nfor dandiset.yaml changes -- submitted #615 PR.","files":null},{"type":4,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1620314839,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50NDY5NTk0NDk1NA=="},"status":2}]}