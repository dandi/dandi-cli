{"version":2,"ops":[{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1702311151,"metadata":{"github-id":"IC_kwDODBZtRc5uStIr","github-url":"https://github.com/dandi/dandi-cli/issues/1373#issuecomment-1850397227"},"message":"\u003e Upon initiation of upload do a *filesize check*: a file size reported to be 0, loop for up to 2 seconds (sleeping may be 100ms between) re-checking the file size. If it changes from 0 - can immediately proceed forward. If it remains 0 - proceed forward with 0 file size after those 2 seconds.\n\nWhat exactly is the goal of re-checking zero-sized files?  Are you assuming that, once NFS reports a non-zero size, it will report a non-zero size again when `requests` queries the file size?  Or do you want the value from this check to be used as the `Content-Length` in the upload request?  The latter would require always monkeypatching `super_len()`.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1702311390,"metadata":{"github-id":"IC_kwDODBZtRc5uSvGN","github-url":"https://github.com/dandi/dandi-cli/issues/1373#issuecomment-1850405261"},"message":"\u003e loop for up to 2 seconds (sleeping may be 100ms between)\n\nTo be clear: Do you mean that the total time spent looping should be no more than two seconds or that the individual sleeps should increase up to a maximum of two seconds each?  Either way, how many iterations through the loop should there be?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1702319772,"metadata":{"github-id":"IC_kwDODBZtRc5uTuD-","github-url":"https://github.com/dandi/dandi-cli/issues/1373#issuecomment-1850663166"},"message":"\u003e What exactly is the goal of re-checking zero-sized files? Are you assuming that, once NFS reports a non-zero size, it will report a non-zero size again when `requests` queries the file size?\n\nyes, that is the assumption I have that once it is non-zero, it stays non-zero for the nearest future. I can be proven wrong.\n\n\u003e Or do you want the value from this check to be used as the `Content-Length` in the upload request? \n\nPer my assumption above, I was assuming that it would be the same value used in Content-Length.  \n\n\u003e The latter would require always monkeypatching `super_len()`.\n\nIt is ok with me if it would be so ([as I have mentioned before](https://github.com/dandi/dandi-cli/issues/1257#issuecomment-1839516323)), we might just need to add a unittest to catch a moment when requests RFs their API so there is no use of that `super_len` (by may be making a test where we patch but raise exception there and then use requests to upload - if succeeds without that exception raised -- they changed behavior)","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1702319843,"metadata":{"github-id":"IC_kwDODBZtRc5uTup7","github-url":"https://github.com/dandi/dandi-cli/issues/1373#issuecomment-1850665595"},"message":"\u003e \u003e loop for up to 2 seconds (sleeping may be 100ms between)\n\u003e \n\u003e To be clear: Do you mean that the total time spent looping should be no more than two seconds or that the individual sleeps should increase up to a maximum of two seconds each? Either way, how many iterations through the loop should there be?\n\nindividual sleeps of e.g. 100ms (no need to increase delay IMHO), total to 2 sec, so 20 iterations.","files":null},{"type":4,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1702498168,"metadata":{"github-id":"CE_lADODBZtRc55WMH2zwAAAAKd-RcT"},"status":2},{"type":3,"author":{"id":"7a8552494914d3e4116f4b434eb4812a914ca405"},"timestamp":1704827347,"metadata":{"github-id":"IC_kwDODBZtRc5wRd7t","github-url":"https://github.com/dandi/dandi-cli/issues/1373#issuecomment-1883627245"},"message":"\u003c!-- GITHUB_RELEASE COMMENT: released --\u003e\n:rocket: Issue was released in [`0.59.0`](https://github.com/dandi/dandi-cli/releases/tag/0.59.0) :rocket:","files":null},{"type":5,"author":{"id":"7a8552494914d3e4116f4b434eb4812a914ca405"},"timestamp":1704827348,"metadata":{"github-id":"LE_lADODBZtRc55WMH2zwAAAAKpi7HP"},"added":["released"],"removed":[]},{"type":5,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1716420209,"metadata":{"github-id":"LE_lADODBZtRc55WMH2zwAAAAMA_vWv"},"added":["HIFNI"],"removed":[]}]}