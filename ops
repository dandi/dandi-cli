{"version":2,"ops":[{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1621459155,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdElzc3VlRWRpdDo1NDE5MDIwOTQ="},"target":"a91b750b48e12eda3e1ee315985699e938ef8a7830266d7492001daf272f1971","message":"\"subject_id\" -\u003e in current wasAttributedTo\n\"session_id\"  -\u003e in current wasGeneratedBy\n\"tissue_sample_id\"  -\u003e in current wasDerivedFrom\n\"slice_id\"  -\u003e in current wasDerivedFrom\n\"cell_id\" -\u003e in current wasDerivedFrom\n\"probe_ids\" -\u003e ???\n\"obj_id\" -\u003e add to \"wasDerivedFrom\" (this could be derived from an NWB file with identifier obj id?)\n\"modalities\" -\u003e see below\n\"extension\" -  in current contentType\n\nNB edited by @yarikoptic for uniformity and to reflect discussion below\n\nwe do need to fill both approach and measurementTechnique.  @bendichter started this: https://docs.google.com/spreadsheets/d/1x6aI5e7uWwyUJf_S1RyYkmOW-OzodLcRserZVq4DL2A/edit#gid=0\n\nwe will need to curate a list of named approaches and techniques from tom's list (i would use dandi readable prefixes that map via sameas to tom's list, unless tom's already has readable prefixes.\n\nanything missing?\n\ncc: @yarikoptic @bendichter @tgbugs\n\nwe need to finalize this and rerun modification of asset metadata before we can generate assetsSummary. so this is a bit urgent to get going.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1621451366,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg0NDM5MDY2NA==","github-url":"https://github.com/dandi/dandi-cli/issues/642#issuecomment-844390664"},"message":"re modalities: we were (ab)using \"module\" and as such discriminated between \"ecephys\" and \"icephys\". Table has \"modality term\" which unifies them both into \"electrophysiology\".\nTo comprise all metadata needed for file naming (#618) we would need to either \n- `1.` keep the difference (introduce \"submodality term\"?) or\n- `2.` abandon discrimination and have only `electrophysiology` and come up with a new suffix for filenames (`_ephys`?)\n\nI feel that `1.` is pragmatically useful, e.g. someone interested to test a new spike sorting  algorithm would look for extracellular recordings, or even a pair of ecephys + icephys.\n\n@satra by `-\u003e in current derivation` you meant `-\u003e in current wasDerivedFrom` right? (just making sure I don't miss anything)\n\n\u003e\"probe_ids\" -\u003e ???\n\nshouldn't it \n\n- become part of `wasGeneratedBy`?\n- be a list of `Probe(Hardware)` where `Hardware` would also be added to parallel `Software` we have?\n\nor may be there is already some standardized representation?  \n\nedit: [old exchange from 2012](https://lists.w3.org/Archives/Public/public-prov-wg/2012Feb/0159.html) suggests that Software and Hardware should be agents.  In our model `Software` is not subclass of `Agent` and `Agent` has `schemaKey: Literal[\"Software\"] = Field(\"Agent\", readOnly=True)` so I am a bit confused on the mapping of agents and non-agents here ;)","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1621451971,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg0NDM5Nzk3MA==","github-url":"https://github.com/dandi/dandi-cli/issues/642#issuecomment-844397970"},"message":"\u003e \"obj_id\" -\u003e \"wasDerivedFrom\" (this could be derived from an NWB file with identifier obj id?)\n\nyeah, sounds right semantically to my LD-ignorant ear ;)\n\nWe had been fusing a notion and properties of a `File` into `BareAssetMeta`. May be we are finally doomed to introduce `File` and then subclasses such as `NWBFile(HDF5File)` which then would have that `object_id` and could be explicitly included into `wasDerivedFrom` for the `BareAssetMeta`?\n\nThat would kinda make it nice and \"dandi\" semantically since \n\n- Asset is our construct which is indeed derived from some file (ATM) and in the future possibly from collections of those (e.g. a Zarr directory -- https://github.com/dandi/dandi-api/pull/295; note that technically directory is a file kinda ;))\n- all currently 1-to-1 mapped attributes (size, encodingFormat, dateModified, etc) would then gain a new meaning as an aggregate (in size, dates etc)","files":null},{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1621452105,"metadata":{"github-id":"MDE1OlVzZXJDb250ZW50RWRpdElzc3VlQ29tbWVudEVkaXQ6NDYyMjUyMTU4"},"target":"789a5abbe210b8f0eb6f8b649a53299b4150515908bd491d6e431dabeaf4a804","message":"\u003e \"obj_id\" -\u003e \"wasDerivedFrom\" (this could be derived from an NWB file with identifier obj id?)\n\nyeah, sounds right semantically to my LD-ignorant ear ;)\n\nWe had been fusing a notion and properties of a `File` into `BareAssetMeta`. May be we are finally doomed to introduce `File` and then subclasses such as `NWBFile(HDF5File)` which then would have that `object_id` and could be explicitly included into `wasDerivedFrom` for the `BareAssetMeta`?\n\nThat would kinda make it nice and \"dandi\" semantically since \n\n- Asset is our construct which is indeed derived from some file (ATM) and in the future possibly from collections of those (e.g. a Zarr directory -- https://github.com/dandi/dandi-api/pull/295; note that technically directory is a file kinda ;))\n- all currently 1-to-1 mapped attributes (size, encodingFormat, dateModified, etc) would then gain a new meaning as an aggregate (in size, dates etc)\n- edit: yet to twist my mind on what Asset in BIDS dataset might be (e.g. a collection of files relevant for data recording with all the sidecar files, `_split-` files, and inherited metadata files from the higher levels ;-)... sounds like a source of trouble for any sensible UI but might be nice \"semantically\" ;))","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1621452321,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg0NDQwMjA2Ng==","github-url":"https://github.com/dandi/dandi-cli/issues/642#issuecomment-844402066"},"message":"1 vs 2: in the metadata you will have access to approach and technique, and you could still map that to modality for filename construction. i.e. in my mind the main thing is put the details in metadata and then construct the filename from the metadata.\n\nre: derivation: yes, in current wasDerivedFrom\n\nre: probe: i still don't understand a probe id. @bendichter - what is a probe? \n\nre: asset meta: i would like to stay away from the notion of an asset becoming a collection. but subclassing for specific additional properties is ok with me. in bids datasets we will have files which are participant agnostic, so `wasAttributedTo` should become optional for those files. so `BareAssetMeta` becomes generic to any `File`, and then properties become restricted/added/enhanced for specific types of assets. this may also simplify metadata extraction/validation  by tying to asset classes.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1621459590,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg0NDQ4NjA5NQ==","github-url":"https://github.com/dandi/dandi-cli/issues/642#issuecomment-844486095"},"message":"\u003e i.e. in my mind the main thing is put the details in metadata and then construct the filename from the metadata.\n\nagree on that.  But I do not see `approach` in the @bendichter 's table so not sure how well that one \"quantize\", and `technique` I guess could be the one in \"method term\" column but that one is too verbose to be easily usable for filename construction.\n\n\u003e but subclassing for specific additional properties is ok with me.\n\nsubclassing what?  we can't/mustn't subclass `*AssetMeta` since we already have `BareAssetMeta -\u003e AssetMeta -\u003e PublishedAssetMeta` so we took subclassing to reflect the dimension of \"publication state\".  We shouldn't start mixing that in with another dimension (such as \"AssetType\" of come kind). That is why we need to \"delegate\" one way or another.","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1621517771,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg0NTEyODUxMw==","github-url":"https://github.com/dandi/dandi-cli/issues/642#issuecomment-845128513"},"message":"@yarikoptic - the two lists that i will incorporate into dandi are:\n\napproach: https://github.com/SciCrunch/NIF-Ontology/blob/dev/ttl/approach.ttl\ntechniques: https://github.com/SciCrunch/NIF-Ontology/blob/dev/ttl/methods.ttl\n\nfor the time being i'm going to create dandi namespaced items at least defining the terms relevant to dandi to get us moving. once we get these into neptune, we can start connecting up with tom/scicrunch.\n\nfrom ben's table,  approach --\u003e modality column, technique -\u003e methods column\nhowever, those don't disambiguate completely, so we also need to put neurodata_type somewhere. it almost seems like `variableMeasured` and since there could be many different things in a file a list of `variableMeasured` would make sense, but someone should clarify. and given the three fields (approach, technique, variableMeasured), you would be able to generate the prefixes.","files":null},{"type":3,"author":{"id":"f068089e26f6e2e30d51a62e75a77af7d9dc5ecb"},"timestamp":1621518099,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg0NTEzMzMzMA==","github-url":"https://github.com/dandi/dandi-cli/issues/642#issuecomment-845133330"},"message":"@satra a probe is a device you implant into the brain to record neural activity, esp. extracellular electrophysiology, e.g. the [Neuropixel Probe](https://www.neuropixels.org/probe).\n\nI agree that separating icephys and ecephys is useful. I have found sometimes that they are combined together but they are really quite different techniques and are used differently.\n\nI can add \"approach\" and \"technique\" to this table if that would be helpful.","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1621519287,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg0NTE1MTM1NA==","github-url":"https://github.com/dandi/dandi-cli/issues/642#issuecomment-845151354"},"message":"thanks @bendichter - i don't think changing the column names are required, but you could. are the values in those columns from tom's labels?","files":null},{"type":3,"author":{"id":"f068089e26f6e2e30d51a62e75a77af7d9dc5ecb"},"timestamp":1621519599,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg0NTE1NTQ1Nw==","github-url":"https://github.com/dandi/dandi-cli/issues/642#issuecomment-845155457"},"message":"I just went through and made sure they matched up with the labels in the NIF-Ontology repo","files":null},{"type":3,"author":{"id":"525468a8f42cef15f987e00f4adb393f6c8fd5ae"},"timestamp":1621555965,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg0NTU2MzE4MQ==","github-url":"https://github.com/dandi/dandi-cli/issues/642#issuecomment-845563181"},"message":"I'm doing a similar run through the SPARC data model at the moment and I think everything here is in order.\n\nTaking a subset of the approaches and mapping them to the common approaches is fine, they were originally derived from what BCDC, SPARC, and HBP were doing. If you encounter any new approaches that you need for your own uses drop an issue in the NIF-Ontology issue tracker so we can add them since eventually someone else will probably want/need them.\n\nRelatedly, I'm looking for an abstraction of probe that covers things like nerve cuffs, but I think it winds up being `instrument` with the specific type determined by RRID. Unfortunately `instrument` doesn't indicate that there is a map from electrodes/contacts that have spatial location to channels that were recording data from that location, so I wind up needing types that are equivalent to `hasPart some (MeasurementDevice and hasLocation some SpatialLocation and hasIdentifierInData some number)`.","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1621564397,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg0NTYwNzg1Nw==","github-url":"https://github.com/dandi/dandi-cli/issues/642#issuecomment-845607857"},"message":"@tgbugs - i don't have a good sense of where to put probe id. in the attached PR i put it in an assayType associated with tissuesample or the highest level sample, but i'm not sure that's the best place. any thoughts?","files":null},{"type":3,"author":{"id":"525468a8f42cef15f987e00f4adb393f6c8fd5ae"},"timestamp":1621567189,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg0NTYyMzQwOA==","github-url":"https://github.com/dandi/dandi-cli/issues/642#issuecomment-845623408"},"message":"Short version. I think the only tractable place is to have it attached to a process/activity (generation of a single or multiple files, run, session, experiment, study, etc.). For activities you have to use your activity part extension because of things like chronic implants that might be used for the life of the subject. I don't see any general way to attach it to samples or subjects.\n\nLong version.\n\nI don't think sample works because probes can go directly into an awake behaving animal. They are more similar to instruments, though usually they aren't reused across subjects, sometimes they can be reused across trials e.g. in the case of single sharp extracellular electrodes, but then they are only reused when their electrical properties are within the right range (high impedance iirc).\n\nThe fully developed ontology/data model for this centers around the concept of a rig, basically an experimental measurement/probing device with lots of parts, some of which change with each trial/run, but at the end of the day all of which are the Argo, parts change, the rig stays the same. The problem for the data model is that sometimes that exact components matter, so we want to track them.\n\nI'm going to assert that we do not want to do the full, track every single pipette, modelling of the rig. That said, for patch clamp when people record the resistance of the pipette they are actually doing that, so it might not be so insane to have a record for the exact pipette that gets switched out every cell, and the electrode that gets re-plated with silver every 100 cells (or something like that).\n\nSo what do we want to record? I think mostly what we want to record is the fact that there are multiple different probes that are distinct and that have different (or possibly similar) locations, and that map to different sets of channels. They may also have different types (e.g. in hippopotamus slices there is a curled stimulating electrode and a patch pipette). Location/site, type, identity, and mapping to channels via electrodes/contacts/pipette-tips/etc are all conflated in the concept of a probe and different rigs care about different things and make different measurements of the probes in question. In long, the diversity of use cases doesn't help us here, because different techniques care about different things, some can discard probe identity because it is a single chronic implant and all that matters is type and location, in other cases the resistance of every single pipette could be important.","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1621568206,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg0NTYyODUzMQ==","github-url":"https://github.com/dandi/dandi-cli/issues/642#issuecomment-845628531"},"message":"thanks for the detailed response. we will probably need a better way to associate an experimental rig. for the moment i moved it near a session.","files":null},{"type":4,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1623260592,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50NDg2NjU5MTc5MQ=="},"status":2}]}