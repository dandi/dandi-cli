{"version":2,"ops":[{"type":5,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1651613643,"metadata":{"github-id":"LE_lADODBZtRc5I_yBuzwAAAAGGE5Lg"},"added":["UX"],"removed":[]},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1651613849,"metadata":{"github-id":"IC_kwDODBZtRc5Cj0Mm","github-url":"https://github.com/dandi/dandi-cli/issues/996#issuecomment-1116685094"},"message":"@yarikoptic - the server is already responding with the appropriate message. i would say trap that and pass it to the client. in this case since this is dandi-cli, i don't think uploading a 0-byte file is an ad hoc case. this would be like a 0.00001% case that an empty file should be uploaded. i think it is safe to assume that a 0-byte file is not acceptable as a valid file for dandi.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1651614329,"metadata":{"github-id":"IC_kwDODBZtRc5Cj11u","github-url":"https://github.com/dandi/dandi-cli/issues/996#issuecomment-1116691822"},"message":"\u003e i would say trap that and pass it to the client\n\nthat is what I think and it is aligned with the title. The question was more of \"how detailed our message should be so we still have reasonable UX in our tabular pyout form\"? ;)  and indeed for that we should pass it within client from \"trap\" point to \"display\"\n\nEither 0-length file legit upload target or not I think should be decided in a single place, and I think it should be server. That is why I decided against adding ad-hoc test in client.","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1651614650,"metadata":{"github-id":"IC_kwDODBZtRc5Cj3Cg","github-url":"https://github.com/dandi/dandi-cli/issues/996#issuecomment-1116696736"},"message":"\u003e Either 0-length file legit upload target or not I think should be decided in a single place\n\ni think it can be part of validation step. and i think there are good reasons for validating on client before hitting the server.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1651615441,"metadata":{"github-id":"IC_kwDODBZtRc5Cj5W5","github-url":"https://github.com/dandi/dandi-cli/issues/996#issuecomment-1116706233"},"message":"then I guess it should be \"encoded\" in the dandischema on `contentSize` so both client and server use the same logic.","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1651616060,"metadata":{"github-id":"IC_kwDODBZtRc5Cj624","github-url":"https://github.com/dandi/dandi-cli/issues/996#issuecomment-1116712376"},"message":"the server part i think doesn't try to validate metadata at that stage, i think. i don't think upload initialize requires any metadata other than dandiset id and contentsize.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1651622988,"metadata":{"github-id":"IC_kwDODBZtRc5CkK1D","github-url":"https://github.com/dandi/dandi-cli/issues/996#issuecomment-1116777795"},"message":"true enough! indeed it is just due to limitation in the server implementation, not metadata. But if we were to add some consistent constraint -- then we might want to do it at metadata level. Any other logic, must not be \"shared\" from server into client(s).\n\n**But** I just worry that we might hit a use case for a valid 0-length file being needed (e.g. some empty mandatory README or CHANGES for BIDS), so I would prefer to not introduce some artificial limitation anyways. We do need to address original issue though -- channel details from the error message into displayed information.\n\n@jwodder, let's for now just make that message compete, as \n\n```\nError 400 while sending POST request to https://api-staging.dandiarchive.org/api/uploads/initialize/ : {\"contentSize\":[\"Ensure this value is greater than or equal to 1.\"]}\n```","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1651754084,"metadata":{"github-id":"IC_kwDODBZtRc5Cqt8R","github-url":"https://github.com/dandi/dandi-cli/issues/996#issuecomment-1118494481"},"message":"@yarikoptic Exactly under what conditions do you want the response body included in the exception message?  Note that it's possible for the body to be arbitrarily large.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1654015514,"metadata":{"github-id":"IC_kwDODBZtRc5EF0Rh","github-url":"https://github.com/dandi/dandi-cli/issues/996#issuecomment-1142375521"},"message":"good point! what if we limit to 1kB, and if greater -- \"Response was {len(response.data)} big, started with {response.data[:100]}\" or smth alike?","files":null},{"type":4,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1656603989,"metadata":{"github-id":"CE_lADODBZtRc5I_yBuzwAAAAGb_YK0"},"status":2},{"type":3,"author":{"id":"7a8552494914d3e4116f4b434eb4812a914ca405"},"timestamp":1656700623,"metadata":{"github-id":"IC_kwDODBZtRc5F5LZg","github-url":"https://github.com/dandi/dandi-cli/issues/996#issuecomment-1172616800"},"message":"\u003c!-- GITHUB_RELEASE COMMENT: released --\u003e\n:rocket: Issue was released in [`0.42.0`](https://github.com/dandi/dandi-cli/releases/tag/0.42.0) :rocket:","files":null},{"type":5,"author":{"id":"7a8552494914d3e4116f4b434eb4812a914ca405"},"timestamp":1656700624,"metadata":{"github-id":"LE_lADODBZtRc5I_yBuzwAAAAGcfKkX"},"added":["released"],"removed":[]}]}