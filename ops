{"version":2,"ops":[{"type":1,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1591655075,"metadata":{"github-id":"MDU6SXNzdWU2MzQ5NzM5MDk=","github-url":"https://github.com/dandi/dandi-cli/issues/123","origin":"github"},"title":"FOI: (past) review of existing file naming schemas by different labs ","message":"by @bendichter , available elsewhere (google docs) and dumped here to avoid searching various places.  Formatting is minimally transferred.  I will close it as soon as I open it ;)\n\n# DANDI data views\n\nLet’s nail down our file structure strategy. NWB does not enforce any rules above session-level, so we are free to do what we want here. This has come up a few times and I think we reached common ground in our last meeting, so I wanted to make it concrete and work out the remaining details. I think this more-or-less reflects what we were thinking, but if this is off-base then let’s discuss what strategies might be better.\n\nThe four use-cases we need to worry about are 1) upload, 2) store, 3) explore, 4) download. Some organizations may work for multiple of these, but one thing to keep in mind is that there probably won’t be a single view that accommodates all 4 use-cases. \n\nSince NWB does not enforce this, it makes sense to take guidance from BIDS. They use a structure of subject \u003e imaging modality:\n\n\nWe can also draw inspiration from neurophysiology labs:\n\n## Eddie Chang’s lab\nEddie’s data is stored across separate servers for PHI/HIPAA reasons, and the entire lab shares data, so they do not separate by experimenter:\n```\nraw/\nEC61/ (subject)\n\t\tEC61_B1/ (session)\n\t\t\tdata\nprocessed/\n\tEC61/\n\t\tEC61_B1/\nimaging/\n\tEC61/\n```\n\n## Gyorgy Buzsaki’s lab\nThe Buzsaki Lab’s way of storing data is probably the most common among neurophysiology labs that have a central data storage architecture at all. Here, subjects belong to specific experimenters who have unique subject naming conventions, so their first level is “experimenter”. Most of their data is shared publicly and you can navigate their file structure here (this is the data referenced by Peter’s Database).\n\n```\nSenzaiY/ (experimenter)\n\tYutaMouse-41/ (subject)\n\t\tYutaMouse-41-150819/ (session)\n\t\t\teeg.dat\n\t\t\tspikes.dat\n\t\t\t...\n```\n\t\t\nI like that the sessions are named by subject and date, because they are easy to manage by eye.\n\nAnalogously to BIDS, we could use subject \u003e session. I think we should allow for a bit of extra meta-data around NWB files, so our structure could be something like:\n\n```\nsub-01/\n\tsub-01_20190505/\ndata\ndashboard_config.py\n\tsub-01_20190506/\nsub-02/\nsub-03/\nsub-04/\n```\n\nSatra, you have been talking about not necessarily storing data in HDF5, so let’s keep “data” ambiguous. It can start as an HDF5 object and then maybe turn into something like Zarr, or some other representation of NWB data. We should use a folder structure to allow for some extra meta-data like a config file for a data dashboard configuration for this session.\n\nOne thing we’ll need to worry about more than an individual lab is naming collisions. We could take the Buzsaki approach, so that the names of experimenters only need to be unique within a lab, and the names of subjects only need to be unique for a given experimenter:\n\n```\nlab/\n\texperimenter/\n\t\tsubject/\n\t\t\tsession/\n```\n\nThe potential problem here is that it might not be clear which lab or which experimenter a subject should belong to. The placement of files might influence attribution, so uploaders might be reluctant to put data in the folder of one lab or one experimenter when it was truly a collaboration. We could solve this by forking the views here: for upload you can specify any number of experimenters and their associated lab(s). These results will show up in search results, but to prevent data duplication, the data will be stored as:\n\n```\n[first experimenter’s first lab]/\n\t[first experimenter]/\n\t\tsub-0001/\n```\n\nAnother possible issue is that the experimenter might not be the person uploading the data, or might be unknown. Maybe it’s better to have the data in folders by “manager” which may or may not be the experimenter:\n\n```\n[first manager’s first lab]/\n\t[first manager]/\n\t\tsub-0001/\n\t\t\tSub-0001_20190505\n```\n\nOr we could just use the unique ID of each login and forget the lab level:\n\n```\nlogin_user_unique_id/\n\tsubject/\n\t\tsession/\n```\n\t\t\t\nExploration may require more than one view. I anticipate that the most common access pattern will be by paper, so we could have simply:\n```\npaper_doi (searchable by title, journal, authors; addressable by doi)\n\tsub-0001/\n\t\tsub-0001_20190505/\n\t\tsub-0001_20190506a/\n```\nLeaving the sessions that were not linked to the paper (sub-01_20190506) out of the view.\n\n\nQuestion 1:\nWhat to do if there are multiple sessions on the same day? I have seen the Buzsaki Lab deal with this by using postfix letters:\n\nsub-01/\n\tsub-01_20190505/\ndata\n\tsub-01_20190506/\nsub-01_20190506a/\nsub-02/\n\nQuestion 2:\nFor subjects, what zero-padding makes sense? 4 digits?","files":null}]}