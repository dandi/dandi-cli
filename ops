{"version":2,"ops":[{"type":6,"author":{"id":"7eea5bdd45d6b031d3bf16a241db06db985fb528"},"timestamp":1672685004,"metadata":{"github-id":"UCE_lAHODBZtRc5aZgwSzjmI26c"},"target":"d88adcd9e6351c07b267a4c4c70156131881773b44ece621139bfbb01e40e258","message":"Hey all,\n\nTrying to upload an NWB file to DANDI using `0.48.0` of the CLI. It passes validation (minus the yellow 'suggestion', which is safe to ignore) but then when I try to upload it says it fails validation. Log file: [failed_upload_20230102183221Z-12284.log](https://github.com/dandi/dandi-cli/files/10333128/failed_upload_20230102183221Z-10943.log)\n\n![image](https://user-images.githubusercontent.com/51133164/210268738-caf9ce6d-f365-4cde-be2f-32215fb45b49.png)\n\nI'm guessing the upload call to validation doesn't skip the non-essential suggestions?","files":null},{"type":3,"author":{"id":"7eea5bdd45d6b031d3bf16a241db06db985fb528"},"timestamp":1672691029,"metadata":{"github-id":"IC_kwDODBZtRc5RnCUn","github-url":"https://github.com/dandi/dandi-cli/issues/1182#issuecomment-1369187623"},"message":"Here's some code for reproducing with an example file\n\n```python\nfrom datetime import datetime\n\nimport h5py\nimport pynwb\nimport numpy as np\n\nsubject_id = \"20161022-1\"\nsession_id = \"debugging\"\nfile_path = f\"/home/jovyan/ahrens/000350/sub-20161022-1/sub-{subject_id}_ses-{session_id}_ophys.nwb\"\n\nnwbfile = pynwb.NWBFile(\n    session_description=\"Reproducing a DANDI issue\",\n    identifier=\"123\",\n    session_start_time=datetime.now(),\n    subject=pynwb.file.Subject(\n        subject_id=subject_id,\n        age=\"P1D\",\n        sex=\"U\",\n        species=\"Mus musculus\",\n    )\n)\n\ndevice = nwbfile.create_device(name=\"Microscope\")\noptical_channel = pynwb.ophys.OpticalChannel(\n    name=\"OpticalChannel\",\n    description=\"\",\n    emission_lambda=500.\n)\nimaging_plane = nwbfile.create_imaging_plane(\n    name=\"ImagingPlane\",\n    description=\"\",\n    optical_channel=optical_channel,\n    device=device,\n    excitation_lambda=1.,\n    indicator=\"\",\n    location=\"\",\n)\n# using internal data. this data will be stored inside the NWB file\ntwo_photon_series = pynwb.ophys.TwoPhotonSeries(\n    name='TwoPhotonSeries1',\n    data=np.ones((3000000, 10, 10, 10)),  # \u003e 20 GB to trigger warning\n    imaging_plane=imaging_plane,\n    rate=1.0,\n    unit='normalized amplitude'\n)\nnwbfile.add_acquisition(two_photon_series)\n\nwith pynwb.NWBHDF5IO(path=file_path, mode=\"w\") as io:\n    io.write(nwbfile)\n```\n\nFrom validation: two warnings, and upload fails\n\n![image](https://user-images.githubusercontent.com/51133164/210274747-46fdec56-d24a-445e-b290-222ebba002eb.png)","files":null},{"type":4,"author":{"id":"7eea5bdd45d6b031d3bf16a241db06db985fb528"},"timestamp":1673972303,"metadata":{"github-id":"CE_lADODBZtRc5aZgwSzwAAAAHrlR6_"},"status":2}]}