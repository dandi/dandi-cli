{"version":2,"ops":[{"type":2,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1679404120,"metadata":{"github-id":"RTE_lADODBZtRc5hYwWKzwAAAAIM10bs"},"title":"folder download needing trailing /","was":"folder download needing trailing /"},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1679404183,"metadata":{"github-id":"IC_kwDODBZtRc5YFZwi","github-url":"https://github.com/dandi/dandi-cli/issues/1256#issuecomment-1477811234"},"message":"@yarikoptic [It's already established \u0026 documented](https://dandi.readthedocs.io/en/latest/ref/urls.html) that a `.../files?location={path}` URL where `path` does not end in a slash refers to a single asset.  I don't see the advantage to changing it, and the suggested change would complicate things that need to know whether a URL refers to one or multiple assets, e.g., for determining the path(s) at which to download assets.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1679406758,"metadata":{"github-id":"IC_kwDODBZtRc5YFp4o","github-url":"https://github.com/dandi/dandi-cli/issues/1256#issuecomment-1477877288"},"message":"advantage is - support of URLs copy/pasted from web UI to simplify user data workflows. Unfortunately, I think, web UI changed its behavior (I guess) and no longer includes that trailing `/`.   I have filed https://github.com/dandi/dandi-archive/issues/1546 with hopes to get it back, but I think we should also address it one way or another in dandi-cli.  If not implementing \"sensing\" of some kind and remove reliance on `/` as indicator, whenever such an exception is raised -- `No asset at path 'sub-anm369962'` -- could it be improved as `No asset at path 'sub-anm369962' - add a trailing '/' if you intended to point to a folder'.  Please implement at least that.\n\nBut as to me that would be just inferior UX -- \"why software, if it knows that it might be a folder, doesn't just handle it as a folder?\"","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1679407480,"metadata":{"github-id":"IC_kwDODBZtRc5YFuyx","github-url":"https://github.com/dandi/dandi-cli/issues/1256#issuecomment-1477897393"},"message":"\u003e \"why software, if it knows that it might be a folder, doesn't just handle it as a folder?\"\n\nAnswer: Because it only *might* be a folder; it might also be the case that the user left off, say, a trailing `5`.  Playing guessing games when the user gives us garbage is an even worse UX.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1679407810,"metadata":{"github-id":"IC_kwDODBZtRc5YFxJ-","github-url":"https://github.com/dandi/dandi-cli/issues/1256#issuecomment-1477907070"},"message":"@yarikoptic Side note: We had almost this same discussion before in https://github.com/dandi/dandi-cli/issues/598#issuecomment-828695217, but the message suggesting the user add a trailing slash currently only shows up when `strict=False`, yet `strict=True` when listing the assets to download.","files":null},{"type":6,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1679408159,"metadata":{"github-id":"UCE_lALODBZtRc5YFxJ-zi7bKfk"},"target":"0abd6a7845ab07ffb67ce0fdbce19bf6bcde900fafeb70a2f887cd0274710d2f","message":"@yarikoptic Side note: We had almost this same discussion before in https://github.com/dandi/dandi-cli/issues/598#issuecomment-828695217, but the message suggesting the user add a trailing slash currently only shows up when `strict=False`, yet `strict=True` when retrieving the assets to download.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1679408144,"metadata":{"github-id":"IC_kwDODBZtRc5YFzsF","github-url":"https://github.com/dandi/dandi-cli/issues/1256#issuecomment-1477917445"},"message":"@yarikoptic Taking into account the way [`AssetItemURL.get_assets()`](https://github.com/dandi/dandi-cli/blob/53874c74304c5cc344689e49f877318d887e486f/dandi/dandiarchive.py#L290) currently works, exactly what changes do you want made?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1679416456,"metadata":{"github-id":"IC_kwDODBZtRc5YG1M0","github-url":"https://github.com/dandi/dandi-cli/issues/1256#issuecomment-1478185780"},"message":"936e36bf89a7c56fc1faf5f07ce6b37ecc8d40ff made it strict in #820 (Make download fail immediately on nonexistent resources) to address https://github.com/dandi/dandi-cli/issues/817 (we are silently failing to download a non-existing asset)... \n\"what changes\" - I don't know yet exactly since I would have just done it already. What effect I want ideally to achieve is that whenever URL is not pointing to assets (as a prefix folder or not) - we error out, if it points to asset or prefix as a folder -- it downloads.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1679417602,"metadata":{"github-id":"IC_kwDODBZtRc5YHET5","github-url":"https://github.com/dandi/dandi-cli/issues/1256#issuecomment-1478247673"},"message":"@yarikoptic \n\n\u003e What effect I want ideally to achieve is that whenever URL is not pointing to assets (as a prefix folder or not) - we error out, if it points to asset or prefix as a folder -- it downloads.\n\nPlease reread [this comment](https://github.com/dandi/dandi-cli/issues/598#issuecomment-829426987) about why that would lead to problems.\n\nWhen I asked what changes you wanted made, I was referring to your previous comment in which you asked for the \"No asset at path\" message to conditionally include a recommendation to append a slash.  If you look at the current implementation of [`AssetItemURL.get_assets()`](https://github.com/dandi/dandi-cli/blob/53874c74304c5cc344689e49f877318d887e486f/dandi/dandiarchive.py#L290), then the following questions immediately leap to mind:\n\n* When `strict=True`, should the trailing slash recommendation only be added if the path in question points to a folder, as is done for `strict=False`?\n* When the error message is appended, should the exception type be `NotFoundError` or `ValueError` (as is done for `strict=False`)?  If `NotFoundError`, should the current `ValueError` be changed to `NotFoundError` as well?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1679533920,"metadata":{"github-id":"IC_kwDODBZtRc5YPdVP","github-url":"https://github.com/dandi/dandi-cli/issues/1256#issuecomment-1480447311"},"message":"\u003e @yarikoptic\n\u003e \n\u003e \u003e What effect I want ideally to achieve is that whenever URL is not pointing to assets (as a prefix folder or not) - we error out, if it points to asset or prefix as a folder -- it downloads.\n\u003e \n\u003e Please reread [this comment](https://github.com/dandi/dandi-cli/issues/598#issuecomment-829426987) about why that would lead to problems.\n\nI reread -- seems to point to our underlying code assumptions/logic, not some fundamental problem (like if we could have `prefix` asset blob and `prefix/` as prefix to other assets), so there is no objective reason IMHO why it could not in principle be implemented. Thanks for the analysis/questions -- I will review the code and follow up later.","files":null},{"type":4,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1697849722,"metadata":{"github-id":"CE_lADODBZtRc5hYwWKzwAAAAJ_ioDc"},"status":2},{"type":3,"author":{"id":"7a8552494914d3e4116f4b434eb4812a914ca405"},"timestamp":1698810184,"metadata":{"github-id":"IC_kwDODBZtRc5qmDcb","github-url":"https://github.com/dandi/dandi-cli/issues/1256#issuecomment-1788360475"},"message":"\u003c!-- GITHUB_RELEASE COMMENT: released --\u003e\n:rocket: Issue was released in [`0.57.0`](https://github.com/dandi/dandi-cli/releases/tag/0.57.0) :rocket:","files":null},{"type":5,"author":{"id":"7a8552494914d3e4116f4b434eb4812a914ca405"},"timestamp":1698810185,"metadata":{"github-id":"LE_lADODBZtRc5hYwWKzwAAAAKFZn-k"},"added":["released"],"removed":[]}]}