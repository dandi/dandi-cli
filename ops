{"version":2,"ops":[{"type":6,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1716470022,"metadata":{"github-id":"UCE_lAHODBZtRc6J2_94zlvKYys"},"target":"8079ac57d400233a964a0f0edc8ddf4086cf0838f61cc6b3551d5c6b9743a127","message":"ATM we have that option for `download` command.\n\nI am yet not sure how CLI should look like given that we take target file paths or URIs.  I guess we could add this option and then treat local paths as globs to be expanded by python locally and on the server. For URLs we would need some custom URI schema to indicate that it is a glob for a particular dandiset (e.g. `dandi-glob://\u003cinstance name\u003e/\u003cdandiset id\u003e[@\u003cversion\u003e][/\u003cglob\u003e]`)\n\nWDYT @jwodder ?\n\nPrompted by \n\n- https://github.com/dandi/helpdesk/discussions/139\n\nalthough not yet known if really needed in that case.","files":null},{"type":5,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1716470013,"metadata":{"github-id":"LE_lADODBZtRc6J2_94zwAAAAMBdIyN"},"added":["cmd-delete"],"removed":[]},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1716470135,"metadata":{"github-id":"IC_kwDODBZtRc5-yLmh","github-url":"https://github.com/dandi/dandi-cli/issues/1446#issuecomment-2127083937"},"message":"ah, actually in https://dandi.readthedocs.io/en/latest/ref/urls.html#resource-ids we already specify that if there is such an option and `=glob` then we have `dandi://\u003cinstance name\u003e/\u003cdandiset id\u003e[@\u003cversion\u003e][/\u003cglob\u003e]` so I guess the path is \"clear\" right?","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1716470315,"metadata":{"github-id":"IC_kwDODBZtRc5-yNLV","github-url":"https://github.com/dandi/dandi-cli/issues/1446#issuecomment-2127090389"},"message":"@yarikoptic \n\n\u003e I guess we could add this option and then treat local paths as globs to be expanded by python locally and on the server.\n\nA local glob path should be expanded by the shell into the full list of paths, at which point `dandi delete` shouldn't need to do anything special.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1716475567,"metadata":{"github-id":"IC_kwDODBZtRc5-zGGE","github-url":"https://github.com/dandi/dandi-cli/issues/1446#issuecomment-2127323524"},"message":"\u003e \u003e I guess we could add this option and then treat local paths as globs to be expanded by python locally and on the server.\n\u003e \n\u003e A local glob path should be expanded by the shell into the full list of paths, at which point `dandi delete` shouldn't need to do anything special.\n\nin case of local path specification -- do we remove only \"matching\" filenames or if e.g. I specify to remove a directory, would I remove all assets (which might be more or less than I have locally) from that \"directory\" on the server?  If it is just 1-to-1 match to local files in the folder, then indeed we could keep it consistent and pretty much ignore that option for local paths.  If not -- then it is a matter of passing glob not expanded (quote it) and match in code locally and on server.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1716476645,"metadata":{"github-id":"IC_kwDODBZtRc5-zSA4","github-url":"https://github.com/dandi/dandi-cli/issues/1446#issuecomment-2127372344"},"message":"@yarikoptic If a local directory path is passed to `dandi delete`, it deletes from the server each asset whose path starts with the given directory path; the local directory contents are ignored.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1717159955,"metadata":{"github-id":"IC_kwDODBZtRc5_rUi_","github-url":"https://github.com/dandi/dandi-cli/issues/1446#issuecomment-2142062783"},"message":"ok, in case of `--path-type=glob` let's use provided URL as a glob (per [comment above](https://github.com/dandi/dandi-cli/issues/1446#issuecomment-2127083937)) and if not a URL (ie local path) - using `glob.glob(PATH, recursive=True)` locally and delete matching assets (or folders if glob ended with `/`) locally and remotely.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1717160279,"metadata":{"github-id":"IC_kwDODBZtRc5_rY3Y","github-url":"https://github.com/dandi/dandi-cli/issues/1446#issuecomment-2142080472"},"message":"\u003e if not a URL (ie local path) - using `glob.glob(PATH, recursive=True)` locally\n\nWhy wouldn't we just let globs be expanded by the user's shell?\n\n\u003e and delete matching assets (or folders if glob ended with `/`) locally and remotely.\n\n`dandi delete` currently doesn't delete anything on the local side.  Doing so would be a considerable change that, if desired, should be submitted as a separate issue.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1717174061,"metadata":{"github-id":"IC_kwDODBZtRc5_tgGR","github-url":"https://github.com/dandi/dandi-cli/issues/1446#issuecomment-2142634385"},"message":"\u003e \u003e if not a URL (ie local path) - using `glob.glob(PATH, recursive=True)` locally\n\u003e \n\u003e Why wouldn't we just let globs be expanded by the user's shell?\n\nfor that you do not need any `--path-type` or in other words it is what you get if use `--path-type exact`.  Stating `--path-type glob` would mean that user is specifying a glob explicitly (and better quotes so shell does not expand), and possibly benefits from local shell not having recursive glob matching at all.  I think it would be nice to just be able to say `delete --path-type glob '*_entity-bad*'` and have all assets with `_entity-bad` be removed locally/remotely.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1717174167,"metadata":{"github-id":"IC_kwDODBZtRc5_tg2h","github-url":"https://github.com/dandi/dandi-cli/issues/1446#issuecomment-2142637473"},"message":"\u003e \u003e and delete matching assets (or folders if glob ended with `/`) locally and remotely.\n\u003e \n\u003e `dandi delete` currently doesn't delete anything on the local side. Doing so would be a considerable change that, if desired, should be submitted as a separate issue.\n\nfrankly I didn't realize that! then let's forget about \"local\" aspects in my above phrases. Should also make implementation easier, and we would file an issue if some user desires it is worth it ;-)","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1717419497,"metadata":{"github-id":"IC_kwDODBZtRc5_3EE-","github-url":"https://github.com/dandi/dandi-cli/issues/1446#issuecomment-2145141054"},"message":"@yarikoptic \n\n\u003e if not a URL (ie local path) - using `glob.glob(PATH, recursive=True)` locally\n\n[As I stated above](https://github.com/dandi/dandi-cli/issues/1446#issuecomment-2127372344), local (non-URL) paths passed to `dandi delete` are only matched against server paths; the only role of the local Dandiset is in ensuring the paths are relative to the Dandiset root.  If we want `dandi delete` to handle globbing of local/file/non-URL paths, shouldn't the globbing happen against server paths rather than local paths for consistency?\n\nAlso, do we want to support local path arguments that contain a glob in the Dandiset path portion, e.g., `dandi delete /home/user/00000*/*.nwb` when run inside a Dandiset at `/home/user/000001`?  That would be tricky.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1717421291,"metadata":{"github-id":"IC_kwDODBZtRc5_3UQE","github-url":"https://github.com/dandi/dandi-cli/issues/1446#issuecomment-2145207300"},"message":"\u003e If we want `dandi delete` to handle globbing of local/file/non-URL paths, shouldn't the globbing happen against server paths rather than local paths for consistency?\n\nyes, globbing should happen against server paths, likely just by passing the `glob=True` to assets listing endpoint.\n\n\u003e Also, do we want to support local path arguments that contain a glob in the Dandiset path portion, e.g., `dandi delete /home/user/00000*/*.nwb` when run inside a Dandiset at `/home/user/000001`? That would be tricky.\n\nThen let's do no such thing -- just state that in case of `=glob` passed to server as is and assumed from the top of the dandiset.","files":null}]}