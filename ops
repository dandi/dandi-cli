{"version":2,"ops":[{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1626100759,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg3ODMzNDkwMA==","github-url":"https://github.com/dandi/dandi-cli/issues/708#issuecomment-878334900"},"message":"@satra I believe that, no matter what the number is set to, you're not going to get more than one thread per CPU at once.","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1626101816,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg3ODM0ODM3Ng==","github-url":"https://github.com/dandi/dandi-cli/issues/708#issuecomment-878348376"},"message":"thank you @jwodder - the question is more about the total number of jobs running in dandi-cli. \n\nthis machine has 96 vCPUs hence at most 96 concurrent threads. using other tools i was running over 9600 threads (obviously not executed at the same time). thus in dandi-cli, if i requested 100 jobs `-J 100:1` or `-J 100:10`, i'm expecting a 100 uploads to start. is there some specific internal choice that the CLI is making that limits the number of uploads to 10 when i do `-J 20:10`?","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1626101934,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg3ODM0OTkwMQ==","github-url":"https://github.com/dandi/dandi-cli/issues/708#issuecomment-878349901"},"message":"@satra I don't believe either dandi-cli or pyout (which controls the general upload threads) sets a maximum.","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1626102106,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg3ODM1MjEzMw==","github-url":"https://github.com/dandi/dandi-cli/issues/708#issuecomment-878352133"},"message":"\u003e I don't believe either dandi-cli or pyout (which controls the general upload threads) sets a maximum.\n\nthen the question is how do you think i should debug this? it definitely does show number of uploads to be limited at 10 and the number of concurrent digesters to also be limited at 10.","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1626102244,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg3ODM1NDE5Mw==","github-url":"https://github.com/dandi/dandi-cli/issues/708#issuecomment-878354193"},"message":"@satra [This line](https://github.com/dandi/dandi-cli/blob/6b3f2a6efd950443b5f7d824c9b64c73b428b7b8/dandi/upload.py#L314) limits the CLI to processing no more than 10 uploads at once.","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1626102458,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg3ODM1NzM3Ng==","github-url":"https://github.com/dandi/dandi-cli/issues/708#issuecomment-878357376"},"message":"any particular reason for that? can we remove the limit?","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1626102501,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg3ODM1Nzk2OA==","github-url":"https://github.com/dandi/dandi-cli/issues/708#issuecomment-878357968"},"message":"@satra I don't know; it was there before I started.","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1626107879,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg3ODQyNjUwOA==","github-url":"https://github.com/dandi/dandi-cli/issues/708#issuecomment-878426508"},"message":"@jwodder - ok. i'll hack it for now while i upload. @yarikoptic - any reasons why 10? or can that be updated to be the number of jobs?","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1626110740,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDg3ODQ1ODA5MA==","github-url":"https://github.com/dandi/dandi-cli/issues/708#issuecomment-878458090"},"message":"NB Yarik got a moment while waiting for a nice gas station fella to look at Yarik's poor minivan ;)\n\noriginally limiting was added in 04f980f8429c6ad5158d5aa44b5e4052eedc3dc7 (with no more than 6).  I think it is largely was due to interaction with pyout (which would now in effect would limit now to how many rows it could display on the screen) and back then we were talking about relatively large files so going higher didn't make much sense anyways :-/  the whole `upload` logic I guess yet to be refactored to separate display (pyout or just pure json dumps etc) from the logic and to not rely on pyout's parallelization via threads.","files":null},{"type":5,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1658934079,"metadata":{"github-id":"LE_lADODBZtRc44J8kOzwAAAAGlodkU"},"added":["cmd-upload"],"removed":[]},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1658934119,"metadata":{"github-id":"IC_kwDODBZtRc5HVuFF","github-url":"https://github.com/dandi/dandi-cli/issues/708#issuecomment-1196876101"},"message":"@yarikoptic @satra Is there anything to be done for this?","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1658939984,"metadata":{"github-id":"IC_kwDODBZtRc5HWKnj","github-url":"https://github.com/dandi/dandi-cli/issues/708#issuecomment-1196992995"},"message":"has the pyout limitation been resolved, where there is a decoupling from pyout limits and the number of jobs:threads. if i understand correctly, that was the piece limiting the number of jobs/threads? for example, can i use an arbitrary number of jobs now?","files":null},{"type":3,"author":{"id":"364914f8b1c8a9131d300bf2978e4ffe2ff1aeeb"},"timestamp":1658940058,"metadata":{"github-id":"IC_kwDODBZtRc5HWK8j","github-url":"https://github.com/dandi/dandi-cli/issues/708#issuecomment-1196994339"},"message":"@satra The upload code still \"manually\" enforces a limit of ten concurrent uploads.\n\n@yarikoptic What, if anything, should be done about this?","files":null}]}