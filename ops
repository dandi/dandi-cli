{"version":2,"ops":[{"type":5,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1588260378,"metadata":{"github-id":"MDEyOkxhYmVsZWRFdmVudDMyOTAwMzE1MTY="},"added":["bug"],"removed":[]},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1588261797,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYyMTkzOTQyNg==","github-url":"https://github.com/dandi/dandi-cli/issues/92#issuecomment-621939426"},"message":"and just posting another related error when downloading a folder.\n\n```\n$ dandi download https://refactor--gui-dandiarchive-org.netlify.app/#/file-browser/folder/5e9f9588b5c9745bad9f58fe\n2020-04-30 11:47:12,255 [    INFO] Downloading folder with id 5e9f9588b5c9745bad9f58fe from https://refactor--gui-dandiarchive-org.netlify.app/\nError: 'NoneType' object has no attribute 'get'\n```\n\n\u003cdetails\u003e \u003csummary\u003eFull Error Stack\u003c/summary\u003e\n\n```\n$ dandi download https://refactor--gui-dandiarchive-org.netlify.app/#/file-browser/folder/5e9f9588b5c9745bad9f58fe\n2020-04-30 11:47:12,255 [    INFO] Downloading folder with id 5e9f9588b5c9745bad9f58fe from https://refactor--gui-dandiarchive-org.netlify.app/\nError: 'NoneType' object has no attribute 'get'\n(dandi) [satra@MacBook-Pro-8 pydra-ml]$ dandi -l DEBUG --pdb download https://refactor--gui-dandiarchive-org.netlify.app/#/file-browser/folder/5e9f9588b5c9745bad9f58fe\n2020-04-30 11:48:35,734 [   DEBUG] Establishing a client for https://refactor--gui-dandiarchive-org.netlify.app/\n2020-04-30 11:48:35,734 [    INFO] Downloading folder with id 5e9f9588b5c9745bad9f58fe from https://refactor--gui-dandiarchive-org.netlify.app/\n2020-04-30 11:48:35,914 [   DEBUG] Cannot parse response \u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003cmeta charset=\"utf-8\"\u003e\n    \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\"\u003e\n\n    \u003ctitle\u003ePage Not Found\u003c/title\u003e\n    \u003clink href='https://fonts.googleapis.com/css?family=Roboto:400,700\u0026subset=latin,latin-ext' rel='stylesheet' type='text/css'\u003e\n    \u003cstyle\u003e\n    body {\n      font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\";\n      background: rgb(14, 30, 37);\n      color: white;\n      overflow: hidden;\n      margin: 0;\n      padding: 0;\n    }\n\n    h1 {\n      margin: 0;\n      font-size: 22px;\n      line-height: 24px;\n    }\n\n    .main {\n      position: relative;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      height: 100vh;\n      width: 100vw;\n    }\n\n    .card {\n      position: relative;\n      display: flex;\n      flex-direction: column;\n      width: 75%;\n      max-width: 364px;\n      padding: 24px;\n      background: white;\n      color: rgb(14, 30, 37);\n      border-radius: 8px;\n      box-shadow: 0 2px 4px 0 rgba(14, 30, 37, .16);\n    }\n\n    a {\n      margin: 0;\n      text-decoration: none;\n      font-weight: 600;\n      line-height: 24px;\n      color: #00ad9f;\n    }\n\n    a svg {\n      position: relative;\n      top: 2px;\n    }\n\n    a:hover,\n    a:focus {\n      text-decoration: underline;\n      color: #007A70;\n    }\n\n    a:hover svg path{\n      fill: #007A70;\n    }\n\n    p:last-of-type {\n      margin: 0;\n    }\n\n    \u003c/style\u003e\n  \u003c/head\u003e\n  \u003cbody\u003e\n    \u003cdiv class=\"main\"\u003e\n      \u003cdiv class=\"card\"\u003e\n        \u003cdiv class=\"header\"\u003e\n          \u003ch1\u003ePage Not Found\u003c/h1\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"body\"\u003e\n          \u003cp\u003eLooks like you've followed a broken link or entered a URL that doesn't exist on this site.\u003c/p\u003e\n          \u003cp\u003e\n            \u003ca id=\"back-link\" href=\"/\"\u003e\n              \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\"\u003e\n                \u003cpath fill=\"#00ad9f\" d=\"M11.9998836,4.09370803 L8.55809517,7.43294953 C8.23531459,7.74611298 8.23531459,8.25388736 8.55809517,8.56693769 L12,11.9062921 L9.84187871,14 L4.24208544,8.56693751 C3.91930485,8.25388719 3.91930485,7.74611281 4.24208544,7.43294936 L9.84199531,2 L11.9998836,4.09370803 Z\"/\u003e\n              \u003c/svg\u003e\n              Back to our site\n             \u003c/a\u003e\n          \u003c/p\u003e\n        \u003c/div\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n    \u003cscript\u003e\n      (function() {\n        if (document.referrer \u0026\u0026 document.location.host \u0026\u0026 document.referrer.match(new RegExp(\"^https?://\" + document.location.host))) {\n          document.getElementById(\"back-link\").setAttribute(\"href\", document.referrer);\n        }\n      })();\n    \u003c/script\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n\n as json: Expecting value: line 1 column 1 (char 0)\nTraceback (most recent call last):\n  File \"/Users/satra/software/miniconda3/envs/dandi/lib/python3.7/site-packages/dandi/girder.py\", line 228, in traverse_asset\n    g = self.getResource(asset_type, asset_id)\n  File \"/Users/satra/software/miniconda3/envs/dandi/lib/python3.7/site-packages/girder_client-3.0.5-py3.7.egg/girder_client/__init__.py\", line 535, in getResource\n    return self.get(route)\n  File \"/Users/satra/software/miniconda3/envs/dandi/lib/python3.7/site-packages/girder_client-3.0.5-py3.7.egg/girder_client/__init__.py\", line 487, in get\n    return self.sendRestRequest('GET', path, parameters, jsonResp=jsonResp)\n  File \"/Users/satra/software/miniconda3/envs/dandi/lib/python3.7/site-packages/girder_client-3.0.5-py3.7.egg/girder_client/__init__.py\", line 481, in sendRestRequest\n    response=result)\ngirder_client.HttpError: HTTP error 404: GET https://refactor--gui-dandiarchive-org.netlify.app/api/v1/folder/5e9f9588b5c9745bad9f58fe\nResponse text: \u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n  \u003chead\u003e\n    \u003cmeta charset=\"utf-8\"\u003e\n    \u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\"\u003e\n\n    \u003ctitle\u003ePage Not Found\u003c/title\u003e\n    \u003clink href='https://fonts.googleapis.com/css?family=Roboto:400,700\u0026subset=latin,latin-ext' rel='stylesheet' type='text/css'\u003e\n    \u003cstyle\u003e\n    body {\n      font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\";\n      background: rgb(14, 30, 37);\n      color: white;\n      overflow: hidden;\n      margin: 0;\n      padding: 0;\n    }\n\n    h1 {\n      margin: 0;\n      font-size: 22px;\n      line-height: 24px;\n    }\n\n    .main {\n      position: relative;\n      display: flex;\n      flex-direction: column;\n      align-items: center;\n      justify-content: center;\n      height: 100vh;\n      width: 100vw;\n    }\n\n    .card {\n      position: relative;\n      display: flex;\n      flex-direction: column;\n      width: 75%;\n      max-width: 364px;\n      padding: 24px;\n      background: white;\n      color: rgb(14, 30, 37);\n      border-radius: 8px;\n      box-shadow: 0 2px 4px 0 rgba(14, 30, 37, .16);\n    }\n\n    a {\n      margin: 0;\n      text-decoration: none;\n      font-weight: 600;\n      line-height: 24px;\n      color: #00ad9f;\n    }\n\n    a svg {\n      position: relative;\n      top: 2px;\n    }\n\n    a:hover,\n    a:focus {\n      text-decoration: underline;\n      color: #007A70;\n    }\n\n    a:hover svg path{\n      fill: #007A70;\n    }\n\n    p:last-of-type {\n      margin: 0;\n    }\n\n    \u003c/style\u003e\n  \u003c/head\u003e\n  \u003cbody\u003e\n    \u003cdiv class=\"main\"\u003e\n      \u003cdiv class=\"card\"\u003e\n        \u003cdiv class=\"header\"\u003e\n          \u003ch1\u003ePage Not Found\u003c/h1\u003e\n        \u003c/div\u003e\n        \u003cdiv class=\"body\"\u003e\n          \u003cp\u003eLooks like you've followed a broken link or entered a URL that doesn't exist on this site.\u003c/p\u003e\n          \u003cp\u003e\n            \u003ca id=\"back-link\" href=\"/\"\u003e\n              \u003csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 16 16\"\u003e\n                \u003cpath fill=\"#00ad9f\" d=\"M11.9998836,4.09370803 L8.55809517,7.43294953 C8.23531459,7.74611298 8.23531459,8.25388736 8.55809517,8.56693769 L12,11.9062921 L9.84187871,14 L4.24208544,8.56693751 C3.91930485,8.25388719 3.91930485,7.74611281 4.24208544,7.43294936 L9.84199531,2 L11.9998836,4.09370803 Z\"/\u003e\n              \u003c/svg\u003e\n              Back to our site\n             \u003c/a\u003e\n          \u003c/p\u003e\n        \u003c/div\u003e\n      \u003c/div\u003e\n    \u003c/div\u003e\n    \u003cscript\u003e\n      (function() {\n        if (document.referrer \u0026\u0026 document.location.host \u0026\u0026 document.referrer.match(new RegExp(\"^https?://\" + document.location.host))) {\n          document.getElementById(\"back-link\").setAttribute(\"href\", document.referrer);\n        }\n      })();\n    \u003c/script\u003e\n  \u003c/body\u003e\n\u003c/html\u003e\n\n\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/satra/software/miniconda3/envs/dandi/bin/dandi\", line 8, in \u003cmodule\u003e\n    sys.exit(main())\n  File \"/Users/satra/software/miniconda3/envs/dandi/lib/python3.7/site-packages/click/core.py\", line 764, in __call__\n    return self.main(*args, **kwargs)\n  File \"/Users/satra/software/miniconda3/envs/dandi/lib/python3.7/site-packages/click/core.py\", line 717, in main\n    rv = self.invoke(ctx)\n  File \"/Users/satra/software/miniconda3/envs/dandi/lib/python3.7/site-packages/click/core.py\", line 1137, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n  File \"/Users/satra/software/miniconda3/envs/dandi/lib/python3.7/site-packages/click/core.py\", line 956, in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File \"/Users/satra/software/miniconda3/envs/dandi/lib/python3.7/site-packages/click/core.py\", line 555, in invoke\n    return callback(*args, **kwargs)\n  File \"/Users/satra/software/miniconda3/envs/dandi/lib/python3.7/site-packages/dandi/cli/command.py\", line 118, in wrapper\n    return f(*args, **kwargs)\n  File \"/Users/satra/software/miniconda3/envs/dandi/lib/python3.7/site-packages/dandi/cli/cmd_download.py\", line 53, in download\n    return download(url, output_dir, existing=existing, develop_debug=develop_debug)\n  File \"/Users/satra/software/miniconda3/envs/dandi/lib/python3.7/site-packages/dandi/download.py\", line 157, in download\n    for asset_id_ in set(flattened([asset_id]))\n  File \"/Users/satra/software/miniconda3/envs/dandi/lib/python3.7/site-packages/dandi/utils.py\", line 184, in flattened\n    for i in it:\n  File \"/Users/satra/software/miniconda3/envs/dandi/lib/python3.7/site-packages/dandi/download.py\", line 157, in \u003cgenexpr\u003e\n    for asset_id_ in set(flattened([asset_id]))\n  File \"/Users/satra/software/miniconda3/envs/dandi/lib/python3.7/site-packages/dandi/download.py\", line 188, in _get_asset_files\n    client.traverse_asset(asset_id, asset_type, recursive=False)\n  File \"/Users/satra/software/miniconda3/envs/dandi/lib/python3.7/site-packages/dandi/girder.py\", line 233, in traverse_asset\n    exc.status == 401 or \"access denied\" in response.get(\"message\", \"\")\nAttributeError: 'NoneType' object has no attribute 'get'\n\n\u003e /Users/satra/software/miniconda3/envs/dandi/lib/python3.7/site-packages/dandi/girder.py(233)traverse_asset()\n-\u003e exc.status == 401 or \"access denied\" in response.get(\"message\", \"\")\n```\n\u003c/details\u003e","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1588265599,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYyMTk3NTIwMw==","github-url":"https://github.com/dandi/dandi-cli/issues/92#issuecomment-621975203"},"message":"The first url -- docstring of the function says\nhttps://github.com/dandi/dandi-cli/blob/master/dandi/download.py#L32\n```\n      - girder -- we don't support:\n        https://girder.dandiarchive.org/api/v1/item/5dab0972f377535c7d96c392/download\n```\nshould we? i.e. how did you get ahold of girder URL?\nI would vote we do not support those.  Error message definitely should be improved though ;)","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1588265911,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYyMTk3ODM3Nw==","github-url":"https://github.com/dandi/dandi-cli/issues/92#issuecomment-621978377"},"message":"\u003e how did you get ahold of girder URL?\n\nthat's the individual item download link from the new ui.\n\nopen the new ui: https://refactor--gui-dandiarchive-org.netlify.app/#/file-browser/folder/5e70d3053da50caa9adaf2d8\n\nclick on any item, and then right click on the download link.  so we should support it. as an item specific link. this is what people will use in any program or viewer.\n\nwhen we replace this with an asset link in the api, we can move to that.","files":null},{"type":3,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1588265993,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYyMTk3OTIyMA==","github-url":"https://github.com/dandi/dandi-cli/issues/92#issuecomment-621979220"},"message":"it's true that i could have just done wget or curl or opened in a browser, but i feel that dandi cli should support it as well. that link simply redirects to a signed s3 url.","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1588272051,"metadata":{"github-id":"MDEyOklzc3VlQ29tbWVudDYyMjAzMDkxMw==","github-url":"https://github.com/dandi/dandi-cli/issues/92#issuecomment-622030913"},"message":"cool. First (now) I will implement support for these two new URL schemas, may be while at it refactoring `download` code a bit.\nSupport for arbitrary URLs to just be passed through - might come later.","files":null},{"type":4,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1588355083,"metadata":{"github-id":"MDExOkNsb3NlZEV2ZW50MzI5MzkxODUxMA=="},"status":2}]}