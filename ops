{"version":2,"ops":[{"type":6,"author":{"id":"5abab4dc6d21919c4a74bdcfda7d268fdd9b9da7"},"timestamp":1724089645,"metadata":{"github-id":"UCE_lAHODBZtRc6TdFrZzmJ2Ss4"},"target":"78f2af6530c25574fc02e27d167be266da20743ee68834c08289943d40d3e832","message":"Hello all,\n\nRunning into an issue while trying to organize my dandi set using the cli. Getting `[    INFO] 1 out of 296 paths are not unique. We will try adding _obj- based on crc32 of object_id`, and I can't seem to locate any more information about the non-unique path in question. I've been checking the logs but there are no further details on which path may be not unique. \n\n\nBuild info as follows. \n```\n[INFO    ] dandi 647577:124894109286400 dandi v0.63.0+5.g37b63509, hdmf v3.14.3, pynwb v2.8.1, h5py v3.11.0\n```\nI am using the `dandi v0.63.0+5.g37b63509` build to address metadata problem I was facing [previously](https://github.com/dandi/dandi-cli/issues/1481), but this issue comes up whether I am using the +5.g37...09 build or not. I have added more files to the dataset, so I assume that somewhere along the way I added a file that trips the `not unique` issue. Unfortunately I do not know where to look to identify where the issue stems from, as the \"non-unique path\" is not written into the log.\n\nAnother error that shows up: `Error: 'numpy.bytes_' object has no attribute 'encode'`\n\n\n\nI will attach the log as well.\n[2024.08.19-16.50.59Z-647577.log](https://github.com/user-attachments/files/16663583/2024.08.19-16.50.59Z-647577.log)\n\nOther details regarding build information\n\u003cdetails\u003e/\n2024-08-19 09:55:08,798 [    INFO] Loading metadata from 296 files\n[Parallel(n_jobs=-1)]: Using backend LokyBackend with 20 concurrent workers.\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'hdmf-common' version 1.1.3 because version 1.8.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'core' version 2.2.4 because version 2.7.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'hdmf-common' version 1.1.3 because version 1.8.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'core' version 2.2.4 because version 2.7.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'hdmf-common' version 1.1.3 because version 1.8.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'core' version 2.2.4 because version 2.7.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'hdmf-common' version 1.1.3 because version 1.8.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'core' version 2.2.4 because version 2.7.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'hdmf-common' version 1.1.3 because version 1.8.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'core' version 2.2.4 because version 2.7.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'hdmf-common' version 1.1.3 because version 1.8.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'core' version 2.2.4 because version 2.7.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'hdmf-common' version 1.1.3 because version 1.8.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'core' version 2.2.4 because version 2.7.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'hdmf-common' version 1.1.3 because version 1.8.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'core' version 2.2.4 because version 2.7.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'hdmf-common' version 1.1.3 because version 1.8.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'core' version 2.2.4 because version 2.7.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'hdmf-common' version 1.1.3 because version 1.8.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'core' version 2.2.4 because version 2.7.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'hdmf-common' version 1.1.3 because version 1.8.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'core' version 2.2.4 because version 2.7.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'hdmf-common' version 1.1.3 because version 1.8.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'core' version 2.2.4 because version 2.7.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'hdmf-common' version 1.1.3 because version 1.8.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'core' version 2.2.4 because version 2.7.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'hdmf-common' version 1.1.3 because version 1.8.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'core' version 2.2.4 because version 2.7.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'hdmf-common' version 1.1.3 because version 1.8.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'core' version 2.2.4 because version 2.7.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'hdmf-common' version 1.1.3 because version 1.8.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'core' version 2.2.4 because version 2.7.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'hdmf-common' version 1.1.3 because version 1.8.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'core' version 2.2.4 because version 2.7.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'hdmf-common' version 1.1.3 because version 1.8.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'core' version 2.2.4 because version 2.7.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'hdmf-common' version 1.1.3 because version 1.8.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'core' version 2.2.4 because version 2.7.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'hdmf-common' version 1.1.3 because version 1.8.0 is already loaded.\n  return func(args[0], **pargs)\n\n/home/nrsc/.local/share/r-miniconda/envs/dandi/lib/python3.12/site-packages/hdmf/utils.py:668: UserWarning: Ignoring cached namespace 'core' version 2.2.4 because version 2.7.0 is already loaded.\n  return func(args[0], **pargs)\n\n\u003cdetails\u003e","files":null},{"type":3,"author":{"id":"d8203afd43c9e0a9d07c45dd62b58a81d53a2ebe"},"timestamp":1724094840,"metadata":{"github-id":"IC_kwDODBZtRc6I7XXu","github-url":"https://github.com/dandi/dandi-cli/issues/1489#issuecomment-2297263598"},"message":"Thanks for the report, @nrsc.  Could you post a list of the files (with the full path) you are attempting to organize (e.g. using the `tree` command)?","files":null},{"type":3,"author":{"id":"5abab4dc6d21919c4a74bdcfda7d268fdd9b9da7"},"timestamp":1724100135,"metadata":{"github-id":"IC_kwDODBZtRc6I783h","github-url":"https://github.com/dandi/dandi-cli/issues/1489#issuecomment-2297417185"},"message":"Here's the output of all the files in the folder. \n[dandi_output.txt](https://github.com/user-attachments/files/16665166/dandi_output.txt)","files":null},{"type":6,"author":{"id":"5abab4dc6d21919c4a74bdcfda7d268fdd9b9da7"},"timestamp":1724100234,"metadata":{"github-id":"UCE_lALODBZtRc6I783hzk2U61A"},"target":"7b29d44a62d748bfb8fb9682757138b5355a68b3f01eda6f076b0eb191c2ca44","message":"Here's the output of all the files in the folder. \n[dandi_output.txt](https://github.com/user-attachments/files/16665176/dandi_output.txt)","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1724107749,"metadata":{"github-id":"IC_kwDODBZtRc6I80Qx","github-url":"https://github.com/dandi/dandi-cli/issues/1489#issuecomment-2297644081"},"message":"Hi @nrsc . Since you are a bug magnet (like yours truly), you might want to learn about an option to fall into python debugger which could potentially come out of help to troubleshoot more in the future\n\n```\n‚ùØ dandi --help | grep pdb\n  --pdb                           Fall into pdb if errors out\n```\n\nwhich if you specify (e.g. `dandi --pdb organize ...`) would lead you to drop into pdb debugger at that point of error on `numpy.bytes_` which I fail to reproduce ATM.  More on how to use pdb e.g. at https://realpython.com/python-debugging-pdb/ .\n\nI will look now into providing more information about those non-unique paths - we must be able to provide more informative message there!","files":null},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1724112282,"metadata":{"github-id":"IC_kwDODBZtRc6I9HcA","github-url":"https://github.com/dandi/dandi-cli/issues/1489#issuecomment-2297722624"},"message":"@nrsc try out\n- https://github.com/dandi/dandi-cli/pull/1490\nand please share (upload to dandi?) those files with problematic objid leading to `Error: 'numpy.bytes_' object has no attribute 'encode'`","files":null},{"type":3,"author":{"id":"5abab4dc6d21919c4a74bdcfda7d268fdd9b9da7"},"timestamp":1724175602,"metadata":{"github-id":"IC_kwDODBZtRc6JDhUz","github-url":"https://github.com/dandi/dandi-cli/issues/1489#issuecomment-2299401523"},"message":"Thank you @yarikoptic. Will confirm effects of updates once I get the chance to sit back down with this again. Cheers all.","files":null},{"type":3,"author":{"id":"5abab4dc6d21919c4a74bdcfda7d268fdd9b9da7"},"timestamp":1724696083,"metadata":{"github-id":"IC_kwDODBZtRc6Ju9dh","github-url":"https://github.com/dandi/dandi-cli/issues/1489#issuecomment-2310788961"},"message":"Hi @yarikoptic. Here is the output from pdb\n\n\u003cdetails\u003e\n\n```\n(dandi-cli) nrsc@ai-connect:~/001065$ dandi --pdb organize\n2024-08-26 11:00:56,664 [    INFO] Note: NumExpr detected 20 cores but \"NUMEXPR_MAX_THREADS\" not set, so enforcing safe limit of 8.\n2024-08-26 11:00:56,664 [    INFO] NumExpr defaulting to 8 threads.\n2024-08-26 11:00:57,209 [    INFO] Logs saved in /home/nrsc/.cache/dandi-cli/log/2024.08.26-18.00.56Z-784710.log\nTraceback (most recent call last):\n  File \"/home/nrsc/.local/bin/dandi\", line 8, in \u003cmodule\u003e\n    sys.exit(main())\n  File \"/home/nrsc/.local/lib/python3.10/site-packages/click/core.py\", line 1157, in __call__\n    return self.main(*args, **kwargs)\n  File \"/home/nrsc/.local/lib/python3.10/site-packages/click/core.py\", line 1078, in main\n    rv = self.invoke(ctx)\n  File \"/home/nrsc/.local/lib/python3.10/site-packages/click/core.py\", line 1688, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n  File \"/home/nrsc/.local/lib/python3.10/site-packages/click/core.py\", line 1434, in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n  File \"/home/nrsc/.local/lib/python3.10/site-packages/click/core.py\", line 783, in invoke\n    return __callback(*args, **kwargs)\n  File \"/home/nrsc/.local/lib/python3.10/site-packages/click/decorators.py\", line 45, in new_func\n    return f(get_current_context().obj, *args, **kwargs)\n  File \"/home/nrsc/.local/lib/python3.10/site-packages/dandi/cli/base.py\", line 126, in wrapper\n    return f(*args, **kwargs)\n  File \"/home/nrsc/.local/lib/python3.10/site-packages/dandi/cli/cmd_organize.py\", line 112, in organize\n    organize(\n  File \"/home/nrsc/.local/lib/python3.10/site-packages/dandi/organize.py\", line 822, in organize\n    raise ValueError(\nValueError: Only 'dry' or 'move' mode could be used to operate in-place within a dandiset (no paths were provided)\n\n\u003e /home/nrsc/.local/lib/python3.10/site-packages/dandi/organize.py(822)organize()\n-\u003e raise ValueError(\n(Pdb) \n```\n\u003c/details\u003e\n\nI'm wondering whether the line;\n```\n2024-08-26T11:00:57-0700 [DEBUG   ] dandi 784710:134806063919104 Caught exception Only 'dry' or 'move' mode could be used to operate in-place within a dandiset (no paths were provided)\n```\ncan point to the origin of the error. \n\nUnfortunately I am not so well versed in python and python debugging. I've been an R guy for a while now, but I am interested in contributing best I can and learning about this process.\n\nShould I pull the `organize.py` file that you pushed last [week](https://github.com/dandi/dandi-cli/pull/1490) and try running the organize function again?\n\nCheers,\n\nScott","files":null},{"type":3,"author":{"id":"5abab4dc6d21919c4a74bdcfda7d268fdd9b9da7"},"timestamp":1724882000,"metadata":{"github-id":"IC_kwDODBZtRc6KEB8p","github-url":"https://github.com/dandi/dandi-cli/issues/1489#issuecomment-2316312361"},"message":"Hi @yarikoptic. Updated from the repository, and I now get the paths out when the error identifies the duplicated paths. That helped me identify and fix the issue. Thank you for providing the patch.","files":null},{"type":4,"author":{"id":"5abab4dc6d21919c4a74bdcfda7d268fdd9b9da7"},"timestamp":1724882000,"metadata":{"github-id":"CE_lADODBZtRc6TdFrZzwAAAANFoORL"},"status":2},{"type":3,"author":{"id":"34bb3b7763ea6d04cae1c21ede40209df34305b5"},"timestamp":1724956748,"metadata":{"github-id":"IC_kwDODBZtRc6KMwQ4","github-url":"https://github.com/dandi/dandi-cli/issues/1489#issuecomment-2318599224"},"message":"sorry I have missed your prior comment and thanks for reporting back - bring us joy to have issues closed! ;)","files":null}]}