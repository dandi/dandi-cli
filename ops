{"version":2,"ops":[{"type":1,"author":{"id":"12cb25e6e3f19b53447b05d00d7d4d53c925c908"},"timestamp":1627047134,"metadata":{"github-id":"MDU6SXNzdWU5NTE1ODQ0ODc=","github-url":"https://github.com/dandi/dandi-cli/issues/736","origin":"github"},"title":"cli trying to upload blob that exists","message":"@jwodder - perhaps you could use the etag to see why cli would try to reupload\n\n```\n2021-07-23T09:28:08-0400 [INFO    ] dandi 1689420:140149865748288 os.getcwd() = /mnt/beegfs/satra/zarrhdf/dandi\n2021-07-23T09:28:09-0400 [DEBUG   ] dandi 1689420:140149865748288 No newer (than 0.23.2) version of dandi/dandi-cli found available\n2021-07-23T09:28:10-0400 [DEBUG   ] dandi 1689420:140149865748288 GET https://api.dandiarchive.org/api/auth/token\n2021-07-23T09:28:10-0400 [DEBUG   ] dandi 1689420:140149865748288 Response: 200\n2021-07-23T09:28:10-0400 [DEBUG   ] dandi 1689420:140149865748288 Found identifier DANDI:000108 in top level 'identifier'\n2021-07-23T09:28:10-0400 [DEBUG   ] dandi 1689420:140149865748288 GET https://api.dandiarchive.org/api/dandisets/000108/\n2021-07-23T09:28:10-0400 [DEBUG   ] dandi 1689420:140149865748288 Response: 200\n2021-07-23T09:28:12-0400 [INFO    ] dandi 1689420:140149865748288 Found 1 files to consider\n2021-07-23T09:28:12-0400 [DEBUG   ] dandi 1689420:140136165803776 GET https://api.dandiarchive.org/api/dandisets/000108/versions/draft/assets/\n2021-07-23T09:28:12-0400 [DEBUG   ] dandi 1689420:140136165803776 Response: 200\n2021-07-23T09:28:12-0400 [DEBUG   ] dandi 1689420:140136165803776 /mnt/beegfs/satra/zarrhdf/dandi/sub-MITU01/ses-20210614h15m30s08/microscopy/sub-MITU01_run-1_sample-169_stain-LEC_chunk-1_spim.h5 has no nwb_version\n2021-07-23T09:28:12-0400 [INFO    ] dandi 1689420:140136165803776 Failed to extract NWB metadata from sub-MITU01/ses-20210614h15m30s08/microscopy/sub-MITU01_run-1_sample-169_stain-LEC_chunk-1_spim.h5: ValueError: No data_type found for builder root\n2021-07-23T09:28:12-0400 [DEBUG   ] dandi 1689420:140136165803776 Calculated dandi-etag of fd0ac2f4aec518834dca9ff1a077ffce-722 for sub-MITU01/ses-20210614h15m30s08/microscopy/sub-MITU01_run-1_sample-169_stain-LEC_chunk-1_spim.h5\n2021-07-23T09:28:12-0400 [DEBUG   ] dandi 1689420:140136165803776 sub-MITU01/ses-20210614h15m30s08/microscopy/sub-MITU01_run-1_sample-169_stain-LEC_chunk-1_spim.h5: Beginning upload\n2021-07-23T09:28:12-0400 [DEBUG   ] dandi 1689420:140136165803776 POST https://api.dandiarchive.org/api/uploads/initialize/\n2021-07-23T09:28:12-0400 [DEBUG   ] dandi 1689420:140136165803776 Response: 409\n2021-07-23T09:28:12-0400 [DEBUG   ] dandi 1689420:140136165803776 Error 409 while sending POST request to https://api.dandiarchive.org/api/uploads/initialize/: \"Blob already exists.\"\n2021-07-23T09:28:12-0400 [DEBUG   ] dandi 1689420:140136165803776 sub-MITU01/ses-20210614h15m30s08/microscopy/sub-MITU01_run-1_sample-169_stain-LEC_chunk-1_spim.h5: Blob already exists on server\n2021-07-23T09:28:12-0400 [DEBUG   ] dandi 1689420:140136165803776 sub-MITU01/ses-20210614h15m30s08/microscopy/sub-MITU01_run-1_sample-169_stain-LEC_chunk-1_spim.h5: Assigning asset blob to dandiset \u0026 version\n2021-07-23T09:28:12-0400 [DEBUG   ] dandi 1689420:140136165803776 GET https://api.dandiarchive.org/api/dandisets/000108/versions/draft/assets/\n2021-07-23T09:28:12-0400 [DEBUG   ] dandi 1689420:140136165803776 Response: 200\n2021-07-23T09:28:12-0400 [DEBUG   ] dandi 1689420:140136165803776 POST https://api.dandiarchive.org/api/dandisets/000108/versions/draft/assets/\n2021-07-23T09:28:12-0400 [DEBUG   ] dandi 1689420:140136165803776 Response: 409\n2021-07-23T09:28:12-0400 [DEBUG   ] dandi 1689420:140136165803776 Error 409 while sending POST request to https://api.dandiarchive.org/api/dandisets/000108/versions/draft/assets/: \"An asset with that path already exists\"\n2021-07-23T09:28:12-0400 [DEBUG   ] dandi 1689420:140149865748288 GET https://api.dandiarchive.org/api/dandisets/000108/versions/draft/assets/\n2021-07-23T09:28:12-0400 [DEBUG   ] dandi 1689420:140149865748288 Response: 200\n2021-07-23T09:28:12-0400 [INFO    ] dandi 1689420:140149865748288 Logs saved in /home/satra/.cache/dandi-cli/log/20210723132808Z-1689420.log\n```","files":null}]}