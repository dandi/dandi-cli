{"version":2,"ops":[{"type":1,"author":{"id":"afe62dd154b2234eb7c5cdf636d46b27c2c2760e"},"timestamp":1606177887,"metadata":{"github-id":"MDU6SXNzdWU3NDkyMjcxMzA=","github-url":"https://github.com/dandi/dandi-cli/issues/282","origin":"github"},"title":"make `ls` more resilient in case of metadata loading fails with pynwb for some reason","message":"Follow up from https://github.com/NeurodataWithoutBorders/pynwb/issues/1321.\n\nCan someone explain why HardwareTests-V2-IP8.nwb is good with\n\n```\n$ dandi --log-level DEBUG ls HardwareTests-V2-IP8.nwb\n2020-11-24 01:20:38,661 [   DEBUG] No newer (than 0.7.2) version of dandi/dandi-cli found available\n2020-11-24 01:20:41,977 [   DEBUG] Calling memoized version of \u003cfunction get_metadata at 0x0000000008A4A678\u003e for E:\\projekte\\mies-igor\\tools\\unit-testing\\HardwareTests-V2-IP8.nwb\n- age: null\n  date_of_birth: null\n  experiment_description: null\n  experimenter: null\n  genotype: null\n  identifier: ac24acc942a5b87538bf15d140e06b4576481565b77b114877c4d26ba23fc09e\n  institution: null\n  keywords: null\n  lab: null\n  nd_types:\n  - Device (7)\n  - IntracellularElectrode (6)\n  - LabNotebook\n  - LabNotebookDevice\n  - StimulusSets\n  - Subject\n  - SweepTable\n  - Testpulse\n  - TestpulseDevice\n  - TimeSeries (4)\n  - UserComment\n  - UserCommentDevice\n  - VoltageClampSeries (2)\n  - VoltageClampStimulusSeries (2)\n  number_of_electrodes: 0\n  number_of_units: 0\n  nwb_version: 2.2.4\n  path: HardwareTests-V2-IP8.nwb\n  related_publications: null\n  session_description: PLACEHOLDER\n  session_id: null\n  session_start_time: 2020-11-21 20:42:02.721000+00:00\n  sex: null\n  size: 9180392\n  species: null\n  subject_id: null\n(\n```\n\nbut bad.nwb gives\n\n```\nDATASET \"/general/intracellular_ephys/electrode_0/description\" {\n   DATATYPE  H5T_STRING {\n         STRSIZE H5T_VARIABLE;\n         STRPAD H5T_STR_NULLTERM;\n         CSET H5T_CSET_UTF8;\n         CTYPE H5T_C_S1;\n      }\n   DATASPACE  SIMPLE { ( 1 ) / ( 1 ) }\n   DATA {\n      \"Headstage 0\"\n   }\n}\n}\n```\n\nBoth have the exact same HDF5 type \n\n```\nE:\\projekte\\mies-igor\\tools\\unit-testing\u003eh5dump -d \"/general/intracellular_ephys/electrode_0/description\" bad.nwb HardwareTests-V2-IP8.nwb\nHDF5 \"bad.nwb\" {\nDATASET \"/general/intracellular_ephys/electrode_0/description\" {\n   DATATYPE  H5T_STRING {\n      STRSIZE H5T_VARIABLE;\n      STRPAD H5T_STR_NULLTERM;\n      CSET H5T_CSET_UTF8;\n      CTYPE H5T_C_S1;\n   }\n   DATASPACE  SIMPLE { ( 1 ) / ( 1 ) }\n   DATA {\n   (0): \"Headstage 0\"\n   }\n}\n}\nHDF5 \"HardwareTests-V2-IP8.nwb\" {\nDATASET \"/general/intracellular_ephys/electrode_0/description\" {\n   DATATYPE  H5T_STRING {\n      STRSIZE H5T_VARIABLE;\n      STRPAD H5T_STR_NULLTERM;\n      CSET H5T_CSET_UTF8;\n      CTYPE H5T_C_S1;\n   }\n   DATASPACE  SIMPLE { ( 1 ) / ( 1 ) }\n   DATA {\n   (0): \"Headstage 0\"\n   }\n}\n}\n```\n\n[files.zip](https://github.com/dandi/dandi-cli/files/5586590/files.zip)","files":null}]}